@model ElectricEase.Data.TimeSheetMaster.TimeSheetDTO
@{
    ViewBag.Title = "NewTimeSheet";
    Layout = "~/Views/Shared/_estimLayout.cshtml";
    var userFullName = Model.UserDetails.First_Name + " " + Model.UserDetails.Last_Name;
    var radonly = (Model.TimeSheetMaster.User_ID != null && (Model.TimeSheetMaster.User_ID != Model.LoginUser.User_ID)) ? "readonly" : "";
    string endDate = Model.TimeSheetMaster.EndDate.HasValue ? Model.TimeSheetMaster.EndDate.Value.ToString("MM-dd-yyyy") : "";
    string startDate = Model.TimeSheetMaster.StartDate.HasValue ? Model.TimeSheetMaster.StartDate.Value.ToString("MM-dd-yyyy") : "";
    radonly = Model.IsView ? "readonly" : radonly;
    string[] startDates = Model.TimeSheetMasterDetails.Select(a => a.StartDate.Value.ToString("MM-dd-yyyy")).ToArray();
    if (!Model.TimeSheetDetails.Any())
    {
        endDate = ""; startDate = "";
    }
    var title = Model.LoginUser.Site_Administrator == true ? "Employee Timesheets" : "Timesheets";
}
<style>
    .ui-datepicker-trigger {
        position: relative;
        height: 19px;
        width: 20px;
        margin-top: -20px;
        float: right;
    }

    .cleardata {
        margin-top: -26px !important;
        margin-right: 19px !important;
    }

    .ts-table {
        font-family: arial;
    }

        .ts-table table {
            table-layout: fixed;
        }

    .headcolor {
        background-color: #007399 !important;
        color: white;
    }

    .ts-table .table-bordered th {
        font-weight: 400;
        font-size: 12px !important;
        line-height: 18px;
    }

    .ts-table .table-bordered td, .ts-table .table-bordered th {
        border: 1px solid #dee2e6;
        vertical-align: middle;
    }

    .bottomcolor {
        background-color: #ececec;
    }

    .bottomfirst {
        background-color: white;
        color: black;
        font-size: 11px;
    }

    .yellowcolor_box {
        padding: 5px 10px;
        width: 200px;
        background-color: yellow;
        border: 1px solid #dee2e6;
    }

    .pinkcolor_box {
        padding: 5px 10px;
        width: 200px;
        background-color: #e674ba;
        border: 1px solid #dee2e6;
    }

    .greencolor_box {
        padding: 5px 10px;
        width: 200px;
        background-color: #89d859;
        border: 1px solid #dee2e6;
    }

    .ts-table input {
        padding: 0 5px;
        border: 1px solid #ddd;
        width: 100%;
    }

    .ts-table p {
        margin-bottom: 0px;
    }

    .modal {
        background: rgba(0,0,0,0.5);
    }
</style>
<script>
    $(document).ready(function () {
        // $('li').removeClass('active');
        $('.side-nav li.active').removeClass('active');
        var from = parseFloat($("#hdnFrom").val()) == 0 ? "employeeTimeSheets" : "employeeTimeCard";
        $("#" + from).addClass('active');
        $(".content-title").text("@title");
    });
</script>
@using (Html.BeginForm("AddTimeSheet", "TimeSheet", FormMethod.Post, new { role = "form", @id = "frmTimeSheet" }))
{
    <div class="app-body" id="Scroll">

        <!-- app content here -->
        <div class="magic-layoutz">

            <div class="box magic-element width-full">
                <div class="box-row  profile-hd">
                    <h7 class="box-heading">
                        <strong> &nbsp @Html.Raw(Convert.ToBoolean(HttpContext.Current.Items["SiteAdministrator"]) == true ? "Employee Timesheets" : ViewBag.HeadText)</strong> <span class="pull-right apse b" style="padding-right:5px; color:#ffffff">
                            <img id="arrow" src="../Images/down-arrow.png" alt="" />
                        </span>

                    </h7>
                </div>
                <div id="accordion">
                    <div id="collapseOne" class="panel-collapse collapse in">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="panel panel-default">
                                    <div class="panel-body">
                                        <div class="row">
                                            <div class="pull-right" style="width: 15%">
                                                <a href="javascript:void(0)" onclick="Back()"> <button type="button" class="btn btn-flat btn-primary btn-sm" name="addTimeSheet" style="width: 80%;background:#878787;border:none" tabindex="10" id="btnBack">Back to Timesheets</button></a>
                                            </div>
                                        </div>
                                        <div class="ajax-refresh2">
                                            <div class="panel-body">

                                                <label style="color:red;display:none" id="lblError"></label>
                                                @*<div class="row-fluid" style="">
                                                        <div class="col-md-3">
                                                            <div class="form-group">
                                                                <label for="label"><strong>User Id </strong></label>
                                                                @Html.TextBoxFor(m => m.UserDetails.User_ID, new { @class = "form-control", @readonly = "readonly" })

                                                            </div>
                                                        </div>
                                                    </div>*@
                                                @if (radonly == "readonly")
                                                {
                                                    <div class="row-fluid">
                                                        <div class="col-md-2">
                                                            <div class="form-group">
                                                                <label for="label"><strong>TimeSheet ID </strong></label>
                                                                @Html.TextBoxFor(m => m.TimeSheetMaster.TimeSheetCode, new { @class = "form-control", @readonly = "readonly" })


                                                            </div>
                                                        </div>
                                                    </div>
                                                }

                                                <div class="row-fluid">
                                                    <div class="col-md-2">
                                                        @Html.HiddenFor(m => m.UserDetails.User_ID)
                                                        @Html.HiddenFor(a => a.UserDetails.Client_Company)
                                                        @Html.HiddenFor(a => a.UserDetails.Client_ID)
                                                        @Html.HiddenFor(a => a.From, new { @id = "hdnFrom" })

                                                        <div class="form-group">
                                                            <label for="label"><strong>Full Name </strong></label>
                                                            @Html.TextBoxFor(m => userFullName, new { @class = "form-control", @style = "text-transform:capitalize", @readonly = "readonly" })
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row-fluid">
                                                    <div class="col-md-2">
                                                        <div class="form-group">
                                                            <label for="label"><strong>Reporting Manager </strong></label>
                                                            @Html.TextBoxFor(m => m.ReportingManager, new { @class = "form-control", @style = "text-transform:capitalize", @readonly = "readonly" })
                                                        </div>
                                                    </div>
                                                </div>
                                                @if (radonly == "readonly")
                                                {
                                                    <div class="row-fluid">
                                                        <div class="col-md-2">
                                                            <div class="form-group">
                                                                <label for="label"><strong>Status </strong></label>
                                                                @if (Model.TimeSheetMaster.Status == "Aproved" && Convert.ToBoolean(HttpContext.Current.Items["SiteAdministrator"]))
                                                                {
                                                                    <select class="form-control" id="ddlStatus" onchange="ChangeStatus()">
                                                                        <option value="Aproved">Aproved</option>
                                                                        <option value="Saved">Saved</option>
                                                                    </select>
                                                                }
                                                                else
                                                                {
                                                                    <input type="text" class="form-control" value="@Model.TimeSheetMaster.Status" readonly="readonly" />
                                                                    @*@Html.TextBoxFor(m => m.TimeSheetMaster.Status, new { @class = "form-control", @readonly = "readonly" })*@
                                                                }
                                                            </div>
                                                        </div>
                                                    </div>
                                                }
                                                <div class="row-fluid">
                                                    <div class="col-md-2">
                                                        <div class="form-group">
                                                            <label for="label"><strong>Start Date <span class="err">*</span></strong></label>
                                                            @Html.HiddenFor(a => a.StartDate, new { @id = "hdnStartDate" })
                                                            @Html.HiddenFor(a => a.EndDate, new { @id = "hdnEndDate" })
                                                            @*@Html.TextBoxFor(m => m.TimeSheetMaster.StartDate, "{0:MM-dd-yyyy}", new { @class = "form-control", @placeholder = "Start Date", @id = "txtStartDate", @onchange = "Sdatekeypress()", @readonly = "readonly" })*@
                                                            <input type="text" value="@startDate" id="txtStartDate" class="form-control" onchange="Sdatekeypress();" placeholder="Start Date" readonly="readonly" style="cursor:text !important" />
                                                            @*<input type="text" id="StartDate" class="form-control datepicker" onchange="Sdatekeypress();" placeholder="dd/mm/yyyy" disabled />*@

                                                            <span class="alert-success pull-right">
                                                                <button type="button" id="startDateclear" class="close cleardata">×</button>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row-fluid">
                                                    <div class="col-md-2">
                                                        <div class="form-group">
                                                            <label for="label"><strong>End Date  <span class="err">*</span> </strong></label>
                                                            @*@Html.TextBoxFor(m => m.TimeSheetMaster.EndDate, "{0:MM-dd-yyyy}", new { @class = "form-control", @id = "txtEndDate", @placeholder = "End Date", @readonly = "readonly" })*@
                                                            <input type="text" value="@endDate" class="form-control" id="txtEndDate" placeholder="End Date" readonly="readonly" style="cursor:text !important" />
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="divTimeSheetDetails">
                                                    @Html.Partial("_TimeSheetDetails", Model)
                                                </div>

                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>


    <div id="RejectPopUp" class="modal fade" role="dialog">
        <div class="modal-dialog" style="width: 75%; margin-left: 22%; margin-top: 60px;">
            <div class="modal-header" style="background-color: #333333; height: 35px;">
                <button type="button" class="close" data-dismiss="modal" id="popupclose" style="color: white !important; opacity: 0.9;">&times;</button>
                <h4 class="modal-title" style="color: #FFF !important;">Reject Time Sheet</h4>
            </div>
            <div class="modal-content" style="overflow: hidden; border-radius: 0; min-height: 185px;">
                <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <label style="color:#333;margin:15px 0px"> Are you sure, you want to Reject this sheet? If yes please enter the reason</label>
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label for="label" style="color:#333;padding-left:10px"><strong>Comments <span class="err">*</span></strong></label>
                                            @Html.TextAreaFor(m => m.TimeSheetMaster.Comments, new { @id = "txtComments", @class = "form-control", @rows = "3", @cols = 3, @maxlength = "500" })
                                            <span id="spnCommentError" style="color:red;display:none"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="pull-right popup-btn" style="margin-top:10px">
                                        <button type="button" value="Save" class="btn btn-flat btn-primary btn-sm" id="submit" style="background:#87de75;border:none" onclick="ApproveOrReject('Rejected');">Yes</button>
                                        <button type="button" value="Cancel" class="btn btn-flat btn-primary btn-sm" style="background:#e74c3c;border:none" data-dismiss="modal">No</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}
@{
    if (radonly != "readonly")
    {
        <script>
            $(function () {
                var dates = @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(startDates)); ;
                console.log(dates);
                $("#txtStartDate").datepicker({
                    showOn: "both",
                    buttonImage: "../AppImges/calender.png",
                    buttonImageOnly: true,
                    buttonText: "Select date",
                    //dateFormat: 'dd-mm-yy'     //...local...
                    dateFormat: 'mm-dd-yy', //..server format...
                    maxDate: 0,
                    beforeShowDay: function (date) {
                        var day = date.getDay();
                        var string = jQuery.datepicker.formatDate('mm-dd-yy', date);
                        return [day == 6 && dates.indexOf(string) == -1];
                    }
                });
            });
        </script>
    }
}
<script>



    function ChangeStatus() {
        if ($("#ddlStatus").val() == "Saved") {
            if (confirm("Are you still want to change")) {
                ApproveOrReject("Saved");
            }
        }
    }

    function Back() {
        window.location.href = parseFloat($("#hdnFrom").val()) == 0 ? "@Url.Action("Index", "TimeSheet")" : "@Url.Action("TimeCard", "TimeSheet")?status=" + $("#hdnStatus").val();
    }
    $(function () {
        $("#Loading").hide();
        $("#startDateclear").hide();
        $("#hdnStartDate").val($("#txtStartDate").val());
        $("#hdnEndDate").val($("#txtEndDate").val());
        DecimalValidation();
    });

    function DecimalValidation() {
        $(".clshours").keypress(function (event) {
            var $this = $(this);
            if ((event.which != 46 || $this.val().indexOf('.') != -1) &&
                ((event.which < 48 || event.which > 57) &&
                    (event.which != 0 && event.which != 8))) {
                event.preventDefault();
            }

            var text = $(this).val();
            if ((event.which == 46) && (text.indexOf('.') == -1)) {
                setTimeout(function () {
                    if ($this.val().substring($this.val().indexOf('.')).length > 3) {
                        $this.val($this.val().substring(0, $this.val().indexOf('.') + 3));
                    }
                }, 1);
            }

            if ((text.indexOf('.') != -1) &&
                (text.substring(text.indexOf('.')).length > 2) &&
                (event.which != 0 && event.which != 8) &&
                ($(this)[0].selectionStart >= text.length - 2)) {
                event.preventDefault();
            }
        });

        $(".costcode").keypress(function (event) {
            var regex = new RegExp("^[a-zA-Z0-9]+$");
            var key = String.fromCharCode(!event.charCode ? event.which : event.charCode);
            if (event.charCode!=44 && !regex.test(key)) {
                event.preventDefault();
                return false;
            }
        });
    }
    $("#startDateclear").click(function () {
        $("#txtStartDate").val("")
        $("#startDateclear").hide();

    })
    function Sdatekeypress() {
        var valid = true;
        if (parseFloat($("#hdnRowCount").val()) > 1) {
            if (!confirm("Are you sure, want to change the date? You have unsaved changes!")) {
                valid = false;
            }
        }
        if (!valid) {
            $("#txtStartDate").val($("#hdnStartDate").val());
            return false;
        }
       $("#startDateclear").show();
       var tempStartDate = new Date($('#txtStartDate').datepicker('getDate', '+1d'));
       var default_end = new Date(tempStartDate.getFullYear(), tempStartDate.getMonth(), tempStartDate.getDate() + 6);
       $("#txtEndDate").val((default_end.getMonth() + 1) + "-" + default_end.getDate() + "-" + default_end.getFullYear());
       $("#hdnStartDate").val($("#txtStartDate").val());
        $("#hdnEndDate").val($("#txtEndDate").val());
          $.ajax({
        url:  "@Url.Action("ChangeDates", "TimeSheet")",
        type: 'POST',
        data: $("#frmTimeSheet").serialize(),
        cache: true,
        success: function (result) {
            $("#divTimeSheetDetails").empty();
            $("#divTimeSheetDetails").html(result);
            DecimalValidation();
        }
            });
    }

    function ClearTimeSheet() {
        if (parseFloat($("#hdnRowCount").val()) > 1 || parseFloat($("#txtTotalId0").val()) > 1 ) {
            if (confirm("Are you sure, want to clear? You have unsaved changes!")) {
                 $.ajax({
        url:  "@Url.Action("ChangeDates", "TimeSheet")",
        type: 'POST',
        data: $("#frmTimeSheet").serialize(),
        cache: true,
        success: function (result) {
            $("#divTimeSheetDetails").empty();
            $("#divTimeSheetDetails").html(result);
            DecimalValidation();
            $("select").each(function () {
                $(this).val("");
            });
        }
            });
            }
        }
    }

    function RemoveJob(index) {
        $("#hdnIsDeleted" + index).val(true);
        $.ajax({
        url:  "@Url.Action("RemoveJobRow", "TimeSheet")",
        type: 'POST',
        data: $("#frmTimeSheet").serialize(),
        cache: true,
        success: function (result) {
            $("#divTimeSheetDetails").empty();
            $("#divTimeSheetDetails").html(result);
            DecimalValidation();
              },
              error: function (jqXHR, textStatus, errorThrown) {
                  var msg = '';
                  if (jqXHR.status === 0) {
                      msg = 'Not connect.\n Verify Network.';
                  } else if (jqXHR.status == 404) {
                      msg = 'Requested page not found. [404]';
                  } else if (jqXHR.status == 500) {
                      msg = 'Internal Server Error [500].';
                  } else if (exception === 'parsererror') {
                      msg = 'Requested JSON parse failed.';
                  } else if (exception === 'timeout') {
                      msg = 'Time out error.';
                  } else if (exception === 'abort') {
                      msg = 'Ajax request aborted.';
                  } else {
                      msg = 'Uncaught Error.\n' + jqXHR.responseText;
                  }
                  console.log(jqXHR.responseText);
                 // alert(msg);
              }
            });
    }

    function AddJob() {
        if (ValidateAddRow()) {
          $.ajax({
        url:  "@Url.Action("AddJobRow", "TimeSheet")",
        type: 'POST',
        data: $("#frmTimeSheet").serialize(),
        cache: true,
        success: function (result) {
            $("#divTimeSheetDetails").empty();
            $("#divTimeSheetDetails").html(result);
            DecimalValidation();
              },
              error: function (jqXHR, textStatus, errorThrown) {
                  var msg = '';
                  if (jqXHR.status === 0) {
                      msg = 'Not connect.\n Verify Network.';
                  } else if (jqXHR.status == 404) {
                      msg = 'Requested page not found. [404]';
                  } else if (jqXHR.status == 500) {
                      msg = 'Internal Server Error [500].';
                  } else if (exception === 'parsererror') {
                      msg = 'Requested JSON parse failed.';
                  } else if (exception === 'timeout') {
                      msg = 'Time out error.';
                  } else if (exception === 'abort') {
                      msg = 'Ajax request aborted.';
                  } else {
                      msg = 'Uncaught Error.\n' + jqXHR.responseText;
                  }
                  console.log(jqXHR.responseText);
                  // alert(msg);
              }
            });
        }
    }

    function ValidateAddRow() {
        var valid = true;
        $("#lblError").hide();
        $("select").each(function () {
            if ($(this).val() == "") {
                valid = false;
                //$("#lblError").show();
                //$("#lblError").text("Enter Details Before Selecting New Job");
                DisplayNotification("Enter Details Before Selecting New Job", "error");
            }
        });
        return valid;
    }

    function CheckPreviousJobs(id) {
        $("#lblError").hide();
        $("select").each(function () {
            if ($(this).attr("id") != id.id && $(this).val() == id.value) {
                $("#" + id.id).val("");
                //$("#lblError").show();
                //$("#lblError").text("Please Select Different Job");
                DisplayNotification("Please Select Different Job", "error");
            }
        });
    }

    function UpdateValues(thi, day, i) {
        $("#lblError").hide();
        if ($("#ddlJob" + i).val() == "") {
            thi.value = "";
            return false;
        }
        if (parseFloat(thi.value) > 24) {
            //$("#lblError").show();
            //$("#lblError").text("Please Enter values less than 24");
            DisplayNotification("Please Enter values less than 24", "error");
            thi.value = "";
            var hidval = $("#hdn" + day + "Id" + i).val().split('_');
            hidval[0] = parseFloat((thi.value == '' || thi.value == undefined || thi.value == null) ? 0 : thi.value);
            $("#hdn" + day + "Id" + i).val(hidval.join("_"));
            return false;
        }
        if (thi.value != '' && thi.value != undefined && thi.value != null) {
            var currVal = parseFloat((thi.value == '' || thi.value == undefined || thi.value == null) ? 0 : thi.value);
            var decimalVal = (currVal - Math.floor(currVal)).toFixed(2);
            var intVal = Math.floor(currVal);
            if (decimalVal > 0.13 && decimalVal <= 0.38) {
                thi.value = (intVal + 0.25).toString();
            } else if (decimalVal > 0.38 && decimalVal <= 0.63) {
                thi.value = (intVal + 0.50).toString();
            } else if (decimalVal > 0.63 && decimalVal <= 0.88) {
                thi.value = (intVal + 0.75).toString();
            } else if (decimalVal > 0.88 && decimalVal <= 0.99) {
                thi.value = (intVal + 1).toString();
            } else {
                thi.value = intVal.toString();
            }
        }
        var hidval = $("#hdn" + day + "Id" + i).val().split('_');
        hidval[0] = parseFloat((thi.value == '' || thi.value == undefined || thi.value == null) ? 0 : thi.value);
        $("#hdn" + day + "Id" + i).val(hidval.join("_"));
        var total = 0;
        $("[id^=hdn" + day + "Id]").each(function () {
            if ($(this).val() != '' && $(this).val() != undefined) {
                var alloc = $(this).val().split('_')[0];
                total += parseFloat((alloc == '' || alloc == undefined || alloc == null) ? 0 : alloc);
            }
        });
        if (parseFloat(total) > 24) {
            //$("#lblError").show();
            //$("#lblError").text("Please Enter values less than 24");
            DisplayNotification(day +" Total Hours less than 24", "error");
            thi.value = "";
            var hidval = $("#hdn" + day + "Id" + i).val().split('_');
            hidval[0] = parseFloat((thi.value == '' || thi.value == undefined || thi.value == null) ? 0 : thi.value);
            $("#hdn" + day + "Id" + i).val(hidval.join("_"));
            return false;
        }
        total = total.toFixed(2);
            $("#lblOT" + day).text(total > 8 ? total - 8 : 0);
       //$("#lbl" + day + "Hours").text(total > 8 ? 8 : total);
        $("#lbl" + day + "Hours").text(total);
            //CalculateTotalOTHours();
            total = 0;
            $('#divTimeSheetDetails input[type="text"]').each(function () {
                if ($(this).val() != '' && $(this).val() != undefined && $(this).attr("val") == i) {
                    var alloc = $(this).val();
                    total += parseFloat((alloc == '' || alloc == undefined || alloc == null) ? 0 : alloc);
                }
            });
        $("#txtTotalId" + i).val(total.toFixed(2));
            CalculateTotalHours();



    }


    function CalculateTotalHours() {
        var total = 0;
        $("[id^=txtTotalId]").each(function () {
            if ($(this).val() != '' && $(this).val() != undefined) {
                var alloc = $(this).val();
                total += parseFloat((alloc == '' || alloc == undefined || alloc == null) ? 0 : alloc);
            }
        });
        total = total.toFixed(2);
        $("#lblTotalHours").val(total);
        $("#lblProjectedTotalHours").text(total);
        $("#lblRegularHours").val(total <= 40 ? total : 40);
        $("#lblTotalOTHours").val(total > 40 ? (parseFloat($("#lblTotalHours").val()) - parseFloat($("#lblRegularHours").val())).toFixed(2):0);
    }

    function CalculateTotalOTHours() {
        //var totalOT = parseFloat($("#lblOTMonday").text()) + parseFloat($("#lblOTTuesday").text()) + parseFloat($("#lblOTWednesday").text()) + parseFloat($("#lblOTThursday").text()) + parseFloat($("#lblOTFriday").text()) + parseFloat($("#lblOTSaturday").text()) + parseFloat($("#lblOTSunday").text());
        //$("#lblTotalOTHours").val(totalOT);

        var totalRegularHours = parseFloat($("#lblMondayHours").text()) + parseFloat($("#lblTuesdayHours").text()) +
            parseFloat($("#lblWednesdayHours").text()) + parseFloat($("#lblThursdayHours").text())
            + parseFloat($("#lblFridayHours").text()) + parseFloat($("#lblSaturdayHours").text()) + parseFloat($("#lblSundayHours").text());
        $("#lblRegularHours").val(totalRegularHours);
    }

    function SaveTimeSheet(status) {
        if (ValidateSave() && $("#hidIsProcessed").val()=="0") {
            $("#hidIsProcessed").val("1");
            $("#lblError").hide();
            $("#hdnStatus").val(status);
             $.ajax({
        url:  "@Url.Action("SaveTimeSheet", "TimeSheet")",
        type: 'POST',
        data: $("#frmTimeSheet").serialize(),
        cache: true,
                 success: function (result) {
                     if (result == "Success") {
                         window.location.href = parseFloat($("#hdnFrom").val()) == 0 ? "@Url.Action("Index", "TimeSheet")" : "@Url.Action("TimeCard", "TimeSheet")";
                     }
                     else {
                         //$("#lblError").show();
                         //$("#lblError").text(result);
                         DisplayNotification(result, "error");
                     }
        }
            });
        }
    }

    function ValidateSave() {
        $("#lblError").hide();
        var valid = true;
        var count = 0;
        $("select").each(function () {
            if ($(this).val() == "") {
                count = count + 1;
            }
        });
        if ((parseFloat($("#hdnRowCount").val()) > 0 && count > 0)) {
            valid = false;
            //$("#lblError").text("Please Select Job");
            //$("#lblError").show();
            DisplayNotification("Please Select Job", "error");
        }
        return valid;
    }

    function ApproveOrReject(status) {
        if (ValidateApprove(status) && $("#hidIsProcessed").val()=="0") {
            $("#hidIsProcessed").val("1");
            $("#spnCommentError").hide();
            $("#hdnStatus").val(status);
             $.ajax({
        url:  "@Url.Action("ApproveOrRejectTimeSheet", "TimeSheet")",
        type: 'POST',
        data: $("#frmTimeSheet").serialize(),
        cache: true,
                 success: function (result) {
                     if (result == "Success") {
                         window.location.href = parseFloat($("#hdnFrom").val()) == 0 ? "@Url.Action("Index", "TimeSheet")" : "@Url.Action("TimeCard", "TimeSheet")?status=" + status;
                     }
                     else {
                         //$("#lblError").show();
                         //$("#lblError").text(result);
                         DisplayNotification(result, "error");
                     }
        }
            });
        }
    }

    function ValidateApprove(status) {
        $("#spnCommentError").hide();
        var valid = true;
        if (status == "Rejected" && $("#txtComments").val() == "") {
            valid = false;
            $("#spnCommentError").show();
            $("#spnCommentError").text("Please Enter Comments");
        }
        return valid;
    }
</script>
