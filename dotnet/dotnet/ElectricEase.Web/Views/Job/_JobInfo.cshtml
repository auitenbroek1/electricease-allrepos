@model ElectricEase.Models.Job_MasterInfo

@{
    ViewBag.Title = "JobInfo";

}
<head>
    <script src="~/Scripts/bootstrap-toggle.min.js"></script>
    <link href="~/Content/bootstrap-toggle.min.css" rel="stylesheet" />
    @*<script src="~/Scripts/jquery-ui-1.8.11.js"></script>*@

    <script src="~/Scripts/jquery-ui-1.10.3.min.js"></script>
    <link href="~/Content/themes/base/jquery-ui.css" rel="stylesheet" />
    <link href="~/Content/timepicki.css" rel="stylesheet" />
    <script src="~/Scripts/timepicki.js"></script>
</head>

<script>
    var ADD = 0
    $('#tablecalendar').dataTable();
    $(document).ready(function () {
        $(".time_element").timepicki({ reset: true, close: true });
        $("button").click(function () {
            $("p").slideToggle();

        });
        if ($('#hdnjobid').val() != "" && $('#hdnjobid').val() != "0") {
            // $("#startTime").val("00:00");
            // $("#endTime").val("00:00");
        }
        GetAttachmentInfo($('#hdnjobid').val());
    });

    function GetAttachmentInfo(val) {
        $.ajax({
            url: '../Job/AttachmentInfo?JobID=' + val,
            type: 'GET',
            success: function (data) {
                $('#divAttachment').html(data);
                //$('#Addbtn').text("Update");
                // getparts(val);
                // $('#Addbtn').text("Update");
            },
            error: function (err) {
                //alert("Error");
            }
        });
    }
    function milagecost(val) {
        $('#MileExpTotal').val(Number(Number($('#MileageCost').val()) * Number($('#ActualCost').val())).toFixed(2));
        $('#MileActTotal').val(Number(Number($('#MileageCost').val()) * Number($('#ActualCost').val())).toFixed(2));
        $('#MileEstTotal').val(Number(Number($('#MileageCost').val()) * Number($('#Estimated').val())).toFixed(2));
        estimatevalues();
    }
    function calculateoverhead(val) {
        var caloverhead = Number($('#OverExpTotal').val()) * Number(Number($('#SubEstTotal').val() / Number(100)));
        var calprofit = Number($('#ProfitPercentage').val()) * Number(Number($('#SubEstTotal').val() / Number(100)));
        var calsales = Number($('#SalesPercentage').val()) * Number(Number($('#SubEstTotal').val() / Number(100)));
        $('#EstimateExpTotal').val(caloverhead.toFixed(2));
        $('#ProfitEstTotal').val(calprofit.toFixed(2));
        $('#SalesEstTotal').val(calsales.toFixed(2));
    }
    function override(val) {
        $('#EstimateTotal').val($(val).val());
        if ($('#EstimateTotal').val() == '' || $('#EstimateTotal').val() == "0.00" || $('#EstimateTotal').val() == "0" || $('#EstimateOverride').val() == "") {
            $('#EstimateTotal').val($('#SubEstTotal').val());
        }
        profitcal();
    }
    function getjobclientdetails(val) {
        if ($(val).val() == "New Client" || $(val).val() == "") {
            $("[name=Other_ClientName]").removeAttr("disabled");
            $('#Client_ContactPerson').val("");
            $('#Client_Address').val("");
            $('#Client_Address2').val("");
            $('#Client_City').val("");
            $('#Client_State').val("");
            $('#Client_ZipCode').val("");
            $('#Client_Fax').val("");
            $('#Client_ZipCode').val("");
            $('#Client_Email').val("");
            $('#Client_Phone').val("");
            $('#Client_Mobile').val("");
            if ($(val).val() == "")
                $("[name=Other_ClientName]").attr("disabled", "disabled");
        }
        else {
            $("Other_ClientName").val('');
            $("[name=Other_ClientName]").attr("disabled", "disabled");

            $.ajax({

                url: '../Job/getjobclientdetails?name=' + $(val).val(),
                type: 'GET',
                success: function (data) {
                    $('#Client_ContactPerson').val(data.Client_ContactPerson);
                    $('#Client_Address').val(data.Client_Address);
                    $('#Client_Address2').val(data.Client_Address2);
                    $('#Client_City').val(data.Client_City);
                    $('#Client_State').val(data.Client_State);
                    $('#Client_ZipCode').val(data.Client_Zip);
                    $('#Client_Fax').val(data.Client_Fax);
                    //$('#Client_ZipCode').val(data.Client_ZipCode);
                    $('#Client_Email').val(data.Client_Email);
                    $('#Client_Phone').val(data.Client_Phone);
                    $('#Client_Mobile').val(data.Client_Mobile);
                }
            });
        }

    }
    function jobclientlocationdetails(val) {
        if ($(val).val() == "New Location") {
            $("[name=Other_Previous_Location]").removeAttr("disabled");
        }
        else {
            $("Other_Previous_Location").val('');
            $("[name=Other_Previous_Location]").attr("disabled", "disabled");

            if ($(val).val() != "") {
                $.ajax({
                    url: '../Job/getjobclientlocationdetails?name=' + $(val).val(),
                    type: 'GET',
                    success: function (data) {
                        $('#Work_Address').val(data.Work_Address);
                        $('#Work_Address2').val(data.Work_Address2);
                        $('#Work_City').val(data.Work_City);
                        $('#Work_State').val(data.Work_State);
                        $('#Work_Location').val(data.Work_Location);
                        $('#Work_ZipCode').val(data.Work_ZipCode);
                    }
                });
            }
        }

    }
    var fetchedassemblies = "";
    function ExpandTable(val) {

        var AsName = $(val).attr('data-assembly');
        var rownum = $(val).attr('data-row');
        var assemblyid = $(val).attr('data-assemblyid');
        var JobID = $('#Job_ID').val();
        var partstable = $(val).attr('data-target');
        var imgsrc = $(val).attr('src');
        if (imgsrc.indexOf('plus.png') > -1)
            $(val).attr('src', '../AppImges/minus.png');
        else
            $(val).attr('src', '../AppImges/plus.png');
        if (fetchedassemblies.indexOf(AsName + "-" + rownum) == -1) {

            $.ajax({
                url: '../Job/GetMyAssembliesDataInfo',
                data: { AsName: encodeURI( AsName ), JobID: JobID, AssemblyJobId: assemblyid },
                type: 'Get',
                success: function (data) {
                    
                    // calculatecost(AsName)

                    fetchedassemblies += AsName + "-" + rownum + ",";
                    $(partstable).html(data);
                    AsName = AsName.replace(/[^0-9a-z]/gi, '');

                    var totalrow = $('#Toggle' + rownum + ' #' + AsName + '_partstbody tr');
                    var estqty = 0;
                    var actualtotal = 0;
                    for (var i = 0; i < totalrow.length; i++) {
                        estqty = Number(estqty) + Number($('#' + AsName + '_' + i + '_2').val());
                        actualtotal = Number(actualtotal) + Number($('#' + AsName + '_' + i + '_6').val());
                        $('#Toggle' + rownum + ' #' + AsName + '_' + i + '_5').keyup();
                    }
                    $('#Toggle' + rownum + ' #' + AsName + '_labour_5').val($('#' + AsName + '_labour_2').val());
                    $('#Toggle' + rownum + ' #' + AsName + '_labour_6').val($('#' + AsName + '_labour_4').val());
                    $('#Toggle' + rownum + ' #A_' + rownum + '_0').val(estqty);
                    $('#Toggle' + rownum + ' #A_' + rownum + '_3').val(estqty);
                    actualtotal = Number(actualtotal) + Number($('#Toggle' + rownum + ' #' + AsName + '_labour_6').val());
                    $('#Toggle' + rownum + ' #A_' + rownum + '_4').val(actualtotal);

                    //calculatecost($('#Toggle' + rownum + ' #' + AsName + '_labour_5'));
                    estimatevalues();
                    //LaborTotal();
                },
                error: function (err) {
                    // alert("Error");
                }
            });
        }

    }

    function footertotal() {

        var estcost = 0.00;
        var estresale = 0.00;
        var actualtotal = 0.00;
        var totestcost = 0.00;
        var tfoot = $('#PartsTotal th');
        var assemblyrows = $('#Assembliesbody tr.accordion-toggle');
        for (var i = 0; i < assemblyrows.length; i++) {

            estcost = Number(estcost) + Number(assemblyrows[i].cells[7].children[0].value.trim());
            estresale = Number(estresale) + Number(assemblyrows[i].cells[8].children[0].value.trim());
            actualtotal = Number(actualtotal) + Number(assemblyrows[i].cells[9].children[0].value.trim());
            totestcost = Number(totestcost) + Number(assemblyrows[i].cells[10].children[0].value.trim());
        }
        //$(tfoot[1]).text(estcost.toFixed(2));
        if (isNaN(estcost)) {
            estcost = 0;
        }
        $("#Assembly_GrandExpTotal").val(estcost.toFixed(2));
        // $(tfoot[3]).text(estresale.toFixed(2));
        if (isNaN(estresale)) {
            estresale = 0;
        }
        $("#Assembly_GrandEstTotal").val(estresale.toFixed(2));
        //$(tfoot[4]).text(actualtotal.toFixed(2));
        if (isNaN(actualtotal)) {
            actualtotal = 0;
        }
        $("#Assembly_GrandActualTotal").val(actualtotal.toFixed(2));
        $("#Assembly_totalestcost").val(totestcost.toFixed(2));
        //Here getting Assembly total from Estimate total of assembly
        //$("#Estimate1_AssemblyTotal").val(actualtotal.toFixed(2));
        // $("#Estimate2_AssemblyTotal").val(actualtotal.toFixed(2));

        AssemblyTotal();
        LaborTotal();
        PartsTotal();
    }

    //Here Calculate AssemblyTotal
    function AssemblyTotal() {

        var assembliesest = $('#Assembliesbody tr.accordion-toggle');
        var estimatedtotal = 0;
        var exptotal = 0;
        var acttotal = 0;
        var totestcost = 0;
        var Estmatetotal2 = 0;
        for (var i = 0; i < assembliesest.length; i++) {

            exptotal = Number(exptotal) + Number(assembliesest[i].cells[7].children[0].value.trim());
            estimatedtotal = Number(estimatedtotal) + Number(assembliesest[i].cells[8].children[0].value.trim());
            acttotal = Number(acttotal) + Number(assembliesest[i].cells[9].children[0].value.trim());
            totestcost = Number(totestcost) + Number(assembliesest[i].cells[10].children[0].value.trim());
            Estmatetotal2 = Number(Estmatetotal2) + (Number(assembliesest[i].cells[2].children[0].value.trim()) * Number(assembliesest[i].cells[3].children[0].value.trim()) * Number(assembliesest[i].cells[5].children[0].value.trim()));

        }
        if (isNaN(estimatedtotal)) {
            estimatedtotal = 0;
        }
        $("#Estimate1_AssemblyTotal").val(estimatedtotal.toFixed(2));
        if (isNaN(exptotal)) {
            exptotal = 0;
        }
        $("#Estimate2_AssemblyTotal").val(Estmatetotal2.toFixed(2));
        estimatevalues();
        bid_summary_update_labor_row_1();
        bid_summary_update_material_row_1();
    }

    //Here Calculating Labortotal for Estimate
    function LaborTotal() {

        var assemblyname = "";
        var Est_labortotal = 0;
        var Exp_labortotal = 0;
        var EstCost_labortotal = 0;
        var assemblyTable = $('#Assembliesbody tr.accordion-toggle');

        //Assembly labor Calculation
        //if (assemblyTable.length > 0) {
        //
        //    for (var a = 0; a < assemblyTable.length; a++) {
        //
        //        var assemblyname = assemblyTable[a].cells[0].innerText.trim();
        //        if (assemblyname.indexOf(' ') > -1) {
        //            assemblyname = assemblyname.replace(/ /g, "_");
        //        }

        //        var Aslabvalue = $('#Toggle' + a + ' #' + assemblyname + '_labour_4').val();
        //        if (typeof Aslabvalue != 'undefined') {
        //            labortotal += Number(Aslabvalue);
        //        }
        //        else {
        //            labortotal += Number($("#Estimate1_LaborTotal").val()) == "" ? 0 : Number($("#Estimate1_LaborTotal").val())
        //        }
        //    }
        //}
        var Labortable = $("#Laborbody tr");
        if (Labortable.length > 0) {
            var est_lab = $("#Labor_GrandEstTotal").val();
            if (Number(est_lab)) {
                Est_labortotal += Number(est_lab);
            }
            var exp_lab = $("#Labor_GrandExpTotal").val();
            if (Number(exp_lab)) {
                Exp_labortotal += Number(exp_lab);
            }
            var estcost_lab = $('#Labor_GrandEstCostTotal').val();
            if (Number(estcost_lab)) {
                EstCost_labortotal += Number(estcost_lab);
            }
        }
        else {
            labortotal = 0.00;
        }
        if (isNaN(Est_labortotal)) {
            Est_labortotal = 0;

        }
        $("#Estimate1_LaborTotal").val(Est_labortotal.toFixed(2));
        if (isNaN(Exp_labortotal)) {
            Exp_labortotal = 0;
        }
        $("#Estimate2_LaborTotal").val(EstCost_labortotal.toFixed(2));
        CalculateEstimateONE();
        CalculateEstimateTWO();
        estimatevalues();
        bid_summary_update_labor_row_2();
    }
    //Here Calculate PartsTotal for Estimate
    function PartsTotal() {

        var assemblyname = "";
        var Est_Partstotal = 0;
        var Exp_Partstotal = 0;
        var EstCost_Partstotal = 0;
        var assemblyTable = $('#Assembliesbody tr.accordion-toggle');
        //Here assembly Parts Calculation
        //if (assemblyTable.length > 0) {
        //
        //    for (var a = 0; a < assemblyTable.length; a++) {
        //
        //        var assemblyname = assemblyTable[a].cells[0].innerText.trim();
        //        if (assemblyname.indexOf(' ') > -1) {
        //            assemblyname = assemblyname.replace(/ /g, "_");
        //        }

        //        var Est_AsPartsresaletotal = $('#Toggle' + a + ' #' + assemblyname + '_total_1').val();
        //        if (typeof Est_AsPartsresaletotal != 'undefined')
        //        {
        //             Partstotal += Number(Est_AsPartsresaletotal);
        //        }
        //        else {
        //            Partstotal +=Number($("#Estimate1_PartsTotal").val())== "" ? 0 : Number($("#Estimate1_PartsTotal").val())
        //        }

        //    }
        //}
        var partstable = $("#partstbody tr");
        if (partstable.length > 0) {
            var part_Est_Total = $("#Parts_GrandEstTotal").val();
            var Part_Exp_total = $("#Parts_GrandExpTotal").val();
            var part_Cost_Total = $("#Parts_GrandEstCostTotal").val();
            if (Number(part_Est_Total)) {
                Est_Partstotal += Number(part_Est_Total);
            }
            if (Number(Part_Exp_total)) {
                Exp_Partstotal += Number(Part_Exp_total);
            }
            if (Number(part_Cost_Total)) {
                EstCost_Partstotal += Number(part_Cost_Total);
            }
        }
        else {
            Partstotal = 0.00;
        }

        if (isNaN(Est_Partstotal)) {
            Est_Partstotal = 0;
        }
        $("#Estimate1_PartsTotal").val(Est_Partstotal.toFixed(2));
        if (isNaN(Exp_Partstotal)) {
            Exp_Partstotal = 0;
        }
        $("#Estimate2_PartsTotal").val(EstCost_Partstotal.toFixed(2));
        CalculateEstimateONE();
        CalculateEstimateTWO();
        estimatevalues();
        bid_summary_update_labor_row_3();
        bid_summary_update_material_row_2();
    }

    //Here Calculating Dje and VQ total
    function DJEandVQ() {
        var Dje_Costtotal = 0;
        var Vq_Costtotal = 0;


        $("#Estimate1_DJETotal").val(Number($("#Dje_total").val()).toFixed(2));
        $("#Estimate1_VQTotal").val(Number($("#VQ_total").val()).toFixed(2));

        var DJEbody = $('#estimatebody tr');
        if (DJEbody.length > 0) {
            for (var i = 0; i < DJEbody.length; i++) {
                var resaletot = Number(DJEbody[i].cells[2].children[0].value) + (Number(DJEbody[i].cells[2].children[0].value) * ((Number(DJEbody[i].cells[3].children[0].value)) / 100));
                if (isNaN(resaletot)) {
                    resaletot = 0;
                }
                DJEbody[i].cells[5].children[0].value = Number(resaletot).toFixed(2);
                if (DJEbody[i].cells[4].children[0].value == "DJE") {

                    Dje_Costtotal += Number(DJEbody[i].cells[2].children[0].value);
                    if (isNaN(Dje_Costtotal)) {
                        Dje_Costtotal = 0;

                    }
                }
                if (DJEbody[i].cells[4].children[0].value == "VQ") {

                    Vq_Costtotal += Number(DJEbody[i].cells[2].children[0].value);
                    if (isNaN(Vq_Costtotal)) {
                        Vq_Costtotal = 0;
                    }
                }
            }
        }
        else {
            Dje_Costtotal = 0;
            Vq_Costtotal = 0;
        }
        $("#Estimate2_DJETotal").val(Dje_Costtotal.toFixed(2));
        $("#Estimate2_VQTotal").val(Vq_Costtotal.toFixed(2));
        estimatevalues();
    }
    //Here Assigning Estimate Value to Job Total
    function GetEstimation() {

        var estimateresult = 0.00;
        if ($("#estimate1").prop("checked") == true) {
            estimateresult = Number($("#Estimate1_GrandTotal").val());
            $("#Estoption").text("Based on Estimate 1");


        }
        if ($("#estimate2").prop("checked")) {
            estimateresult = Number($("#Estimate2_GrandSubtotal").val());
            $("#Estoption").text("Based on Estimate 2");
        }
        if ($("#estimate3").prop("checked")) {
            estimateresult = Number($("#Estimation3_Override").val());
            $("#Estoption").text("Based on Estimate 3");
        }
        if (isNaN(estimateresult)) {
            estimateresult = 0;
        }
        $("#EstimateTotal").val(estimateresult.toFixed(2));
        profitcal();
    }
    $("#estimate2").change(function () {

        $("#estimate1").attr('checked', false);
        $("#estimate3").attr('checked', false);

        CalculateEstimateTWO();
        profitcal();
    });
    $("#estimate1").change(function () {
        $("#estimate2").attr('checked', false);
        $("#estimate3").attr('checked', false);
        CalculateEstimateONE();
        profitcal();
    });
    $("#estimate3").change(function () {
        $("#estimate1").attr('checked', false);
        $("#estimate2").attr('checked', false);
        GetEstimation();

    });
    //Here calculate Estimate ONE
    function CalculateEstimateONE() {

        var EstimateONE_Grandtotal = 0.00;
        var EstimateONE_grandtaxTotal = 0.00;
        var Est_assembly = 0.00;
        var Est_Labor = 0.00;
        var Est_Parts = 0.00;
        var Est_DJE = 0.00;
        var Est_VQ = 0.00;
        var estimateONETotal = 0.00;
        var Assembly_Total = $("#Estimate1_AssemblyTotal").val() == "" ? 0 : $("#Estimate1_AssemblyTotal").val();
        var Lobor_Total = $("#Estimate1_LaborTotal").val() == "" ? 0 : $("#Estimate1_LaborTotal").val();
        var Parts_Total = $("#Estimate1_PartsTotal").val() == "" ? 0 : $("#Estimate1_PartsTotal").val();
        var DJE_Total = $("#Estimate1_DJETotal").val() == "" ? 0 : $("#Estimate1_DJETotal").val();
        var VQ_Total = $("#Estimate1_VQTotal").val() == "" ? 0 : $("#Estimate1_VQTotal").val();
        var Assembly_Tax = $("#Estimate1_AssemblyTax").val() == "" ? 0 : $("#Estimate1_AssemblyTax").val();
        var Lobor_Tax = $("#Estimate1_LaborTax").val() == "" ? 0 : $("#Estimate1_LaborTax").val();
        var Parts_Tax = $("#Estimate1_PartsTax").val() == "" ? 0 : $("#Estimate1_PartsTax").val();
        var DJE_Tax = $("#Estimate1_DJETax").val() == "" ? 0 : $("#Estimate1_DJETax").val();
        var VQ_Tax = $("#Estimate1_VQTax").val() == "" ? 0 : $("#Estimate1_VQTax").val();

        //Here Calculating  EstimateONE grandtaxTotal
        EstimateONE_grandtaxTotal = Number(Assembly_Tax) + Number(Lobor_Tax) + Number(Parts_Tax) + Number(DJE_Tax) + Number(VQ_Tax);
        if (isNaN(EstimateONE_grandtaxTotal)) {
            EstimateONE_grandtaxTotal = 0;
        }
        $("#Estimate1_GrandTotalTax").val(Number(EstimateONE_grandtaxTotal).toFixed(2));

        //Here Calculating Estimate Grand Total
        EstimateONE_Grandtotal = Number(Assembly_Total) + Number(Lobor_Total) + Number(Parts_Total) + Number(DJE_Total) + Number(VQ_Total);
        if (isNaN(EstimateONE_Grandtotal)) {
            EstimateONE_Grandtotal = 0;
        }
        $("#Estimate1_GrandTotal").val(EstimateONE_Grandtotal.toFixed(2))

        //Here Calculating  EstimateONE with Tax  percentage
        Est_assembly = Number(Assembly_Total) + (Number(Assembly_Total) * Number(Assembly_Tax) / 100);
        if (isNaN(Est_assembly)) {
            Est_assembly = 0;
        }
        Est_Labor = Number(Lobor_Total) + (Number(Lobor_Total) * Number(Lobor_Tax) / 100);
        if (isNaN(Est_Labor)) {
            Est_Labor = 0;
        }
        Est_Parts = Number(Parts_Total) + (Number(Parts_Total) * Number(Parts_Tax) / 100);
        if (isNaN(Est_Parts)) {
            Est_Parts = 0;
        }
        Est_DJE = Number(DJE_Total) + (Number(DJE_Total) * Number(DJE_Tax) / 100);
        if (isNaN(Est_DJE)) {
            Est_DJE = 0;
        }
        Est_VQ = Number(VQ_Total) + (Number(VQ_Total) * Number(VQ_Tax) / 100);
        if (isNaN(Est_VQ)) {
            Est_VQ = 0;
        }

        $("#Estimate1_Assembly").val(Est_assembly.toFixed(2));
        $("#Estimate1_Labor").val(Est_Labor.toFixed(2));
        $("#Estimate1_Parts").val(Est_Parts.toFixed(2));
        $("#Estimate1_DJE").val(Est_DJE.toFixed(2));
        $("#Estimate1_VQ").val(Est_VQ.toFixed(2));
        //Here Calculating Estimete ONE Total
        estimateONETotal = Number(Est_assembly) + Number(Est_Labor) + Number(Est_Parts) + Number(Est_DJE) + Number(Est_VQ)
        if (isNaN(estimateONETotal)) {
            estimateONETotal = 0;
        }
        $("#Estimate1_GrandTotalvalue").val(estimateONETotal.toFixed(2));
        GetEstimation();
    }

    //Here Calculating Estimate Two
    function CalculateEstimateTWO() {

        var EstimateTWO_Grandtotal = 0.00;
        var EstimateTWO_grandtaxTotal = 0.00;
        var EstimateTWO_grandProfitTotal = 0.00;
        var Est_Subassembly = 0.00;
        var Est_SubLabor = 0.00;
        var Est_SubParts = 0.00;
        var Est_SubDJE = 0.00;
        var Est_SubVQ = 0.00;
        var EstimateTWO_grandSubTotal = 0.00;
        var Est_assembly = 0.00;
        var Est_Labor = 0.00;
        var Est_Parts = 0.00;
        var Est_DJE = 0.00;
        var Est_VQ = 0.00;
        var estimateTWOTotal = 0.00;
        var Assembly_Total = $("#Estimate2_AssemblyTotal").val() == "" ? 0 : $("#Estimate2_AssemblyTotal").val();
        var Lobor_Total = $("#Estimate1_LaborTotal").val() == "" ? 0 : $("#Estimate2_LaborTotal").val();
        var Parts_Total = $("#Estimate2_PartsTotal").val() == "" ? 0 : $("#Estimate2_PartsTotal").val();
        var DJE_Total = $("#Estimate2_DJETotal").val() == "" ? 0 : $("#Estimate2_DJETotal").val();
        var VQ_Total = $("#Estimate2_VQTotal").val() == "" ? 0 : $("#Estimate2_VQTotal").val();
        //Here Calculating EstimateTWO Grand Sub Total
        EstimateTWO_Grandtotal = Number(Assembly_Total) + Number(Lobor_Total) + Number(Parts_Total) + Number(DJE_Total) + Number(VQ_Total);
        $("#Estimate2_GrandTotal").val(EstimateTWO_Grandtotal.toFixed(2));

        var Assembly_Profit = $("#Estimate2_AssemblyProfit").val() == "" ? 0 : $("#Estimate2_AssemblyProfit").val();
        var Lobor_Profit = $("#Estimate2_LaborProfit").val() == "" ? 0 : $("#Estimate2_LaborProfit").val();
        var Parts_Profit = $("#Estimate2_PartsProfit").val() == "" ? 0 : $("#Estimate2_PartsProfit").val();
        var DJE_Profit = $("#Estimate2_DJEProfit").val() == "" ? 0 : $("#Estimate2_DJEProfit").val();
        var VQ_Profit = $("#Estimate2_VQProfit").val() == "" ? 0 : $("#Estimate2_VQProfit").val();
        //Here Calculating  EstimateTWO grandtaxTotal
        EstimateTWO_grandProfitTotal = Number(Assembly_Profit) + Number(Lobor_Profit) + Number(Parts_Profit) + Number(DJE_Profit) + Number(VQ_Profit);
        // $("#Estimate2_GrandProfitTotal").val(EstimateTWO_grandProfitTotal);

        //Here Calculating  EstimateTWO with Tax  percentage
        Est_Subassembly = Number(Assembly_Total) + (Number(Assembly_Total) * Number(Assembly_Profit) / 100);
        if (isNaN(Est_Subassembly)) {
            Est_Subassembly = 0;
        }
        Est_SubLabor = Number(Lobor_Total) + (Number(Lobor_Total) * Number(Lobor_Profit) / 100);
        if (isNaN(Est_SubLabor)) {
            Est_SubLabor = 0;
        }
        Est_SubParts = Number(Parts_Total) + (Number(Parts_Total) * Number(Parts_Profit) / 100);
        if (isNaN(Est_SubParts)) {
            Est_SubParts = 0;
        }
        Est_SubDJE = Number(DJE_Total) + (Number(DJE_Total) * Number(DJE_Profit) / 100);
        if (isNaN(Est_SubDJE)) {
            Est_SubDJE = 0;
        }
        Est_SUbVQ = Number(VQ_Total) + (Number(VQ_Total) * Number(VQ_Profit) / 100);
        if (isNaN(Est_SUbVQ)) {
            Est_SUbVQ = 0;
        }

        //Here Calculating EstimateTWO Grand Sub Total
        EstimateTWO_grandSubTotal = Number(Est_Subassembly) + Number(Est_SubLabor) + Number(Est_SubParts) + Number(Est_SubDJE) + Number(Est_SUbVQ);
        $("#Estimate2_GrandSubtotal").val(EstimateTWO_grandSubTotal.toFixed(2))

        $("#Estimate2_AssemblySubtotal").val(Est_Subassembly.toFixed(2));
        $("#Estimate2_LaborSubtotal").val(Est_SubLabor.toFixed(2));
        $("#Estimate2_PartsSubtotal").val(Est_SubParts.toFixed(2));
        $("#Estimate2_DJESubtotal").val(Est_SubDJE.toFixed(2));
        $("#Estimate2_VQSubtotal").val(Est_SUbVQ.toFixed(2));

        var Assembly_Tax = $("#Estimate2_AssemblyTax").val() == "" ? 0 : $("#Estimate2_AssemblyTax").val();
        var Lobor_Tax = $("#Estimate2_LaborTax").val() == "" ? 0 : $("#Estimate2_LaborTax").val();
        var Parts_Tax = $("#Estimate2_PartsTax").val() == "" ? 0 : $("#Estimate2_PartsTax").val();
        var DJE_Tax = $("#Estimate2_DJETax").val() == "" ? 0 : $("#Estimate2_DJETax").val();
        var VQ_Tax = $("#Estimate2_VQTax").val() == "" ? 0 : $("#Estimate2_VQTax").val();
        //Here Calculating  EstimateTWO grandtaxTotal
        EstimateTWO_grandtaxTotal = Number(Assembly_Tax) + Number(Lobor_Tax) + Number(Parts_Tax) + Number(DJE_Tax) + Number(VQ_Tax);
        //  $("#Estimate2_GrandTaxTotal").val(EstimateTWO_grandtaxTotal);

        ////Here Calculating  EstimateTWO  by using Sub Total with Tax  percentage
        Est_assembly = Number(Est_Subassembly) + (Number(Est_Subassembly) * Number(Assembly_Tax) / 100);
        if (isNaN(Est_assembly)) {
            Est_assembly = 0;
        }
        Est_Labor = Number(Est_SubLabor) + (Number(Est_SubLabor) * Number(Lobor_Tax) / 100);
        if (isNaN(Est_Labor)) {
            Est_Labor = 0;
        }
        Est_Parts = Number(Est_SubParts) + (Number(Est_SubParts) * Number(Parts_Tax) / 100);
        if (isNaN(Est_Parts)) {
            Est_Parts = 0;
        }
        Est_DJE = Number(Est_SubDJE) + (Number(Est_SubDJE) * Number(DJE_Tax) / 100);
        if (isNaN(Est_DJE)) {
            Est_DJE = 0;
        }
        Est_VQ = Number(Est_SUbVQ) + (Number(Est_SUbVQ) * Number(VQ_Tax) / 100);
        if (isNaN(Est_VQ)) {
            Est_VQ = 0;
        }

        $("#Estimate2_Assembly").val(Est_assembly.toFixed(2));
        $("#Estimate2_Labor").val(Est_Labor.toFixed(2));
        $("#Estimate2_Parts").val(Est_Parts.toFixed(2));
        $("#Estimate2_DJE").val(Est_DJE.toFixed(2));
        $("#Estimate2_VQ").val(Est_VQ.toFixed(2));

        //Here Calculating Estimete ONE Total
        estimateTWOTotal = Number(Est_assembly) + Number(Est_Labor) + Number(Est_Parts) + Number(Est_DJE) + Number(Est_VQ)
        if (isNaN(estimateTWOTotal)) {
            estimateTWOTotal = 0;
        }
        $("#Estimate2Total").val(estimateTWOTotal.toFixed(2));
        GetEstimation();
    }

    //Here Calculate Estimate Three
    function CalculateEstimateTHREE() {
        if ($("#estimate3").prop("checked")) {
            estimateresult = Number($("#Estimation3_Override").val());
            if (isNaN(estimateresult)) {
                estimateresult = 0;
            }
            $("#EstimateTotal").val(estimateresult.toFixed(2));
            profitcal();
        }

    }
    function calculateoverall(val) {

        var AsName = val;
        var asnname = val;
        if (typeof val.id != 'undefined') {
            var idsplit = val.id.split('_');
            AsName = idsplit[0];
            for (var i = 1; i < idsplit.length - 2; i++) {
                AsName += "_" + idsplit[i];
            }

            asnname = $(val).parent().parent().parent().parent().parent().parent();
            asnname = asnname[0].id;
            asnname = asnname.substr(6, 1);
        }
        AsName = AsName.replace(/[^0-9a-z]/gi, '');

        var rownum = $('#' + AsName + '-' + asnname).attr('data-row');
        var totalrow = $('#Toggle' + rownum + ' #' + AsName + '_partstbody tr');
        var totalrowassem = $('#Toggle' + rownum + ' #' + AsName + '_partstbodyassem tr');

        var rowlength = Number(totalrow.length);

        if (typeof totalrowassem.length != 'undefined') {
            rowlength = Number(rowlength) + Number(totalrowassem.length);
        }
        var estqty = 0;
        var actualtotal = 0;
        var estcosttotal = 0;
        var estresaltotal = 0;
        var actualqty = 0;
        var defaultActualQty = 0;
        for (var i = 0; i < rowlength; i++) {


            // actualqty = Number(actualqty) + Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_5').val() == "" ? $('#Toggle' + rownum + ' #' + AsName + '_' + i + '_5').val($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_2').val()) : $('#Toggle' + rownum + ' #' + AsName + '_' + i + '_5').val());
            estqty = Number(estqty) + Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_2').val());
            if (isNaN(estqty)) {
                estqty = 0;

            }
            var acttot = Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_5').val()) * Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_1').val());
            if (isNaN(acttot)) {
                acttot = 0;

            }
            $('#Toggle' + rownum + ' #' + AsName + '_' + i + '_6').val(Number(acttot).toFixed(2));
            var estresale = Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_2').val()) * Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_1').val());
            if (isNaN(estresale)) {
                estresale = 0;

            }
            $('#Toggle' + rownum + ' #' + AsName + '_' + i + '_4').val(Number(estresale).toFixed(2));
            var estcost = Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_2').val()) * Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_0').val());
            if (isNaN(estcost)) {
                estcost = 0;

            }
            $('#Toggle' + rownum + ' #' + AsName + '_' + i + '_3').val(Number(estcost).toFixed(2));
            actualtotal = Number(actualtotal) + Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_6').val());
            if (isNaN(actualtotal)) {
                actualtotal = 0;

            }
            estcosttotal = Number(estcosttotal) + Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_3').val());
            if (isNaN(estcosttotal)) {
                estcosttotal = 0;

            }
            estresaltotal = Number(estresaltotal) + Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_4').val());
            if (isNaN(estresaltotal)) {
                estresaltotal = 0;

            }
        }
        $('#Toggle' + rownum + ' #' + AsName + '_total_0').val(estcosttotal.toFixed(2));
        $('#Toggle' + rownum + ' #' + AsName + '_total_1').val(estresaltotal.toFixed(2));
        $('#Toggle' + rownum + ' #' + AsName + '_total_2').val(actualtotal.toFixed(2));
        $('#Toggle' + rownum + ' #' + AsName + '_labour_6').val((Number($('#Toggle' + rownum + ' #' + AsName + '_labour_1').val()) * Number($('#Toggle' + rownum + ' #' + AsName + '_labour_5').val())).toFixed(2));
        $('#Toggle' + rownum + ' #' + AsName + '_labour_3').val((Number($('#Toggle' + rownum + ' #' + AsName + '_labour_2').val()) * Number($('#Toggle' + rownum + ' #' + AsName + '_labour_0').val())).toFixed(2));
        $('#Toggle' + rownum + ' #' + AsName + '_labour_4').val((Number($('#Toggle' + rownum + ' #' + AsName + '_labour_1').val()) * Number($('#Toggle' + rownum + ' #' + AsName + '_labour_2').val())).toFixed(2));
        $('#Toggle' + rownum + ' #' + AsName + '_grandtotal_0').val((Number(estcosttotal) + Number($('#Toggle' + rownum + ' #' + AsName + '_labour_3').val())).toFixed(2));
        $('#Toggle' + rownum + ' #' + AsName + '_grandtotal_1').val((Number(estresaltotal) + Number($('#Toggle' + rownum + ' #' + AsName + '_labour_4').val())).toFixed(2));
        $('#Toggle' + rownum + ' #' + AsName + '_grandtotal_2').val((Number(actualtotal) + Number($('#Toggle' + rownum + ' #' + AsName + '_labour_6').val())).toFixed(2));

        var tot = Number($('#Toggle' + rownum + ' #' + AsName + '_grandtotal_0').val()).toFixed(2) * Number(estqty.toFixed(2)) * Number($('#Toggle' + rownum + ' #' + AsName + '_multiplier').val());
        //$('#A_' + rownum + '_10').val(Number($('#Toggle' + rownum + ' #' + AsName + '_grandtotal_0').val()).toFixed(2) * Number(estqty.toFixed(2)) * Number($('#Toggle' + rownum + ' #' + AsName + '_multiplier').val()));
        // $('#A_' + rownum + '_11').val(Number($('#Toggle' + rownum + ' #' + AsName + '_grandtotal_1').val()).toFixed(2) * Number(estqty.toFixed(2)) * Number($('#Toggle' + rownum + ' #' + AsName + '_multiplier').val()));
        $('#A_' + rownum + '_1').val(Number($('#Toggle' + rownum + ' #' + AsName + '_grandtotal_0').val()).toFixed(2) * Number(estqty.toFixed(2)) * Number($('#Toggle' + rownum + ' #' + AsName + '_multiplier').val()));
        $('#A_' + rownum + '_2').val(Number($('#Toggle' + rownum + ' #' + AsName + '_grandtotal_1').val()).toFixed(2) * Number(estqty.toFixed(2)) * Number($('#Toggle' + rownum + ' #' + AsName + '_multiplier').val()));
        actualtotal = Number(actualtotal) + Number($('#Toggle' + rownum + ' #' + AsName + '_labour_6').val());
        if (isNaN(actualtotal)) {
            actualtotal = 0;

        }
        //$('#A_' + rownum + '_4').val(actualtotal.toFixed(2));
        calculatemultiplier(AsName, rownum);
        estimatevalues();
        footertotal();
        AssemblyTotal();

    }
    function calculatecost(val) {
        // $(val).val($(val).val().replace(/\d/, ''));
        var AsName = val;
        var asnname = val;
        if (typeof val.id != 'undefined') {
            var idsplit = val.id.split('_');
            AsName = idsplit[0];
            for (var i = 1; i < idsplit.length - 2; i++) {
                AsName += "_" + idsplit[i];
            }
            asnname = $(val).parent().parent().parent().parent().parent().parent();
            asnname = asnname[0].id;
            asnname = asnname.substr(6, 1);
        }
        AsName = AsName.replace(/[^0-9a-z]/gi, '');

        var rownum = $('#' + AsName + '-' + asnname).attr('data-row');
        var totalrow = $('#Toggle' + rownum + ' #' + AsName + '_partstbody tr');
        var totalrowassem = $('#Toggle' + rownum + ' #' + AsName + '_partstbodyassem tr');

        var rowlength = Number(totalrow.length);

        if (typeof totalrowassem.length != 'undefined') {
            rowlength = Number(rowlength) + Number(totalrowassem.length);
        }
        var estqty = 0;
        var actualtotal = 0;
        var estcosttotal = 0;
        var estresaltotal = 0;
        var actualqty = 0;
        var defaultActualQty = 0;


        for (var i = 0; i < rowlength; i++) {

            actualqty = Number(actualqty) + Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_5').val() == "" ? 0 : $('#Toggle' + rownum + ' #' + AsName + '_' + i + '_5').val());

            if (isNaN(actualqty)) {
                actualqty = 0;
            }
            estqty = Number(estqty) + Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_2').val());
            if (isNaN(estqty)) {
                estqty = 0;
            }
            var acttot = Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_5').val()) * Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_1').val());
            if (isNaN(acttot)) {
                acttot = 0;
            }
            $('#Toggle' + rownum + ' #' + AsName + '_' + i + '_6').val(Number(acttot).toFixed(2));
            var estresale = Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_2').val()) * Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_1').val());
            if (isNaN(estresale)) {
                estresale = 0;
            }
            $('#Toggle' + rownum + ' #' + AsName + '_' + i + '_4').val(Number(estresale).toFixed(2));
            var estcost = Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_2').val()) * Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_0').val());
            if (isNaN(estcost)) {
                estcost = 0;

            }
            $('#Toggle' + rownum + ' #' + AsName + '_' + i + '_3').val(Number(estcost).toFixed(2));
            actualtotal = Number(actualtotal) + Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_6').val());
            if (isNaN(actualtotal)) {
                actualtotal = 0;
            }

            estcosttotal = Number(estcosttotal) + Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_3').val());
            if (isNaN(estcosttotal)) {
                estcosttotal = 0;
            }
            estresaltotal = Number(estresaltotal) + Number($('#Toggle' + rownum + ' #' + AsName + '_' + i + '_4').val());
            if (isNaN(estresaltotal)) {
                estresaltotal = 0;
            }
        }


        $('#Toggle' + rownum + ' #' + AsName + '_total_0').val(estcosttotal.toFixed(2));
        $('#Toggle' + rownum + ' #' + AsName + '_total_1').val(estresaltotal.toFixed(2));
        $('#Toggle' + rownum + ' #' + AsName + '_total_2').val(actualtotal.toFixed(2));
        $('#Toggle' + rownum + ' #' + AsName + '_labour_5').val($('#Toggle' + rownum + ' #' + AsName + '_labour_2').val());
        $('#Toggle' + rownum + ' #' + AsName + '_labour_6').val((Number($('#Toggle' + rownum + ' #' + AsName + '_labour_1').val()) * Number($('#Toggle' + rownum + ' #' + AsName + '_labour_5').val())).toFixed(2));
        $('#Toggle' + rownum + ' #' + AsName + '_labour_3').val((Number($('#Toggle' + rownum + ' #' + AsName + '_labour_2').val()) * Number($('#Toggle' + rownum + ' #' + AsName + '_labour_0').val())).toFixed(2));
        $('#Toggle' + rownum + ' #' + AsName + '_labour_4').val((Number($('#Toggle' + rownum + ' #' + AsName + '_labour_1').val()) * Number($('#Toggle' + rownum + ' #' + AsName + '_labour_2').val())).toFixed(2));
        $('#Toggle' + rownum + ' #' + AsName + '_grandtotal_0').val((Number(estcosttotal) + Number($('#Toggle' + rownum + ' #' + AsName + '_labour_3').val())).toFixed(2));
        $('#Toggle' + rownum + ' #' + AsName + '_grandtotal_1').val((Number(estresaltotal) + Number($('#Toggle' + rownum + ' #' + AsName + '_labour_4').val())).toFixed(2));
        $('#Toggle' + rownum + ' #' + AsName + '_grandtotal_2').val((Number(actualtotal) + Number($('#Toggle' + rownum + ' #' + AsName + '_labour_6').val())).toFixed(2));

        var tot = Number($('#Toggle' + rownum + ' #' + AsName + '_grandtotal_0').val()).toFixed(2) * Number(estqty.toFixed(2)) * Number($('#Toggle' + rownum + ' #' + AsName + '_multiplier').val());
        //$('#A_' + rownum + '_10').val(Number($('#Toggle' + rownum + ' #' + AsName + '_grandtotal_0').val()).toFixed(2) * Number(estqty.toFixed(2)) * Number($('#Toggle' + rownum + ' #' + AsName + '_multiplier').val()));
        // $('#A_' + rownum + '_11').val(Number($('#Toggle' + rownum + ' #' + AsName + '_grandtotal_1').val()).toFixed(2) * Number(estqty.toFixed(2)) * Number($('#Toggle' + rownum + ' #' + AsName + '_multiplier').val()));
        $('#A_' + rownum + '_1').val(Number($('#Toggle' + rownum + ' #' + AsName + '_grandtotal_0').val()).toFixed(2) * Number(estqty.toFixed(2)) * Number($('#Toggle' + rownum + ' #' + AsName + '_multiplier').val()));
        $('#A_' + rownum + '_2').val(Number($('#Toggle' + rownum + ' #' + AsName + '_grandtotal_1').val()).toFixed(2) * Number(estqty.toFixed(2)) * Number($('#Toggle' + rownum + ' #' + AsName + '_multiplier').val()));
        actualtotal = Number(actualtotal) + Number($('#Toggle' + rownum + ' #' + AsName + '_labour_6').val());
        if (isNaN(actualtotal)) {
            actualtotal = 0;
        }

        //$('#A_' + rownum + '_4').val(actualtotal.toFixed(2));
        calculatemultiplier(AsName, rownum);
        estimatevalues();
        footertotal();
    }
    function Overallcalculatemultiplier(val, rowid) {
        var AsName = val;
        if (typeof val.id != 'undefined') {
            var idsplit = val.id.split('_');
            AsName = idsplit[0];
            for (var i = 1; i < idsplit.length - 2; i++) {
                AsName += "_" + idsplit[i];
            }
        }
        AsName = AsName.replace(/[^0-9a-z]/gi, '');
        var grandname = AsName;
        AsName += "-" + rowid;
        var rownum = $('#' + AsName).attr('data-row');
        var grandd = Number($('#Toggle' + rowid + ' #' + grandname + '_grandtotal_0').val()).toFixed(2);
        var grandd1 = Number($('#Toggle' + rowid + ' #' + grandname + '_grandtotal_1').val()).toFixed(2);
        var grandd2 = Number($('#Toggle' + rowid + ' #' + grandname + '_grandtotal_2').val()).toFixed(2);
        if (grandd == "NaN") {
            grandd = Number($('#A_' + rownum + '_5').val());
        }
        if (grandd1 == "NaN") {
            grandd1 = Number($('#A_' + rownum + '_6').val());
        }
        if (grandd2 == "NaN") {
            //grandd2 = Number($('#A_' + rownum + '_8').val());
            grandd2 = Number($('#A_' + rownum + '_11').val());
        }
        var multi = Number($('#A_' + rownum + '_0').val());
        var amt = Number($('#A_' + rownum + '_7').val());
        if (Number($('#A_' + rownum + '_0').val()) == 0) {
            multi = 1;
        } else { multi = Number($('#A_' + rownum + '_0').val()) }
        if (Number($('#A_' + rownum + '_7').val()) == 0) {
            amt = 1;
        } else { amt = Number($('#A_' + rownum + '_7').val()); }
        var actualqty = Number($('#A_' + rownum + '_3').val());
        $('#A_' + rownum + '_3').val(multi);
        actualqty = multi;
        // alert($('#A_' + rownum + '_3').val());

        //if (Number($('#A_' + rownum + '_3').val()) == 0) {
        //    alert(multi);
        //    $('#A_' + rownum + '_3').val(multi);
        //    actualqty = multi;
        //}
        //here Assembly EstCostTotat is calculating
        
        $('#A_' + rownum + '_10').val((Number(grandd).toFixed(2)));
        $('#A_' + rownum + '_11').val((Number(grandd1).toFixed(2)));
        $('#A_' + rownum + '_1').val((Number(grandd).toFixed(2) * Number(multi) * Number(amt)).toFixed(2));
        $('#A_' + rownum + '_2').val((Number(grandd1).toFixed(2) * Number(multi) * Number(amt)).toFixed(2));
        $('#A_' + rownum + '_4').val((Number(grandd2).toFixed(2) * Number(amt) * Number(actualqty)).toFixed(2));
        footertotal(); estimatevalues();
    }
    function checknum(element) {

        var values = $(element).val();
        var rgx = /^[0-9]*\.?[0-9]*$/;
        if (values.match(rgx)) {

        }
        else {
            $(element).val(0);
            //$(element).val($(element).val().replace(/\D/, ''));
        }
    }

    function checkint(element) {
        var values = $(element).val();
        if (/\D/g.test(values)) {
            // Filter non-digits from input value.
            $(element).val(values.replace(/\D/g, ''));
        }
    }
    function calculatemultiplier(val, rowid, element) {
        //if (typeof element != 'undefined')
        //{
        //    $(element).val($(element).val().replace(/\D/, ''));

        //}

        var AsName = val;
        if (typeof val.id != 'undefined') {
            var idsplit = val.id.split('_');
            AsName = idsplit[0];
            for (var i = 1; i < idsplit.length - 2; i++) {
                AsName += "_" + idsplit[i];
            }
        }
        AsName = AsName.replace(/[^0-9a-z]/gi, '');
        var grandname = AsName;
        AsName += "-" + rowid;
        
        var rownum = $('#' + AsName).attr('data-row');

        if (rownum === undefined) {
            rownum = $(this).closest('tr').find('[name="trJobAssembly"]').rowIndex;
        }


        var grandd = Number($('#Toggle' + rowid + ' #' + grandname + '_grandtotal_0').val()).toFixed(2);
        var grandd1 = Number($('#Toggle' + rowid + ' #' + grandname + '_grandtotal_1').val()).toFixed(2);
        var grandd2 = Number($('#Toggle' + rowid + ' #' + grandname + '_grandtotal_2').val()).toFixed(2);
        var totest = Number($('#totalestimatedcost').val());
        if (grandd == "NaN") {
            grandd = Number($('#A_' + rownum + '_5').val());
        }
        if (grandd1 == "NaN") {
            grandd1 = Number($('#A_' + rownum + '_6').val());
        }
        if (grandd2 == "NaN") {
            //grandd2 = Number($('#A_' + rownum + '_8').val());
            grandd2 = Number($('#A_' + rownum + '_11').val());
        }
        var multi = Number($('#A_' + rownum + '_0').val());
        var amt = Number($('#A_' + rownum + '_7').val());
        //if (Number($('#A_' + rownum + '_0').val()) == 0)
        //{
        //    multi = 1;

        //} else
        //{
        //    multi = Number($('#A_' + rownum + '_0').val())
        //}
        multi = Number($('#A_' + rownum + '_0').val())
        if (Number($('#A_' + rownum + '_7').val()) == 0) {
            amt = 1;
        }
        else {
            amt = Number($('#A_' + rownum + '_7').val());
        }
        var actualqty = Number($('#A_' + rownum + '_3').val());
        //if (Number($('#A_' + rownum + '_3').val()) == 0) {
        //    actualqty = 1;
        //}
        //here Assembly EstCostTotat is calculating
        if (isNaN(grandd)) {
            grandd = 0;
        }
        if (isNaN(grandd1)) {
            grandd1 = 0;
        }
        if (isNaN(amt)) {
            amt = 0;
        }
        if (isNaN(multi)) {
            multi = 0;
        }
        if (isNaN(actualqty)) {
            actualqty = 0;
        }

        $('#A_' + rownum + '_10').val((Number(grandd).toFixed(2)));
        $('#A_' + rownum + '_11').val((Number(grandd1).toFixed(2)));
        // $('#A_' + rownum + '_1').val((Number(grandd).toFixed(2) * Number(multi) * Number(amt)).toFixed(2));
        $('#A_' + rownum + '_1').val((Number(grandd).toFixed(2) * Number(amt) * Number(actualqty)).toFixed(2));
        $('#A_' + rownum + '_2').val((Number(grandd1).toFixed(2) * Number(multi) * Number(amt)).toFixed(2));
        $('#A_' + rownum + '_4').val((Number(grandd1).toFixed(2) * Number(amt) * Number(actualqty)).toFixed(2));
        $('#A_' + rownum + '_13').val((Number(grandd).toFixed(2) * Number(amt) * Number(multi)).toFixed(2));
        //here calculating Difference

        var act = amt * actualqty * Number(grandd1).toFixed(2);
        if (isNaN(act)) {
            act = 0;
        }
        var estimatetotal = Number($('#A_' + rownum + '_2').val());
        if (isNaN(estimatetotal)) {
            estimatetotal = 0;
        }
        var diff = Number(estimatetotal.toFixed(2)) - Number(act.toFixed(2));
        $('#A_' + rownum + '_12').val(Number(diff).toFixed(2));

        footertotal(); estimatevalues();
        AssemblyTotal();
        CalculateEstimateONE();
        CalculateEstimateTWO();



    }

    function deleteassembly(nameid, id, val) {
        var assembliesest = $('#Assembliesbody tr.accordion-toggle');
        var lstassemblyinfo = new Array();
        var AsName = $(val).attr('data-assembly');
        var rownum = $(val).attr('data-row');
        var totalestcost = 0;
        var totalresaleestcost = 0;
        var totalactualcost = 0;

        var jobassemblyparts = new Array();
        var JobID = $('#hdnjobid').val();
        //var Model = null;

        if (assembliesest.length > 0) {
            for (var a = 0; a < assembliesest.length; a++) {
                if (a != rownum) {

                    var NewJobAssemblyList = null;
                    var nxtpart = $(assembliesest[a]);
                    var sd = $(nxtpart[0].nextElementSibling);
                    if ($(sd).hasClass('.accordion-toggle')) {

                    }
                    else {

                        nxtpart = $(sd).html();
                    }
                    var assemblyname = assembliesest[a].cells[0].innerText.trim();
                    var assemblynameid = assemblyname.replace(/[^0-9a-z]/gi, '');

                    var partsbodyid = assemblynameid + '_partstbody';
                    var togg = 'Toggle' + a;
                    var tapbody = $('#' + togg + ' #' + partsbodyid + ' tr');
                    var jobassemblyparts = new Array();

                    for (var p = 0; p < tapbody.length; p++) {
                        jobassemblyparts.push({
                            'Assemblies_Name': assemblyname,
                            'Assemblies_Category': assembliesest[a].cells[1].innerText.trim(),
                            'Part_Number': tapbody[p].cells[0].innerText.trim(),
                            'Part_Category': tapbody[p].cells[1].innerText.trim(),
                            'Part_Cost': tapbody[p].cells[2].children[0].value,
                            'Resale_Cost': tapbody[p].cells[3].children[0].value,
                            'Estimated_Qty': tapbody[p].cells[4].children[0].value,
                            'LaborUnit': tapbody[p].cells[5].children[0].value,
                            'EstCost_Total': tapbody[p].cells[6].children[0].value,
                            'EstResaleCost_Total': tapbody[p].cells[7].children[0].value,
                            'Actual_Qty': tapbody[p].cells[8].children[0].value,
                            'Actual_Total': tapbody[p].cells[9].children[0].value,
                            //Still you have to add other values for parts
                        });
                    }
                    partsbodyid = assemblynameid + '_partstbodyassem';
                    tapbody = $('#' + togg + ' #' + partsbodyid + ' tr');
                    for (p = 0; p < tapbody.length; p++) {
                        try {
                            jobassemblyparts.push({
                                'Assemblies_Name': assemblyname,
                                'Assemblies_Category': assembliesest[a].cells[1].innerText.trim(),
                                'Part_Number': tapbody[p].cells[0].innerText.trim(),
                                'Part_Category': tapbody[p].cells[1].innerText.trim(),
                                'Part_Cost': tapbody[p].cells[2].children[0].value,
                                'Resale_Cost': tapbody[p].cells[3].children[0].value,
                                'Estimated_Qty': tapbody[p].cells[4].children[0].value,
                                'LaborUnit': tapbody[p].cells[5].children[0].value,
                                'EstCost_Total': tapbody[p].cells[6].children[0].value,
                                'EstResaleCost_Total': tapbody[p].cells[7].children[0].value,
                                'Actual_Qty': tapbody[p].cells[8].children[0].value == "" ? 0 : tapbody[p].cells[7].children[0].value,
                                'Actual_Total': tapbody[p].cells[9].children[0].value,
                                //Still you have to add other values for parts
                            });
                        }
                        catch{ }
                    }
                    var totalcosttotal = $('#' + togg + ' #' + assemblynameid + "_total_0").val();
                    var totalresaletotal = $('#' + togg + ' #' + assemblynameid + "_total_1").val();
                    var laborcost = $('#' + togg + ' #' + assemblynameid + "_labour_0").val();
                    var laborresalecost = $('#' + togg + ' #' + assemblynameid + "_labour_1").val();
                    var laborEsthours = $('#' + togg + ' #' + assemblynameid + "_labour_2").val();
                    var laborEstCostTot = $('#' + togg + ' #' + assemblynameid + "_labour_3").val();
                    var laborEstResaleTot = $('#' + togg + ' #' + assemblynameid + "_labour_4").val();
                    var laborActQty = $('#' + togg + ' #' + assemblynameid + "_labour_5").val();
                    var laborActTot = $('#' + togg + ' #' + assemblynameid + "_labour_6").val();
                    NewJobAssemblyList = {
                        'Assemblies_Name': assemblyname,
                        'Assemblies_Category': assembliesest[a].cells[1].innerText.trim(),
                        'JobAssembly_Id': assembliesest[a].cells[2].children[1].value.trim(),
                        'Multiplier': assembliesest[a].cells[2].children[0].value.trim(),
                        'Estimated_Qty': assembliesest[a].cells[5].children[0].value.trim(),
                        'Est_Cost_Total': assembliesest[a].cells[7].children[0].value.trim(),
                        'Est_Resale_Total': assembliesest[a].cells[8].children[0].value.trim(),
                        'Actual_Qty': assembliesest[a].cells[6].children[0].value.trim() == "" ? 0 : assembliesest[a].cells[6].children[0].value.trim(),
                        'Actual_Total': assembliesest[a].cells[9].children[0].value.trim(),
                        'PartCostTotal': totalcosttotal,
                        'PartResaleTotal': totalresaletotal,
                        'GrandCostTotal': assembliesest[a].cells[3].children[0].value.trim(),
                        'GrandResaleTotal': assembliesest[a].cells[4].children[0].value.trim(),
                        'Jobsassemblyparts': jobassemblyparts,
                        'Labor_Cost': laborcost,
                        'Lobor_Resale': laborresalecost,
                        'Estimated_Hour': laborEsthours,
                        'LaborEst_CostTotal': laborEstCostTot,
                        'LaborEst_ResaleTotal': laborEstResaleTot,
                        'labour_actual_total': laborActTot,
                        'Labor_Actual_Qty': laborActQty,
                        //'PartsActualTotal': $('#' + assemblynameid + "_total_2").val(),
                        // 'GrandActualTotal': $('#' + assemblynameid + "_grandtotal_2").val()
                        // 'GrandActualTotal': acttotal,
                    };

                    lstassemblyinfo.push({
                        Assemblies_Name: assembliesest[a].cells[0].innerText.trim(),
                        Assemblies_Category: assembliesest[a].cells[1].innerText.trim(),
                        Multiplier: assembliesest[a].cells[2].children[0].value.trim(),
                        JobAssembly_Id: assembliesest[a].cells[2].children[1].value.trim(),
                        Estimated_Qty_Total: assembliesest[a].cells[5].children[0].value.trim(),
                        Est_Cost_Total: assembliesest[a].cells[7].children[0].value.trim(),
                        //GrandCostTotal: assembliesest[a].cells[6].children[1].value.trim(),
                        GrandCostTotal: assembliesest[a].cells[3].children[0].value.trim(),
                        Est_Resale_Total: assembliesest[a].cells[8].children[0].value.trim(),
                        //GrandResaleTotal: assembliesest[a].cells[7].children[1].value.trim(),
                        GrandResaleTotal: assembliesest[a].cells[4].children[0].value.trim(),
                        Actual_Qty: assembliesest[a].cells[6].children[0].value.trim() == "" ? 0 : assembliesest[a].cells[6].children[0].value.trim(),
                        Actual_Total: assembliesest[a].cells[9].children[0].value.trim(),
                        GrandActualTotal: assembliesest[a].cells[9].children[1].value.trim(),
                        partsdata: jobassemblyparts,
                        assemblydetails: NewJobAssemblyList

                    });

                    totalestcost = Number(totalestcost) + Number(assembliesest[a].cells[3].children[0].value.trim()) * Number(assembliesest[a].cells[6].children[0].value.trim());
                    ///alert(assembliesest[a].cells[8].children[0].value.trim());
                    totalresaleestcost = Number(totalresaleestcost) + Number(assembliesest[a].cells[8].children[0].value.trim());
                    totalactualcost = Number(totalactualcost) + Number(assembliesest[a].cells[9].children[0].value.trim());
                }
            }



        }
        if (confirm("Are you sure you want to delete this assembly?")) {
            if (fetchedassemblies.indexOf(AsName + "-" + rownum) > -1) {
                fetchedassemblies = fetchedassemblies.replace(AsName + "-" + rownum, '');
            }
            fetchedassemblies = "";
            if ($('#Job_ID').val() != "0") {
                $.ajax({
                    url: '../Job/deleteJobAssembly?Id=' + nameid + '&Jobid=' + $('#Job_ID').val(),
                    type: 'GET',
                    success: function (data) {

                        $(val).parent().parent().next().remove();
                        $(val).parent().parent().remove();
                        var assempartstbody = '';
                        var j = 0;
                        if (lstassemblyinfo.length > 0) {

                            GrandtotalCost = 0.00;
                            GrandtotalresaleCost = 0.00;
                            //j = lstassemblyinfo.length;
                            var partsdat = [];
                            j = 0;
                            for (l = 0; l < lstassemblyinfo.length; l++) {

                                setTimeout(function () { framerows(); }, 1000);
                            }
                            function framerows() {

                                assempartstbody += '<tr name="trJobAssembly" data-toggle="collapse" data-target="#demo1" class="accordion-toggle">';
                                var rowid = lstassemblyinfo[j].Assemblies_Name.replace(/\"/g, '&quot;');
                                rowid += "-" + j;
                                assempartstbody += '<td id="' + rowid + '" data-row="' + j + '">';
                                var Eid = "E_" + j + "_0"; var Did = "Toggle" + j;
                                var newAssemblyName = lstassemblyinfo[j].Assemblies_Name.replace(/\"/g, '&quot;');
                                var newJobAssemblyId = lstassemblyinfo[j].JobAssembly_Id;
                                assempartstbody += '<input type="hidden" id="bodyassemblyids" value="' + newAssemblyName + '" />';
                                assempartstbody += '<input type="hidden" name="AssemblyIndex" value="' + j + '" />';
                                assempartstbody += '<img src="../AppImges/plus.png"  data-toggle="collapse" data-row="' + j + '" data-assemblyid="' + newJobAssemblyId + '" data-target="#' + Did + '" data-assembly="' + newAssemblyName + '" class="clickable _info_" style="width:7%; margin-right:2px;cursor:pointer" id="' + Eid + '" onclick="ExpandTable(this);">';
                                assempartstbody += '<img src="../Images/delete-photo.png" style="width:10%;cursor:pointer;margin-right:2px"  data-row="' + j + '" data-assembly="' + newAssemblyName + '"  title="delete assembly" alt="delete" onclick="deleteassembly(' + newJobAssemblyId + ',\'' + rowid + '\',this)" />';
                                assempartstbody += lstassemblyinfo[j].Assemblies_Name + "</td>";
                                assempartstbody += '<td id="AsCategory">' + lstassemblyinfo[j].Assemblies_Category + '</td><td>';
                                var multiplierid = "A_" + j + "_7";
                                var Multipier = lstassemblyinfo[j].Multiplier == 0 ? "" : lstassemblyinfo[j].Multiplier;
                                assempartstbody += '<input type="text" id="' + multiplierid + '" name="txtAssemblyMultiplier" class="form-control" value="' + Multipier + '" calculatemultiplier(\'' + newAssemblyName + '\',' + j + ',this);" style="text-align:right" />';
                                assempartstbody += '<input type="hidden" id="jobassemblyid" value="' + newJobAssemblyId + '" />';
                                assempartstbody += '</td><td>';

                                GrandtotalCost = Number(GrandtotalCost) + Number(lstassemblyinfo[j].Est_Cost_Total);

                                pid = "A_" + j + "_10";
                                assempartstbody += '<input type="text" class="form-control"  value="' + (lstassemblyinfo[j].GrandCostTotal == 0 ? "1" : lstassemblyinfo[j].GrandCostTotal) + '" disabled onkeyup="checknum(this);calculatecost(this);"  id="' + pid + '"  style="text-align: right"/>';
                                assempartstbody += '</td><td>';
                                pid = "A_" + j + "_11";
                                assempartstbody += '<input type="text" class="form-control"  value="' + (lstassemblyinfo[j].GrandResaleTotal == 0 ? "1" : lstassemblyinfo[j].GrandResaleTotal) + '" disabled onkeyup="checknum(this);calculatecost(this);"  id="' + pid + '"  style="text-align: right"/>';
                                assempartstbody += '</td><td>';

                                //Assembly Est.Qty
                                var pid = "A_" + j + "_0";
                                assempartstbody += '<input name="txtAssmEstQty" type="text" class="form-control" value="' + lstassemblyinfo[j].Estimated_Qty_Total + '"  onkeyup="calculatemultiplier(\'' + newAssemblyName + '\',' + j + ',this);" id="' + pid + '" style="text-align: right" />';
                                assempartstbody += '</td><td>';

                                //Assembly Actual Qty
                                pid = "A_" + j + "_3";
                                var ActQty = lstassemblyinfo[j].Actual_Qty == 0 ? lstassemblyinfo[j].Actual_Qty : lstassemblyinfo[j].Actual_Qty;
                                assempartstbody += '<input type="text" name="txtAssmActualQty" class="form-control" value="' + ActQty + '" onkeyup="calculatemultiplier(\'' + newAssemblyName + '\',' + j + ',this);" id="' + pid + '"  style="text-align: right"/>';
                                assempartstbody += '</td><td>'

                                pid = "A_" + j + "_1";
                                assempartstbody += '<input type="text" class="form-control"  value="' + lstassemblyinfo[j].Est_Cost_Total + '" disabled onkeyup="checknum(this);calculatecost(this);"  id="' + pid + '"  style="text-align: right"/>';
                                var hdnid = "A_" + j + "_5";
                                assempartstbody += '<input type="hidden" class="form-control"  value="' + (lstassemblyinfo[j].GrandCostTotal == 0 ? "1" : lstassemblyinfo[j].GrandCostTotal) + '" disabled onkeyup="checknum(this);calculatecost(this);"  id="' + hdnid + '"  style="text-align: right"/>';
                                assempartstbody += '</td><td>';

                                EstResaleTotal = lstassemblyinfo[j].Est_Resale_Total == 0 ? 0 : Number(lstassemblyinfo[j].Est_Resale_Total);
                                //EstResaleTotal = "";
                                //Here Adding GrandResaleCost Total.....
                                // totalresaleestcost = Number(totalresaleestcost) + Number(lstassemblyinfo[j].Est_Resale_Total);

                                GrandtotalresaleCost = Number(GrandtotalresaleCost) + Number(lstassemblyinfo[j].Est_Resale_Total);

                                pid = "A_" + j + "_2";
                                assempartstbody += '<input type="text"  class="form-control" value="' + EstResaleTotal.toFixed(2) + '" disabled  onkeyup="checknum(this);calculatecost(this);" id="' + pid + '" style="text-align: right" />';
                                hdnid = "A_" + j + "_6";
                                assempartstbody += '<input type="hidden" class="form-control"  value="' + (lstassemblyinfo[j].GrandResaleTotal == 0 ? "1" : lstassemblyinfo[j].GrandResaleTotal) + '" disabled onkeyup="checknum(this);calculatecost(this);"  id="' + hdnid + '"  style="text-align: right"/>';

                                //if (JobID == "" || JobID == "0") {
                                //    assempartstbody += '</td><td hidden>';
                                //}
                                //else
                                //    assempartstbody += '</td><td>';
                                assempartstbody += '</td><td>';
                                pid = "A_" + j + "_4";
                                var ActualTotal = 0;
                                ActualTotal = lstassemblyinfo[j].Actual_Total == 0 ? 0 : Number(lstassemblyinfo[j].Actual_Total);
                                // alert(ActualTotal);
                                //totalactualcost = Number(totalactualcost) + Number(ActualTotal);

                                assempartstbody += '<input type="text" class="form-control"  value="' + ActualTotal.toFixed(2) + '" disabled id="' + pid + '" style="text-align: right" />';
                                hdnid = "A_" + j + "_8";
                                //assempartstbody += '<input type="hidden" class="form-control"  value="' + (lstassemblyinfo[j].GrandActualTotal == 0 ? "1" : lstassemblyinfo[j].GrandActualTotal) + '" disabled onkeyup="calculatecost(this);"  id="' + hdnid + '"  style="text-align: right"/>';
                                assempartstbody += '<input type="hidden" class="form-control"  value="' + (lstassemblyinfo[j].GrandActualTotal == 0 ? ActualTotal : lstassemblyinfo[j].GrandActualTotal) + '" disabled onkeyup="checknum(this);calculatecost(this);"  id="' + hdnid + '"  style="text-align: right"/>';
                                if (JobID == "" || JobID == "0") {
                                    assempartstbody += '</td><td hidden>';
                                }
                                else
                                    assempartstbody += '</td><td>';
                                pid = "A_" + j + "_12";

                                // var act = ActQty * lstassemblyinfo[j].GrandResaleTotal * Multipier;
                                // alert(act);
                                //  var estimatetotal = data[i].GrandResaleTotal == 0 ? "1" : data[i].GrandResaleTotal;
                                //  alert(EstResaleTotal);
                                var difftotal = EstResaleTotal - ActualTotal;
                                assempartstbody += '<input type="text" class="form-control diff-color"  value="' + difftotal.toFixed(2) + '" disabled id="' + pid + '" style="text-align: right" />';
                                assempartstbody += '</td></tr>';
                                assempartstbody += '<tr><td colspan="12" class="hiddenRow"><div class="accordian-body collapse" id="' + Did + '">';
                                assempartstbody += '<span>No “Records” found!</span></div></td></tr>';

                                if (lstassemblyinfo[j].partsdata != null && lstassemblyinfo[j].partsdata.length > 0) {
                                    var AssemblyPartsModel = {
                                        'assmeblymasterinfo': lstassemblyinfo[j].assemblydetails,
                                        'partslist': lstassemblyinfo[j].partsdata
                                    }
                                    fetchedassemblies += lstassemblyinfo[j].Assemblies_Name + "-" + j + ",";
                                    lstassemblyinfo[j].assemblydetails.togid = Did
                                    $.ajax({
                                        url: '../Job/Realignassemblyparts',
                                        type: 'GET',
                                        data: { 'parts': JSON.stringify(lstassemblyinfo[j].partsdata), 'assem': JSON.stringify(lstassemblyinfo[j].assemblydetails) },
                                        success: function (data) {
                                            
                                            //assempartstbody += '<tr><td colspan="12" class="hiddenRow"><div class="accordian-body collapse" id="' + Did + '">';
                                            //assempartstbody += data + '</div></td></tr>';aspartsdiv assmeblymasterinfo.togid
                                            $('#aspartsdiv ').html(data);
                                            var cdid = $('#assmeblymasterinfo_togid').val();
                                            $('#aspartsdiv ').html('');
                                            //$('#' + cdid).html(data);
                                            $('#' + Did).html(data);
                                        },
                                        error: function (err) {

                                        }
                                    });
                                }
                                else {

                                }
                                j++;
                                if (j == lstassemblyinfo.length) {
                                    $('#Assembliesbody').html(assempartstbody);
                                    assempartstbody = '<tr>';
                                    //if (JobID == "" || JobID == "0")
                                    //    assempartstbody += '<th colspan="5">';
                                    //else
                                    //    assempartstbody += '<th colspan="6">';
                                    assempartstbody += '<th colspan="7" class="Estimate-Footer">';
                                    assempartstbody += 'Grand Total</th><th style="text-align: right">';
                                    //Here Binding GrandCost Total.....
                                    assempartstbody += '<input type="text" id="Assembly_GrandExpTotal" class = "form-control Estimate-FooterValue _jobs-info-1_" value="' + totalestcost.toFixed(2) + '" disabled style="text-align:right" />';
                                    //assempartstbody += totalestcost.toFixed(2);
                                    // assempartstbody += GrandtotalCost.toFixed(2);
                                    assempartstbody += '</th><th style="text-align: right">';
                                    //Here Binding GrandCost Total.....
                                    assempartstbody += '<input type="text" id="Assembly_GrandEstTotal" class = "form-control Estimate-FooterValue" value="' + totalresaleestcost.toFixed(2) + '" disabled style="text-align:right" />';
                                    // assempartstbody += totalresaleestcost.toFixed(2);

                                    //assempartstbody += GrandtotalresaleCost.toFixed(2);
                                    //if (JobID == "" || JobID == "0")
                                    //    assempartstbody += '</th><td hidden></td><th style="text-align: right" hidden>';
                                    //else
                                    //    assempartstbody += '</th><th style="text-align: right" >';
                                    assempartstbody += '</th><th style="text-align: right" >';
                                    // alert(totalactualcost);
                                    assempartstbody += '<input type="text" id="Assembly_GrandActualTotal" class = "form-control Estimate-FooterValue" value="' + totalactualcost.toFixed(2) + '" disabled style="text-align:right" />';
                                    // assempartstbody+=totalactualcost.toFixed(2);
                                    assempartstbody += '</th></tr>';
                                    $('#PartsTotal').html(assempartstbody);
                                    footertotal();
                                    estimatevalues();
                                    profitcal();
                                    AssemblyTotal();
                                }
                                setRegexValidations();
                            }
                        }
                        else {
                            $("#PartsTotal").html("");
                            AssemblyTotal();
                            footertotal();
                            estimatevalues();
                            profitcal();
                        }
                    },
                    error: function (err) {
                        alert('error while deleting please try again');
                    }
                })
            }
            else {
                $(val).parent().parent().next().remove();
                $(val).parent().parent().remove();
                var assempartstbody = '';
                var j = 0;
                if (lstassemblyinfo.length > 0) {

                    GrandtotalCost = 0.00;
                    GrandtotalresaleCost = 0.00;
                    //j = lstassemblyinfo.length;
                    var partsdat = [];
                    j = 0;
                    for (l = 0; l < lstassemblyinfo.length; l++) {

                        setTimeout(function () { framerows(); }, 1000);
                    }
                    function framerows() {

                        assempartstbody += '<tr name="trJobAssembly" data-toggle="collapse" data-target="#demo1" class="accordion-toggle">';
                        var rowid = lstassemblyinfo[j].Assemblies_Name.replace(/\"/g, '&quot;');
                        rowid += "-" + j;
                        assempartstbody += '<td id="' + rowid + '" data-row="' + j + '">';
                        var Eid = "E_" + j + "_0"; var Did = "Toggle" + j;
                        var newAssemblyName = lstassemblyinfo[j].Assemblies_Name.replace(/\"/g, '&quot;');
                        var newJobAssemblyId = lstassemblyinfo[j].JobAssembly_Id;
                        assempartstbody += '<input type="hidden" id="bodyassemblyids" value="' + newAssemblyName + '" />';
                        assempartstbody += '<input type="hidden" name="AssemblyIndex" value="' + j + '" />';
                        assempartstbody += '<img src="../AppImges/plus.png"  data-toggle="collapse" data-row="' + j + '" data-assemblyid="' + newJobAssemblyId + '" data-target="#' + Did + '" data-assembly="' + newAssemblyName + '" class="clickable _info_" style="width:7%; margin-right:2px;cursor:pointer" id="' + Eid + '" onclick="ExpandTable(this);">';
                        assempartstbody += '<img src="../Images/delete-photo.png" style="width:10%;cursor:pointer;margin-right:2px"  data-row="' + j + '" data-assembly="' + newAssemblyName + '"  title="delete assembly" alt="delete" onclick="deleteassembly(' + newJobAssemblyId + ',\'' + rowid + '\',this)" />';
                        assempartstbody += lstassemblyinfo[j].Assemblies_Name + "</td>";
                        assempartstbody += '<td id="AsCategory">' + lstassemblyinfo[j].Assemblies_Category + '</td><td>';
                        var multiplierid = "A_" + j + "_7";
                        var Multipier = lstassemblyinfo[j].Multiplier == 0 ? "" : lstassemblyinfo[j].Multiplier;
                        assempartstbody += '<input type="text" id="' + multiplierid + '" name="txtAssemblyMultiplier" class="form-control" value="' + Multipier + '" calculatemultiplier(\'' + newAssemblyName + '\',' + j + ',this);" style="text-align:right" />';
                        assempartstbody += '<input type="hidden" id="jobassemblyid" value="' + newJobAssemblyId + '" />';
                        assempartstbody += '</td><td>';

                        GrandtotalCost = Number(GrandtotalCost) + Number(lstassemblyinfo[j].Est_Cost_Total);

                        pid = "A_" + j + "_10";
                        assempartstbody += '<input type="text" class="form-control"  value="' + (lstassemblyinfo[j].GrandCostTotal == 0 ? "1" : lstassemblyinfo[j].GrandCostTotal) + '" disabled onkeyup="checknum(this);calculatecost(this);"  id="' + pid + '"  style="text-align: right"/>';
                        assempartstbody += '</td><td>';
                        pid = "A_" + j + "_11";
                        assempartstbody += '<input type="text" class="form-control"  value="' + (lstassemblyinfo[j].GrandResaleTotal == 0 ? "1" : lstassemblyinfo[j].GrandResaleTotal) + '" disabled onkeyup="checknum(this);calculatecost(this);"  id="' + pid + '"  style="text-align: right"/>';
                        assempartstbody += '</td><td>';

                        //Assembly Est.Qty
                        var pid = "A_" + j + "_0";
                        assempartstbody += '<input name="txtAssmEstQty" type="text" class="form-control" value="' + lstassemblyinfo[j].Estimated_Qty_Total + '"  onkeyup="checknum(this);calculatemultiplier(\'' + newAssemblyName + '\',' + j + ',this);" id="' + pid + '" style="text-align: right" />';
                        assempartstbody += '</td><td>';

                        //Assembly Actual Qty
                        pid = "A_" + j + "_3";
                        var ActQty = lstassemblyinfo[j].Actual_Qty == 0 ? lstassemblyinfo[j].Actual_Qty : lstassemblyinfo[j].Actual_Qty;
                        assempartstbody += '<input type="text" name="txtAssmActualQty" class="form-control" value="' + ActQty + '" onkeyup="calculatemultiplier(\'' + newAssemblyName + '\',' + j + ',this);" id="' + pid + '"  style="text-align: right"/>';
                        assempartstbody += '</td><td>'


                        pid = "A_" + j + "_1";
                        assempartstbody += '<input type="text" class="form-control"  value="' + lstassemblyinfo[j].Est_Cost_Total + '" disabled onkeyup="checknum(this);calculatecost(this);"  id="' + pid + '"  style="text-align: right"/>';
                        var hdnid = "A_" + j + "_5";
                        assempartstbody += '<input type="hidden" class="form-control"  value="' + (lstassemblyinfo[j].GrandCostTotal == 0 ? "1" : lstassemblyinfo[j].GrandCostTotal) + '" disabled onkeyup="checknum(this);calculatecost(this);"  id="' + hdnid + '"  style="text-align: right"/>';
                        assempartstbody += '</td><td>';

                        EstResaleTotal = lstassemblyinfo[j].Est_Resale_Total == 0 ? 0 : Number(lstassemblyinfo[j].Est_Resale_Total);
                        //EstResaleTotal = "";
                        //Here Adding GrandResaleCost Total.....
                        // totalresaleestcost = Number(totalresaleestcost) + Number(lstassemblyinfo[j].Est_Resale_Total);

                        GrandtotalresaleCost = Number(GrandtotalresaleCost) + Number(lstassemblyinfo[j].Est_Resale_Total);

                        pid = "A_" + j + "_2";
                        assempartstbody += '<input type="text"  class="form-control" value="' + EstResaleTotal.toFixed(2) + '" disabled  onkeyup="checknum(this);calculatecost(this);" id="' + pid + '" style="text-align: right" />';
                        hdnid = "A_" + j + "_6";
                        assempartstbody += '<input type="hidden" class="form-control"  value="' + (lstassemblyinfo[j].GrandResaleTotal == 0 ? "1" : lstassemblyinfo[j].GrandResaleTotal) + '" disabled onkeyup="checknum(this);calculatecost(this);"  id="' + hdnid + '"  style="text-align: right"/>';

                        //if (JobID == "" || JobID == "0") {
                        //    assempartstbody += '</td><td hidden>';
                        //}
                        //else
                        //    assempartstbody += '</td><td>';
                        assempartstbody += '</td><td>';
                        pid = "A_" + j + "_4";
                        var ActualTotal = 0;
                        ActualTotal = lstassemblyinfo[j].Actual_Total == 0 ? 0 : Number(lstassemblyinfo[j].Actual_Total);
                        // alert(ActualTotal);
                        //totalactualcost = Number(totalactualcost) + Number(ActualTotal);

                        assempartstbody += '<input type="text" class="form-control"  value="' + ActualTotal.toFixed(2) + '" disabled id="' + pid + '" style="text-align: right" />';
                        hdnid = "A_" + j + "_8";
                        //assempartstbody += '<input type="hidden" class="form-control"  value="' + (lstassemblyinfo[j].GrandActualTotal == 0 ? "1" : lstassemblyinfo[j].GrandActualTotal) + '" disabled onkeyup="calculatecost(this);"  id="' + hdnid + '"  style="text-align: right"/>';
                        assempartstbody += '<input type="hidden" class="form-control"  value="' + (lstassemblyinfo[j].GrandActualTotal == 0 ? ActualTotal : lstassemblyinfo[j].GrandActualTotal) + '" disabled onkeyup="checknum(this);calculatecost(this);"  id="' + hdnid + '"  style="text-align: right"/>';
                        if (JobID == "" || JobID == "0") {
                            assempartstbody += '</td><td hidden>';
                        }
                        else
                            assempartstbody += '</td><td>';
                        pid = "A_" + j + "_12";

                        // var act = ActQty * lstassemblyinfo[j].GrandResaleTotal * Multipier;
                        // alert(act);
                        //  var estimatetotal = data[i].GrandResaleTotal == 0 ? "1" : data[i].GrandResaleTotal;
                        //  alert(EstResaleTotal);
                        var difftotal = EstResaleTotal - ActualTotal;
                        assempartstbody += '<input type="text" class="form-control diff-color"  value="' + difftotal.toFixed(2) + '" disabled id="' + pid + '" style="text-align: right" />';
                        assempartstbody += '</td></tr>';
                        assempartstbody += '<tr><td colspan="12" class="hiddenRow"><div class="accordian-body collapse" id="' + Did + '">';
                        assempartstbody += '<span>No “Records” found!</span></div></td></tr>';

                        if (lstassemblyinfo[j].partsdata != null && lstassemblyinfo[j].partsdata.length > 0) {
                            var AssemblyPartsModel = {
                                'assmeblymasterinfo': lstassemblyinfo[j].assemblydetails,
                                'partslist': lstassemblyinfo[j].partsdata
                            }
                            fetchedassemblies += lstassemblyinfo[j].Assemblies_Name + "-" + j + ",";
                            lstassemblyinfo[j].assemblydetails.togid = Did
                            $.ajax({
                                url: '../Job/Realignassemblyparts',
                                type: 'GET',
                                data: { 'parts': JSON.stringify(lstassemblyinfo[j].partsdata), 'assem': JSON.stringify(lstassemblyinfo[j].assemblydetails) },
                                success: function (data) {
                                    
                                    //assempartstbody += '<tr><td colspan="12" class="hiddenRow"><div class="accordian-body collapse" id="' + Did + '">';
                                    //assempartstbody += data + '</div></td></tr>';aspartsdiv assmeblymasterinfo.togid
                                    $('#aspartsdiv ').html(data);
                                    var cdid = $('#assmeblymasterinfo_togid').val();
                                    $('#aspartsdiv ').html('');
                                    //$('#' + cdid).html(data);
                                    $('#' + Did).html(data);
                                },
                                error: function (err) {

                                }


                            });



                        }
                        else {
                            AssemblyTotal();
                            footertotal();
                            estimatevalues();
                            profitcal();
                        }
                        j++;
                        if (j == lstassemblyinfo.length) {
                            $('#Assembliesbody').html(assempartstbody);
                            assempartstbody = '<tr>';
                            //if (JobID == "" || JobID == "0")
                            //    assempartstbody += '<th colspan="5">';
                            //else
                            //    assempartstbody += '<th colspan="6">';
                            assempartstbody += '<th colspan="7" class="Estimate-Footer">';
                            assempartstbody += 'Grand Total</th><th style="text-align: right">';
                            //Here Binding GrandCost Total.....
                            assempartstbody += '<input type="text" id="Assembly_GrandExpTotal" class = "form-control Estimate-FooterValue _jobs-info-2_" value="' + totalestcost.toFixed(2) + '" disabled style="text-align:right" />';
                            //assempartstbody += totalestcost.toFixed(2);
                            // assempartstbody += GrandtotalCost.toFixed(2);
                            assempartstbody += '</th><th style="text-align: right">';
                            //Here Binding GrandCost Total.....
                            assempartstbody += '<input type="text" id="Assembly_GrandEstTotal" class = "form-control Estimate-FooterValue" value="' + totalresaleestcost.toFixed(2) + '" disabled style="text-align:right" />';
                            // assempartstbody += totalresaleestcost.toFixed(2);

                            //assempartstbody += GrandtotalresaleCost.toFixed(2);
                            //if (JobID == "" || JobID == "0")
                            //    assempartstbody += '</th><td hidden></td><th style="text-align: right" hidden>';
                            //else
                            //    assempartstbody += '</th><th style="text-align: right" >';
                            assempartstbody += '</th><th style="text-align: right" >';
                            // alert(totalactualcost);
                            assempartstbody += '<input type="text" id="Assembly_GrandActualTotal" class = "form-control Estimate-FooterValue" value="' + totalactualcost.toFixed(2) + '" disabled style="text-align:right" />';
                            // assempartstbody+=totalactualcost.toFixed(2);
                            assempartstbody += '</th></tr>';
                            $('#PartsTotal').html(assempartstbody);
                            footertotal();
                            estimatevalues();
                            profitcal();
                            AssemblyTotal();
                            
                        }
                    }
                }
                setRegexValidations();
            }
            footertotal();
        }
        
    }
    function PreviewJobdesc() {
        showpreview = "JobDesc";
        var SowData = $('#Job_Description').val();
        $('#sowhead').text("Preview Description");
        $('#divPreviewdata').val(SowData);
        $('#Previewopenpopup').click();
    }
    function SelectJobdesc() {
        showpreview = "JobDesc";
        var SowData = $('#Job_Description').val();
        $.ajax({
            url: '../Job/GetPreviousJobdesc',
            type: "Get",
            success: function (data) {
                $('#previoushead').text('Previous Job Description');
                $('#divSowPreviousdata').html(data); $('#txtpreview').val(SowData);
                $('#Sowopenpopup').click();
            },
            error: function (err) { }

        });
    }
    function PreviewDirection() {
        showpreview = "Direction";
        var SowData = $('#Directions_To').val();
        $('#sowhead').text("Preview Direction");
        $('#divPreviewdata').val(SowData);
        $('#Previewopenpopup').click();
    }
    function SelectDirection() {
        showpreview = "Direction";
        var SowData = $('#Directions_To').val();
        $.ajax({
            url: '../Job/GetPreviousDirection',
            type: "Get",
            success: function (data) {
                $('#previoushead').text('Previous Direction');
                $('#divSowPreviousdata').html(data); $('#txtpreview').val(SowData);
                $('#Sowopenpopup').click();
            },
            error: function (err) { }

        });
    }

    function calculatelaborscost(val) {

        var laborbody = $('#Laborbody tr');
        var laborgrandexptotal = 0;
        var laborgrandesttotal = 0;
        var actualtotal = 0;
        var laborgrandestcosttotal = 0;
        var difference = 0;
        for (var i = 0; i < laborbody.length; i++) {
            //$('#L_' + i + '_4').val(Number($('#L_' + i + '_0').val()) * Number($('#L_' + i + '_2').val()).toFixed(2));
            var exptot = Number($('#L_' + i + '_0').val()) * Number($('#L_' + i + '_3').val());
            if (isNaN(exptot)) {
                exptot = 0;
            }
            $('#L_' + i + '_4').val(Number(exptot).toFixed(2));
            var esttot = Number($('#L_' + i + '_1').val()) * Number($('#L_' + i + '_2').val());
            if (isNaN(esttot)) {
                esttot = 0;
            }
            $('#L_' + i + '_5').val(Number(esttot).toFixed(2));
            var acttot = Number($('#L_' + i + '_1').val()) * Number($('#L_' + i + '_3').val());
            if (isNaN(acttot)) {
                acttot = 0;
            }
            $('#L_' + i + '_6').val(Number(acttot).toFixed(2));
            laborgrandexptotal = Number(laborgrandexptotal) + Number($('#L_' + i + '_4').val());
            if (isNaN(laborgrandexptotal)) {
                laborgrandexptotal = 0;
            }
            laborgrandesttotal = Number(laborgrandesttotal) + Number($('#L_' + i + '_5').val());
            if (isNaN(laborgrandesttotal)) {
                laborgrandesttotal = 0;
            }
            actualtotal = Number(actualtotal) + Number($('#L_' + i + '_6').val());
            if (isNaN(actualtotal)) {
                actualtotal = 0;
            }
            //here Calculating Difference
            difference = Number($('#L_' + i + '_5').val() - $('#L_' + i + '_6').val());
            if (isNaN(difference)) {
                difference = 0;
            }
            $('#L_' + i + '_7').val(difference.toFixed(2));
            var esttot = Number($('#L_' + i + '_0').val()) * Number($('#L_' + i + '_2').val());
            $('#L_' + i + '_8').val(esttot.toFixed(2));
            laborgrandestcosttotal = Number(laborgrandestcosttotal) + Number(esttot);
        }
        $('#Labor_GrandExpTotal').val(laborgrandexptotal.toFixed(2));
        $('#Labor_GrandEstTotal').val(laborgrandesttotal.toFixed(2));
        $('#Labor_GrandActTotal').val(actualtotal.toFixed(2));
        $('#Labor_GrandEstCostTotal').val(laborgrandestcosttotal.toFixed(2));
        estimatevalues();
        LaborTotal();
    }

    $(function () {
        var LaborGrandExpTotal = $("#Labor_GrandExpTotal").val();
        // alert(PartsGrandExpTotal);
        if (LaborGrandExpTotal == 0) {
            $("#Labor_GrandExpTotal").val("");

        }
        var LaborGrandEstTotal = $("#Labor_GrandEstTotal").val();
        // alert(PartsGrandExpTotal);
        if (LaborGrandEstTotal == 0) {
            $("#Labor_GrandEstTotal").val("");

        }
        var LaborGrandActTotal = $("#Labor_GrandActTotal").val();
        // alert(PartsGrandExpTotal);
        if (LaborGrandActTotal == 0) {
            $("#LaborGrandActTotal").val("");

        }

    });
    function calculatepartscost(val) {
        var partsbody = $('#partstbody tr');
        var partsgrandexptotal = 0;
        var partsgrandesttotal = 0;
        var actualtotal = 0;
        var difference = 0;
        var partsEstCost = 0;

        for (var i = 0; i < partsbody.length; i++) {
            //$('#P_' + i + '_4').val((Number($('#P_' + i + '_0').val()) * Number($('#P_' + i + '_2').val())).toFixed(2));
            var exptot = Number($('#P_' + i + '_0').val()) * Number($('#P_' + i + '_3').val());
            if (isNaN(exptot)) {
                exptot = 0;
            }
            $('#P_' + i + '_4').val(exptot.toFixed(2));
            var Esttot = Number($('#P_' + i + '_1').val()) * Number($('#P_' + i + '_2').val());
            if (isNaN(Esttot)) {
                Esttot = 0;
            }
            $('#P_' + i + '_5').val(Esttot.toFixed(2));
            var acttot = Number($('#P_' + i + '_1').val()) * Number($('#P_' + i + '_3').val());
            if (isNaN(acttot)) {
                acttot = 0;
            }
            $('#P_' + i + '_6').val(acttot.toFixed(2));
            partsgrandexptotal = Number(partsgrandexptotal) + Number($('#P_' + i + '_4').val());
            if (isNaN(partsgrandexptotal)) {
                partsgrandexptotal = 0;
            }
            partsgrandesttotal = Number(partsgrandesttotal) + Number($('#P_' + i + '_5').val());
            if (isNaN(partsgrandesttotal)) {
                partsgrandesttotal = 0;
            }
            actualtotal = Number(actualtotal) + Number($('#P_' + i + '_6').val());
            if (isNaN(actualtotal)) {
                actualtotal = 0;
            }
            //Here Calculating Difference
            difference = Number($('#P_' + i + '_5').val() - $('#P_' + i + '_6').val());
            if (isNaN(difference)) {
                difference = 0;
            }
            $('#P_' + i + '_7').val(difference.toFixed(2));
            var estcost = Number($('#P_' + i + '_0').val()) * Number($('#P_' + i + '_2').val());
            $('#P_' + i + '_8').val(estcost.toFixed(2));
            partsEstCost = Number(partsEstCost) + Number(estcost);
        }
        $('#Parts_GrandExpTotal').val(partsgrandexptotal.toFixed(2));
        $('#Parts_GrandEstTotal').val(partsgrandesttotal.toFixed(2));
        $('#Parts_GrandActTotal').val(actualtotal.toFixed(2));
        $('#Parts_GrandEstCostTotal').val(partsEstCost.toFixed(2));
        estimatevalues();
        PartsTotal();
        CalculateEstimateONE();
        CalculateEstimateTWO();
    }
    $(function () {
        var PartsGrandExpTotal = $("#Parts_GrandExpTotal").val();
        // alert(PartsGrandExpTotal);
        if (PartsGrandExpTotal == 0) {
            $("#Parts_GrandExpTotal").val("");

        }
        var PartsGrandEstTotal = $("#Parts_GrandEstTotal").val();
        // alert(PartsGrandExpTotal);
        if (PartsGrandEstTotal == 0) {
            $("#Parts_GrandEstTotal").val("");

        }
        var PartsGrandActTotal = $("#Parts_GrandActTotal").val();
        // alert(PartsGrandExpTotal);
        if (PartsGrandActTotal == 0) {
            $("#Parts_GrandActTotal").val("");

        }

    });
    function getusercolor(val) {
        var assigneduser = $(val).val();
        $.ajax({
            url: '../Job/GetUserColor?assigneduser=' + assigneduser,
            type: "GET",
            success: function (data) {
                $("#SelectColor").hide();
                if (data != "") {
                    $("#UserColor").show();

                    $("#UserColor").css('background-color', data)

                }
                else {
                    $("#UserColor").hide();
                }

            },
            error: function (err) {
            }
        })
    }

    $("#startDateclear").click(function () {
        $("#Start_Date").val("")
        $("#startDateclear").hide();

    })
    $("#EndDateclear").click(function () {
        $("#End_Date").val("")
        $("#EndDateclear").hide();

    })
    function Sdatekeypress() {
        $("#startDateclear").show();
    }
    function Edatekeypress() {
        $("#EndDateclear").show();
    }

    function GetTimeEvent() {
        var dayevent = $("#FullDay");
        if (dayevent[0].checked) {
            $("#startTime").attr("disabled", "disabled");
            $("#endTime").attr("disabled", "disabled");
            $("#startTime").val("");
            $("#endTime").val("");

        }
        else {
            $("#startTime").removeAttr("disabled");
            $("#endTime").removeAttr("disabled");
            //$("#startTime").val("00:00");
            //$("#endTime").val("00:00");
        }
    }

    function ClearCalenderEvent() {
        if (confirm("Are you sure you want to clear this calendar event?")) {
            clear();

        }
        else {
            return false;

        }

    }
    function clear() {
        $("#Job_ID").val(),
            $("#StartDate").val(""),
            //$("#startTime").val(""),
            $("#EndDate").val(""),
            // $("#endTime").val(""),
            $("#FullDay").bootstrapToggle('off');
        $("#Job_AssignedUser").val("")
        $("#UserColor").hide();
        //$("#startTime").val("00:00");
        //$("#endTime").val("00:00");
    }
    function dateformat(date) {

        var date = new Date();

        var curr_date = date.getDate();

        var curr_month = date.getMonth();

        var curr_year = date.getFullYear();

        curr_year = curr_year.toString().substr(2, 2);


        return curr_date + "-" + curr_month + "-" + curr_year;
    }
    function sDatevalidation() {
        var date_regex = /^\d{2}\/\d{2}\/\d{4}$/;
        //var date_regex = /^(\d{1,2})\/(\d{1,2})\/(\d{4})$/;
        var startDate = $("#StartDate").val();
        var endDate = $("#EndDate").val();
        if (!date_regex.test(startDate)) {
            DisplayNotification(" Start Date format should be “MM-DD-YYYY”!", "error");
            return false;
        }
        else {
            return true;
        }
    }
    function eDatevalidation() {
        var date_regex = /^\d{2}\/\d{2}\/\d{4}$/;
        //var date_regex = /^(\d{1,2})\/(\d{1,2})\/(\d{4})$/;
        var startDate = $("#StartDate").val();
        var endDate = $("#EndDate").val();
        if (!date_regex.test(endDate)) {
            DisplayNotification(" End Date format should be “MM-DD-YYYY”!", "error");
            return false;
        }
        else {
            return true;
        }
    }
    function validatedate() {
        var startDate = $("#StartDate").val();
        var endDate = $("#EndDate").val();
        if (new Date(startDate) > new Date(endDate)) {
            DisplayNotification("“End Date” should be greater than a “Start Date”!", "error");
            return false;
        }
        else {
            return true;
        }
    }

    function validateTime() {
        var shour = $("#startTime").attr('data-timepicki-tim');
        var sminute = $("#startTime").attr('data-timepicki-mini');
        var sdaytime = $("#startTime").attr('data-timepicki-meri');
        starttime = shour + ":" + sminute + " " + sdaytime;
        var ehour = $("#endTime").attr('data-timepicki-tim');
        var eminute = $("#endTime").attr('data-timepicki-mini');
        var edaytime = $("#endTime").attr('data-timepicki-meri');
        endtime = ehour + ":" + eminute + " " + edaytime;
        if (Number(shour) > 12 || Number(sminute) > 60 || Number(ehour) > 12 || Number(eminute) > 60 && (sdaytime == "AM" || sdaytime == "PM" || edaytime == "AM" || edaytime == "PM")) {
            DisplayNotification("Please validate time, time should be “12 Hour” format (HH:MM TT)!", "error");
            return false;
        }
        else {

            return true;
        }

    }

    function Requiredvalidate() {
        var startDate = $("#StartDate").val();
        var endDate = $("#EndDate").val();
        var AssignTo = $("#Job_AssignedUser").val();
        var starttime = $("#startTime").val();
        var Endtime = $("#endTime").val()
        var dayevent = $("#FullDay");
        if (startDate != "" && endDate != "" && AssignTo != "") {
            if (starttime == "" && Endtime == "" && dayevent[0].checked == false) {
                DisplayNotification("Select \"Start Time\" & \"End Time\" or \"Full Day Event\" for jobs calendar.", "error");
            }
            else {
                return true;
            }

        }
        else {
            DisplayNotification("The \"Start Date\", \"End Date\" & \"Assign To\" are required!", "error");
            return false;

        }
    }


    function AddJobCalenderEvents() {
        var starttime = "";
        var endtime = "";
        var dayevent = $("#FullDay");
        if (Requiredvalidate() == true && validatedate() == true && validateTime() == true) {
            if (dayevent[0].checked == false) {
                var shour = $("#startTime").attr('data-timepicki-tim');
                var sminute = $("#startTime").attr('data-timepicki-mini');
                var sdaytime = $("#startTime").attr('data-timepicki-meri');
                starttime = shour + ":" + sminute + " " + sdaytime;
                var ehour = $("#endTime").attr('data-timepicki-tim');
                var eminute = $("#endTime").attr('data-timepicki-mini');
                var edaytime = $("#endTime").attr('data-timepicki-meri');
                endtime = ehour + ":" + eminute + " " + edaytime;
            }
            else {
                var starttime = null;
                var endtime = null;

            }
            var Model = {
                'JobId': $("#Job_ID").val(),
                'StartDate': $("#StartDate").val(),
                'sDate': $("#StartDate").val(),
                'StartTime': starttime,
                'EndDate': $("#EndDate").val(),
                'eDate': $("#EndDate").val(),
                'EndTime': endtime,
                'FullDay': dayevent[0].checked,
                'AssignTo': $("#Job_AssignedUser").val(),
                'stTime': starttime,
                'etTime': endtime
            }
            Model = JSON.stringify(Model);
            $.ajax({
                url: '../Job/AddCalenderEvent',
                type: 'POST',
                contentType: 'application/json',
                data: Model,
                success: function (data) {
                    if (data == "“Job Calendar” details are added successfully.") {
                        GetJobEventList($("#Job_ID").val());
                        DisplayNotification("“Job Calendar” details are added successfully.", "success");
                        clear();
                        $("#startTime").val("");
                        $("#endTime").val("");
                    }
                    else {
                        DisplayNotification(data, "error");

                    }

                },
                error: function (err) {

                }


            })
        }


    }

    function GetJobEventList(val) {
        $.ajax({
            url: '../Job/GetJobEventList?JobID=' + val,
            type: 'GET',
            cache: false,
            success: function (data) {

                $("#DivJobEventList").html(data);
            },
            error: function (err) {
                alert(err.responseText);
            }


        });
    }
    function DeleteJobEvent(id, jobid) {
        if (confirm("Do you want to delete this calendar event?")) {
            $.ajax({
                url: '../Job/DeleteJobEvent?EventID=' + id + '&JobID=' + jobid,
                type: 'GET',
                success: function (data) {
                    if (data == "“Job Event” details are deleted successfully.") {
                        GetJobEventList($("#Job_ID").val());
                        DisplayNotification(data, "success");
                    }
                    else {
                        DisplayNotification(data, "error");
                    }
                },
                error: function (err) {
                }
            });
        }
        else {
            return false;
        }
    }

    $(function () {
        $("#startDateclear").hide();
        $("#EndDateclear").hide();
        $(".datepicker").datepicker({
            showOn: "button",
            buttonImage: "../AppImges/calender.png",
            buttonImageOnly: true,
            buttonText: "Select date",
            //dateFormat: 'dd-mm-yy'     //...local...
            dateFormat: 'mm-dd-yy' //..server format...
        });
    });


    $("#startDateclear").click(function () {

        $("#StartDate").val("")
        $("#startDateclear").hide();

    })
    $("#EndDateclear").click(function () {
        $("#EndDate").val("")
        $("#EndDateclear").hide();

    })
    function Sdatekeypress() {

        $("#startDateclear").show();

    }
    function Edatekeypress() {
        $("#EndDateclear").show();
    }
    $(function () {

        $(".profile-hd").click(function () {
            $(this).next().slideToggle('fast');
            var imgsrc = $(this).find('img');
            if (imgsrc.length) {
                if (imgsrc[0].src.indexOf('up-arrow') > -1) {
                    imgsrc[0].src = imgsrc[0].src.replace('up-arrow', 'down-arrow');
                }
                else {
                    imgsrc[0].src = imgsrc[0].src.replace('down-arrow', 'up-arrow');
                }
            }

        });
    });
    function SameAsAbove() {
        if ($('#sameas').is(":checked")) {
            $("#Work_Address").val($("#Client_Address").val());
            $("#Work_Address2").val($("#Client_Address2").val());
            $("#Work_City").val($("#Client_City").val());
            $("#Work_State").val($("#Client_State").val());
            $("#Work_ZipCode").val($("#Client_ZipCode").val());
        }
        else {
            $("#Work_Address").val("");
            $("#Work_Address2").val("");
            $("#Work_City").val("");
            $("#Work_State").val("");
            $("#Work_ZipCode").val("");

        }
    }

    function deleteDJEVQ(val1) {

        if (confirm("Are you sure you want to delete this DJE/VQ?")) {
            if ($('#job_id').val() != 0) {
                $.ajax({
                    url: '../job/DeleteDjeRow?statusid=' + val1,
                    type: 'GET',
                    success: function (data) {

                        var djebody = $('#estimatebody tr');
                        for (i = 0; i < djebody.length; i++) {
                            if (djebody[i].cells[6].children[0].value == val1) {
                                djebody[i].closest('tr').remove();
                            }
                        }
                        Resaletotal();
                    }
                });
            }

        }
    }
    function addRow() {
        var bindbody = "<tr>";
        bindbody += "<td><input type='text' maxlength='100' name='Expense' class='form-control' id='Expense' value=''></td>";
        bindbody += "<td><input type='text' maxlength='50' name='NameOfVendor' class='form-control' id='Dje_NameOfVendor'></td>";
        bindbody += "<td><input type='text' name='txtDJECost' class='form-control' id='Dje_Cost_" + ADD + "_0' style='text-align:right' value='' onkeyup='checknum(this);Resaletotal(this)'></td>";
        bindbody += "<td><input type='text' name='txtDJEProfit' class='form-control' id='Dje_Profit_" + ADD + "_1' style='text-align:right' value='' onkeyup='checknum(this);Resaletotal(this)'></td>";
        bindbody += "<td style='width: 10%;'><select class='form-control' name='Job_DJE_VQ_Status' id='Dje_Select_" + ADD + "_2' onchange='Resaletotal()'><option value=''>Select</option><option value='DJE'>DJE</option><option value='VQ'>VQ</option></select></td>";
        bindbody += "<td><input type='text' name='ResaleTotle' class='form-control' id='Dje_ResaleTotal_" + ADD + "_3' value='' style='text-align:right' disabled></td>";
        bindbody += "<td style='display:none;'><input type=text name='StatusId' id='StatusId' value=' '></td>"
        bindbody += "<td><img src='../Images/delete-photo.png' style='width:60%;cursor:pointer;margin-right:2px'  title='delete Dje' alt='delete' class='btnDelete' ></td>";
        bindbody += "</tr>"
        $('#estimatebody').append(bindbody);
        ADD++;

        setRegexValidations();
    }

    function Resaletotal() {

        var Djetotal = 0.00;
        var Vqtotal = 0.00;
        var resaletot = 0;
        var DJEcosttot = 0;
        var VQcosttot = 0;
        var DJEbody = $('#estimatebody tr');
        if (DJEbody.length > 0) {
            for (var i = 0; i < DJEbody.length; i++) {
                var cost = DJEbody[i].cells[2].children[0].value;
                if (isNaN(cost)) {
                    cost = 0;

                }
                var percent = DJEbody[i].cells[3].children[0].value;
                if (isNaN(percent) || percent == "") {
                    percent = 0;

                }
                resaletot = Number(cost) + (Number(cost) * ((Number(percent)) / 100));
                if (isNaN(resaletot)) {
                    resaletot = 0;
                }
                DJEbody[i].cells[5].children[0].value = Number(resaletot).toFixed(2);
                if (DJEbody[i].cells[4].children[0].value == "DJE") {

                    Djetotal += Number(resaletot);
                    DJEcosttot += Number(cost);
                    if (isNaN(Djetotal)) {
                        Djetotal = 0;
                    }
                }
                if (DJEbody[i].cells[4].children[0].value == "VQ") {

                    Vqtotal += Number(resaletot);
                    VQcosttot += Number(cost);
                    if (isNaN(Vqtotal)) {
                        Vqtotal = 0;
                    }
                }
            }
        }
        else {
            if (isNaN(Djetotal)) {
                Djetotal = 0;
            }
            if (isNaN(Vqtotal)) {
                Vqtotal = 0;
            }
        }
        $('#DjeCost_total').val(DJEcosttot.toFixed(2));
        $('#Dje_total').val(Djetotal.toFixed(2));
        $('#VQCost_total').val(VQcosttot.toFixed(2));
        $('#VQ_total').val(Vqtotal.toFixed(2));

        DJEandVQ();
        CalculateEstimateONE();
        CalculateEstimateTWO();
        estimatevalues();

        bid_summary_update_other_row_1();
        bid_summary_update_other_row_2();
    }
    $("#DJE_tbl").on('click', '.btnDelete', function () {
        if (confirm("Are you sure you want to delete this DJE/VQ?")) {
            $(this).closest('tr').remove();
            Resaletotal();
            estimatevalues();
        }
    });

    function CostValidate() {
        var DJEbody = $('#estimatebody tr');
        for (var i = 0; i < DJEbody.length; i++) {
            if (DJEbody[i].cells[2].children[0].value != "") {
                //var intRegex = /^\d+(?:\.\d\d?)?$/;
                var intRegex = /^(\d*\.?\d+|\d+\.\d*)$/;
                if (!(DJEbody[i].cells[2].children[0].value).match(intRegex)) {
                    DisplayNotification("Cost should be a “Number”.", "error");
                    return false;
                }
                else {
                    return true;
                }
            }
            else {
                DisplayNotification("“Cost” is required.", "error");
                return false;
            }

        }
    }
    function ProfitValidate() {
        var DJEbody = $('#estimatebody tr');
        for (var i = 0; i < DJEbody.length; i++) {
            if (DJEbody[i].cells[3].children[0].value != "") {
                //var intRegex = /^\d+(?:\.\d\d?)?$/;
                var intRegex = /^(\d*\.?\d+|\d+\.\d*)$/;
                if (!(DJEbody[i].cells[3].children[0].value).match(intRegex)) {
                    DisplayNotification("“Profit” should be a number.", "error");
                    return false;
                }
                else {
                    return true;
                }
            }
            else {
                DisplayNotification("“Profit” is required!", "error");
                return false;
            }

        }
    }

</script>
<style>
    .ui-datepicker-trigger {
        position: relative;
        height: 19px;
        width: 20px;
    }

    #UserColor {
        border: none;
        height: 22px;
        width: 20px;
        /*margin-top: 5px;*/
    }

    #SelectColor {
        border: none;
        height: 15px;
        width: 20px;
        margin-top: 5px;
    }

    .ui-datepicker-trigger {
        margin-top: -20px;
        float: right;
    }

    .rt {
        margin-top: -20px;
        float: right;
    }

    .cleardata {
        margin-top: -26px !important;
        margin-right: 19px !important;
    }

    #sameas {
    }

    .Estimate-Footer {
        color: #000000;
    }
</style>

@{ string hidde = "hidden";
    if (Request.QueryString["JobID"] != null && Request.QueryString["JobID"] != "0")
    {
        hidde = "";
    }}

<div class="box-row  profile-hd">
    <h7 class="box-heading">
        <strong> &nbsp Job Information </strong> <span class="pull-right apse b" style="padding-right:5px; color:#ffffff">
            <img id="arrow" src="../Images/up-arrow.png" alt="" />
        </span>
    </h7>

</div>
<div class="row">
    <div class="col-md-20">
        <div class="panel panel-default">
            <div class="panel-body">
                <div class="ajax-refresh2">


                    <div class="panel-body">


                        <div class="row-fluid">
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="label"><strong>Electric Ease Job ID :</strong></label>
                                    @Html.TextBoxFor(m => m.Job_ID, new { @class = "form-control", @maxlength = "50", @placeholder = "Job ID", disabled = "disabled", style = "display:none" })
                                    @Html.TextBoxFor(m => m.JobDisplayId, new { @class = "form-control", @maxlength = "50", @placeholder = "Job ID", disabled = "disabled" })
                                    @Html.ValidationMessageFor(m => m.Job_ID)

                                </div>
                            </div>
                        </div>

                        <div class="row-fluid">
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="label"><strong>Job Number :</strong></label>
                                    @*<input type="text" class="form-control" id="Job_Number" />*@
                                    @Html.TextBoxFor(m => m.Job_Number, new { @class = "form-control", @maxlength = "50", @placeholder = "Job Number" })
                                    @*   @Html.TextBoxFor(m => m.Job_Nubmer, new { @class = "form-control", @maxlength = "50", @placeholder = "Job ID", disabled = "disabled" })*@
                                    @Html.ValidationMessageFor(m => m.Job_Number)

                                </div>
                            </div>
                        </div>

                        <div class="row-fluid">
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="title"><strong>Job Status : </strong></label>
                                    @*@Html.DropDownListFor(m => m.Job_Status, Enumerable.Empty<SelectListItem>(), "Select", new { Name = "Client_ID", @class = "form-control" })*@
                                    @Html.DropDownListFor(m => m.Job_Status, new SelectList(

                                                                                            new List<Object> {
                                                                                            new{value="Open",text="Open"},
                                                                                            new{value="Closed",text="Closed"}
                                                                                            }, "value", "text"), new { @class = "form-control" })
                                </div>
                            </div>
                        </div>


                        @*@if (Model.Job_ID != 0)
                            {
                                <div class="row-fluid">
                                    <div class="col-md-3">
                                        <div class="form-group">
                                                <label for="title"><strong>Start Date:</strong></label>
                                                @Html.TextBoxFor(m => m.Start_Date, new { @class = "form-control datepicker", @onchange ="return Sdatekeypress();" })
                                            <span class=" alert-success pull-right ">
                                            <button type="button" id="startDateclear" class="close cleardata" >×</button></span>

                                        </div>

                                    </div>



                                </div>
                                <div class="row-fluid">
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label for="title"><strong>End Date:</strong></label>
                                            @Html.TextBoxFor(m => m.End_Date, new { @class = "form-control datepicker",@onchange = "return Edatekeypress();" })
                                            <span class=" alert-success pull-right ">
                                                <button type="button" id="EndDateclear" class="close cleardata">×</button>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            }*@

                        <div class="row-fluid">
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="title"><strong>Temp Pole:</strong></label>
                                    @Html.CheckBoxFor(m => m.TempPole, new { data_toggle = "toggle", data_on = "Yes", data_off = "No", data_size = "mini", data_offstyle = "danger" })
                                </div>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="col-md-8">
                                <div class="form-group">
                                    <label for="title"><strong>Job Description :</strong></label>
                                    @Html.TextAreaFor(m => m.Job_Description, new { @class = "form-control", @maxlength = "5000" })
                                    @Html.ValidationMessageFor(m => m.Job_Description)
                                    @*<textarea rows="3" class="form-control" name="MYDescription" id="IDescription" tabindex="6" maxlength="75" onkeypress="return onKeyValidate(event,alphanumeric);"></textarea>*@

                                </div>
                                <br /><br />
                                <a href="#" class="btn btn-flat btn-default btn-sm" onclick="PreviewJobdesc();"><i class="fa fa-check-square-o"></i><span>Preview</span></a>
                                <a href="#" class="btn btn-flat btn-default btn-sm" onclick="SelectJobdesc();"><i class="fa fa-check-square-o"></i><span>Select From Previous</span></a>
                            </div>
                        </div>
                    </div>
                    @if (Model.Job_ID != 0)
                    {
                        <div class="panel-footer clearfix">

                            <div class="pull-left" style="color: #3D81BD; font-size: x-small;">
                                <div>
                                    <label>Created By  : &nbsp @Model.Created_By on<span></span> @Model.Created_Date</label>
                                    <input type="hidden" value="@Model.Created_By" name="Created_By" id="Created_By" />
                                    <input type="hidden" name="Created_Date" value="@Model.Created_Date" />
                                </div>

                            </div>

                            <div class="pull-right" style="color: #3D81BD; font-size: x-small;">
                                <div>
                                    <label>Updated By  :@Model.Updated_By on<span></span> @Model.Updated_Date</label>
                                    <input type="hidden" name="Updated_By" value="@Model.Updated_By" />
                                    <input type="hidden" name="Updated_Date" value="@Model.Updated_Date" />
                                </div>

                            </div>
                        </div>
                    }
                </div>
            </div>

        </div>
    </div>
</div>
@if (Request.QueryString["JobID"] != null && Request.QueryString["JobID"] != "0")
{
    <div class="box-row  profile-hd">
        <h7 class="box-heading">
            <strong> &nbsp Jobs Calendar </strong> <span class="pull-right apse b" style="padding-right:5px; color:#ffffff">
                <img id="arrow" src="../Images/down-arrow.png" alt="" />
            </span>
        </h7>

    </div>
    <div class="row">
        <div class="col-md-20">
            <div class="panel panel-default">
                <div class="panel-body">
                    <div class="ajax-refresh2">

                        <div class="panel-body">
                            <div style="background-color: #eeeeee">
                                <div style="padding: 1%">
                                    <div class="row">
                                        <div class="col-md-1">
                                            <strong>Start Time: </strong>
                                        </div>
                                        <div class="col-md-2">
                                            @*<input type="date" id="StartDate" class="form-control" />*@
                                            <input type="text" id="StartDate" class="form-control datepicker" onchange="Sdatekeypress();" placeholder="mm-dd-yyyy" disabled />
                                            @*@Html.TextBoxFor(m => m.Start_Date, new { @class = "form-control datepicker", @onchange = "return Sdatekeypress();" })*@
                                            <span class="alert-success pull-right">
                                                <button type="button" id="startDateclear" class="close cleardata">×</button>
                                            </span>
                                        </div>
                                        <div class="col-md-3">
                                            @*<input type="time" id="startTime" class="form-control" />*@
                                            <input type="text" name="timepicker" id="startTime" class="time_element form-control" placeholder="hh:mm tt" style="width: 50% !important;" />
                                        </div>
                                        <div class="col-md-2">
                                            <strong>Full Day Event : </strong>
                                        </div>
                                        <div class="col-md-3">

                                            <input data-off="No" data-offstyle="danger" data-on="Yes" data-size="mini" data-toggle="toggle" data-val="true" data-val-required="The TempPole field is required." id="FullDay" name="FullDay" type="checkbox" value="true" onchange="GetTimeEvent();">

                                        </div>
                                        <div class="col-md-1">
                                            <button value="Submit" class="btn btn-flat btn-primary btn-sm" name="JobCalendarAdd" style="width: 100%" id="JobCalendarAdd" onclick="AddJobCalenderEvents();">Add</button>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-1">
                                            <strong>End Time : </strong>
                                        </div>
                                        <div class="col-md-2">
                                            @*<input type="date" id="EndDate" class="form-control" />*@
                                            <input type="text" id="EndDate" class="form-control datepicker" onchange="Edatekeypress();" placeholder="mm-dd-yyyy" disabled />
                                            <span class="alert-success pull-right">
                                                <button type="button" id="EndDateclear" class="close cleardata">×</button>
                                            </span>
                                        </div>
                                        <div class="col-md-3">
                                            @*<input type="time" id="endTime" class="form-control" />*@
                                            <input type="text" name="timepicker" id="endTime" placeholder="hh:mm tt" class="time_element form-control" style="width: 50% !important;" />
                                        </div>
                                        <div class="col-md-2">
                                            <strong>Assign To : </strong>
                                        </div>
                                        <div class="col-md-3">

                                            @Html.DropDownListFor(m => m.Job_AssignedUser, ViewBag.UserList as SelectList, "Select", new { Name = "User_ID", @class = "form-control", onchange = "getusercolor(this)", style = "width:80%;display:inline;" })
                                            @if (Model.UserColor != "" && Model.UserColor != null)
                                            {

                                                <input type="text" id="SelectColor" style="background-color:@Model.UserColor;" />
                                            }
                                            <input type="text" name="UserColor" id="UserColor" style="display: none" />

                                        </div>
                                        <div class="col-md-1">
                                            <button value="Submit" class="btn btn-flat btn-primary btn-sm" name="JobCalendarClear" style="width: 100%" id="JobCalendarClear" onclick="ClearCalenderEvent();">Clear</button>

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="DivJobEventList">

                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </div>
}
<div class="box-row  profile-hd">
    <h7 class="box-heading">
        <strong> &nbsp Client Information </strong> <span class="pull-right apse b" style="padding-right:5px; color:#ffffff">
            <img id="arrow" src="../Images/down-arrow.png" alt="" />
        </span>
    </h7>
</div>
<div class="row" @hidde>
    <div class="col-md-20">
        <div class="panel panel-default">
            <div class="panel-body">
                <div class="ajax-refresh2">
                    <div class="panel-body">
                        <div class="row-fluid">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="title"><strong>Client Name  &nbsp <span class="err">*</span> : </strong></label>
                                    @Html.DropDownListFor(m => m.Client_Name, ViewBag.clientlist as SelectList, "Select", new { Name = "Client_Name", @class = "form-control", onchange = "getjobclientdetails(this)" })
                                </div>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="label"><strong>If New Client Name:</strong></label>
                                    @Html.TextBoxFor(m => m.Other_ClientName, new { @class = "form-control", @maxlength = "50", @placeholder = "Client Name", disabled = "disabled" })
                                    @Html.ValidationMessageFor(m => m.Other_ClientName)
                                </div>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="label"><strong>Client Contact Person :</strong></label>
                                    @Html.TextBoxFor(m => m.Client_ContactPerson, new { @class = "form-control", @maxlength = "50", @placeholder = "Contact Person" })
                                    @Html.ValidationMessageFor(m => m.Client_ContactPerson)
                                </div>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="col-md-3">

                                <div class="form-group">
                                    <label for="label"><strong>Client Address :</strong></label>
                                    @Html.TextBoxFor(m => m.Client_Address, new { @class = "form-control", @maxlength = "500", @placeholder = "Address" })
                                    @Html.ValidationMessageFor(m => m.Client_Address)
                                </div>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="col-md-3">

                                <div class="form-group">
                                    <label for="label"><strong>Client Address2 :</strong></label>
                                    @Html.TextBoxFor(m => m.Client_Address2, new { @class = "form-control", @maxlength = "500", @placeholder = "Address2" })
                                    @Html.ValidationMessageFor(m => m.Client_Address2)
                                </div>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="label"><strong>Client City <span class="err">*</span> :</strong></label>
                                    @Html.TextBoxFor(m => m.Client_City, new { @class = "form-control", @placeholder = "City" })
                                    @Html.ValidationMessageFor(m => m.Client_City)
                                    @*<input type="text" class="form-control" name="MyCost" id="IPurchaseRate" maxlength="8" placeholder="0.00" tabindex="5" onkeypress="return numbersonly(event)" style="text-align: right;">*@
                                </div>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="label"><strong>Client State :</strong></label>
                                    @Html.DropDownListFor(m => m.Client_State, ViewBag.State as SelectList, "--select--", new { @class = "form-control", @placeholder = "State" })
                                    @Html.ValidationMessageFor(m => m.Client_State)
                                </div>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="label"><strong>Client  ZipCode <span class="err">*</span> :</strong></label>
                                    @Html.TextBoxFor(m => m.Client_ZipCode, new { @class = "form-control", @maxlength = "7", @placeholder = "ZipCode" })
                                    @Html.ValidationMessageFor(m => m.Client_ZipCode)
                                    @*<input type="text" class="form-control" name="ResaleCost" id="IPurchaseRate" maxlength="8" placeholder="0.00" tabindex="5" onkeypress="return numbersonly(event)" style="text-align: right;">*@
                                </div>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="label"><strong>Client Fax :</strong></label>
                                    @Html.TextBoxFor(m => m.Client_Fax, new { @class = "form-control", @placeholder = "Fax" })
                                    @Html.ValidationMessageFor(m => m.Client_Fax)
                                </div>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="label"><strong>Client Email &nbsp <span class="err">*</span> :</strong></label>
                                    @Html.TextBoxFor(m => m.Client_Email, new { @class = "form-control", @placeholder = "Email", @required = "required" })
                                    @Html.ValidationMessageFor(m => m.Client_Email)
                                    <div class="form-group">
                                        <label for="title"><span style="color: #f00">Note:</span> Multiple Client Email should be seperate by : '<span style="color: #0026ff; font-size: 20px"> ,</span>'</label>
                                    </div>
                                </div>
                            </div>




                        </div>

                        <div class="row-fluid">
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="label"><strong>Client Phone <span class="err">*</span> :</strong></label>
                                    @Html.TextBoxFor(m => m.Client_Phone, new { @class = "form-control", @maxlength = "10", @placeholder = "Phone" })
                                    @Html.ValidationMessageFor(m => m.Client_Phone)

                                </div>
                            </div>
                        </div>
                        <div class="row-fluid">
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="label"><strong>Client Mobile :</strong></label>
                                    @Html.TextBoxFor(m => m.Client_Mobile, new { @class = "form-control", @maxlength = "10", @placeholder = "Mobile" })
                                    @Html.ValidationMessageFor(m => m.Client_Mobile)

                                </div>

                            </div>

                        </div>



                    </div>
                    <div class=" box-row  profile-hd">
                        <h7 class="box-heading">
                            <strong> &nbsp Work Information </strong> <span class="pull-right apse b" style="padding-right:5px; color:#ffffff">
                                <img id="arrow" src="../Images/down-arrow.png" alt="" />
                            </span>
                        </h7>
                    </div>
                    <div class="col-md-20" @hidde>
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <div class="ajax-refresh2">

                                    <div class="panel-body">
                                        <input type="hidden" value="@ViewBag.LoginUser" id="loguser" />
                                        @Html.HiddenFor(m => m.Client_Id)

                                        <div class="row-fluid">
                                            <div class="col-md-2">
                                                <div class="form-group">
                                                    <label for="title"><strong>Previous Location : </strong></label>
                                                    @* @Html.DropDownListFor(m => m.Previous_Location, Enumerable.Empty<SelectListItem>(), "Select", new { Name = "Previous_Location", @class = "form-control" })*@
                                                    @Html.DropDownListFor(m => m.Previous_Location, ViewBag.locationlist as SelectList, "Select", new { Name = "Client_ID", @class = "form-control", onchange = "jobclientlocationdetails(this);" })

                                                </div>
                                            </div>
                                        </div>
                                        <div class="row-fluid">
                                            <div class="col-md-2">
                                                <div class="form-group">
                                                    <label for="label"><strong>If New Location :</strong></label>
                                                    @Html.TextBoxFor(m => m.Other_Previous_Location, new { @class = "form-control", @placeholder = "Location", disabled = "disabled" })
                                                    @Html.ValidationMessageFor(m => m.Other_Previous_Location)
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row-fluid">
                                            <div class="col-md-6">


                                                <div class="form-group">
                                                    <label for="label"><strong> <input type="checkbox" id="sameas" onchange="SameAsAbove(this);" />Same As Client Address</strong> </label>
                                                </div>
                                            </div>
                                            <div class="row-fluid">
                                                <div class="col-md-3">

                                                    <div class="form-group">
                                                        <label for="label"><strong>Work Address :</strong></label>
                                                        @Html.TextBoxFor(m => m.Work_Address, new { @class = "form-control", @maxlength = "100", @placeholder = "Work Address" })
                                                        @Html.ValidationMessageFor(m => m.Work_Address)
                                                    </div>
                                                </div>
                                            </div>


                                            <div class="row-fluid">
                                                <div class="col-md-3">

                                                    <div class="form-group">
                                                        <label for="label"><strong>Work Address2 :</strong></label>
                                                        @Html.TextBoxFor(m => m.Work_Address2, new { @class = "form-control", @maxlength = "50", @placeholder = "Work Address2" })
                                                        @Html.ValidationMessageFor(m => m.Work_Address2)
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row-fluid">
                                                <div class="col-md-2">
                                                    <div class="form-group">
                                                        <label for="label"><strong>Work City  :</strong></label>
                                                        @Html.TextBoxFor(m => m.Work_City, new { @class = "form-control", @placeholder = "Work City " })
                                                        @Html.ValidationMessageFor(m => m.Work_City)

                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row-fluid">
                                                <div class="col-md-2">
                                                    <div class="form-group">
                                                        <label for="label"><strong>Work State :</strong></label>
                                                        @Html.DropDownListFor(m => m.Work_State, ViewBag.State as SelectList, "--select--", new { @class = "form-control", @placeholder = "Work State " })
                                                        @Html.ValidationMessageFor(m => m.Work_State)
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row-fluid">
                                                <div class="col-md-2">
                                                    <div class="form-group">
                                                        <label for="label"><strong>Work ZipCode  :</strong></label>
                                                        @Html.TextBoxFor(m => m.Work_ZipCode, new { @class = "form-control", @placeholder = "Work ZipCode " })
                                                        @Html.ValidationMessageFor(m => m.Work_ZipCode)

                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                </div>

            </div>
        </div>
    </div>
</div>
<div class="box-row  profile-hd">
    <h7 class="box-heading">
        <strong> &nbsp Notes </strong> <span class="pull-right apse b" style="padding-right:5px; color:#ffffff">
            <img id="arrow" src="../Images/down-arrow.png" alt="" />
        </span>
    </h7>
</div>
<div class="row" @hidde>
    <div class="col-md-20">
        <div class="panel panel-default">
            <div class="panel-body">
                <div class="ajax-refresh2">
                    <div class="panel-body">

                        <div class="row-fluid">
                            <div class="col-md-10">
                                <div class="form-group" style="display: inline">
                                    <label for="title"><strong>Notes :</strong></label>@*Directions To*@
                                    @Html.TextAreaFor(m => m.Directions_To, new { @class = "form-control", @maxlength = "5000", rows = "6" })
                                    @Html.ValidationMessageFor(m => m.Directions_To)
                                </div>
                                <br />
                                <div style="display: inline-block">
                                    <a href="#" class="btn btn-flat btn-default btn-sm" onclick="PreviewDirection();"><i class="fa fa-check-square-o"></i><span>Preview</span></a>
                                    <a href="#" class="btn btn-flat btn-default btn-sm" onclick="SelectDirection();"><i class="fa fa-check-square-o"></i><span>Select From Previous</span></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class=" box-row  profile-hd">
    <h7 class="box-heading">
        <strong> &nbsp Scope of Work</strong> <span class="pull-right apse b" style="padding-right:5px; color:#ffffff">
            <img id="arrow" src="../Images/down-arrow.png" alt="" />
        </span>
    </h7>
</div>
<div class="row" @hidde>
    <div class="col-md-20">
        <div class="panel panel-default">
            <div class="panel-body">
                <div class="ajax-refresh2">
                    <div class="panel-body">

                        <div class="row-fluid">
                            <div class="col-md-10">
                                <div class="form-group" style="display: inline">

                                    <label for="title"><strong>Scope of Work :</strong></label>
                                    @Html.TextAreaFor(m => m.Doing_What, new { @class = "form-control", rows = "6" })
                                    @Html.ValidationMessageFor(m => m.Doing_What)


                                </div>
                                <br />
                                <div style="display: inline-block">
                                    <a href="#" class="btn btn-flat btn-default btn-sm" onclick="PreviewPopUp();"><i class="fa fa-check-square-o"></i><span>Preview</span></a>
                                    <a href="#" class="btn btn-flat btn-default btn-sm" onclick="PreviewSowInPopUp();"><i class="fa fa-check-square-o"></i><span>Select From Previous</span></a>
                                </div>


                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="box-row  profile-hd" id="AssembliesBar">
    <h7 class="box-heading">
        <strong> &nbsp; Assemblies</strong> <span class="pull-right apse b" style="padding-right:5px; color:#ffffff">
            <img id="arrow" src="../Images/down-arrow.png" alt="" />
        </span>
    </h7>
</div>
<div class="row" @hidde>
    <a href="#" class="btn btn-flat btn-default btn-sm" onclick="AssembliesListInPopUp();"><i class="fa fa-check-square-o"></i><span>Add Assemblies List</span></a>
    <div id="divAssembliesInfo">
        <div class="table table-responsive ">
            <table class="table table-bordered" id="AssembliestblInfo">
                <thead>
                    <tr class="headcolor">
                        <th style="width: 25%;vertical-align: middle; " class="Head-Align">
                            Assemblies Name
                        </th>
                        <th class="Head-Align">
                            Assemblies Category
                        </th>
                        <th class="Head-Align">
                            Multiplier
                        </th>
                        <th class="Head-Align colwidth">
                            Cost
                        </th>
                        <th class="Head-Align colwidth">
                            Resale
                        </th>
                        <th class="Head-Align">
                            Est.Qty
                        </th>
                        <th class="Head-Align">
                            Actual Qty
                        </th>
                        <th class="Head-Align colwidth">
                            Exp Total
                        </th>
                        <th class="Head-Align colwidth">
                            Est Total
                        </th>
                        <th class="Head-Align colwidth">
                            Actual Total
                        </th>
                        <th @hidde class="Head-Align colwidth">
                            Difference
                        </th>
                    </tr>
                </thead>
                <tbody id="Assembliesbody"></tbody>
                <tfoot id="PartsTotal" class="Totalfooter-bgcolor"></tfoot>
            </table>
        </div>
    </div>
    <div style="display:none" id="aspartsdiv"></div>
    <a href="#" class="btn btn-flat btn-default btn-sm" data-toggle="modal" data-target="#AssembliesListInPopUp" id="Assembliesopenpopup" style="display: none">popup</a>
    <div id="AssembliesListInPopUp" class="modal fade" role="dialog">
        <div class="modal-dialog" style="width: 78%; margin-left: 21%; margin-top: 60px;">
            <div class="modal-header" style="background-color: #333333; height: 35px;">
                <button type="button" class="close" data-dismiss="modal" id="Assembliespopupclose" style="color: white !important; opacity: 0.9">&times;</button>
                <h4 class="modal-title" style="color: #FFF !important;">Add Assemblies Details</h4>
            </div>
            <div class="modal-content" style="overflow: hidden; border-radius: 0; min-height: 185px;">
                <div id="divAssembliesdata"></div>
            </div>
        </div>
    </div>

</div>
<div class="box-row  profile-hd" id="divjobparts">
    <h7 class="box-heading">
        <strong>&nbsp;  Add Parts Details</strong> <span class="pull-right apse b" style="padding-right:5px; color:#ffffff">
            <img id="arrow" src="../Images/down-arrow.png" alt="" />
        </span>
    </h7>
</div>
<div class="row" id="popjobparts" @hidde>
    @*<a href="#" class="btn btn-flat btn-default btn-sm" onclick="PartsListInPopUp();" style="margin-bottom: 2px;"><i class="fa fa-check-square-o"></i><span>Add Parts List</span></a>*@
    <a href="#" class="btn btn-flat btn-default btn-sm" onclick="OpenPartsPopup();" style="margin-bottom: 2px;"><i class="fa fa-check-square-o"></i><span>Add Parts List</span></a>

    <div id="divPartsInfo">
        <div class="table table-responsive ">
            <table class="table table-bordered" id="PartsLabortblInfo">
                <thead>
                    <tr class="headcolor">
                        <th class="Head-Align" style="width:10%">
                            Part Number
                        </th>
                        <th style="width: 20%" class="Head-Align">
                            Description
                        </th>
                        <th class="Head-Align">
                            Cost
                        </th>
                        <th class="Head-Align">
                            Resale
                        </th>
                        <th class="Head-Align">
                            Labor Unit
                        </th>
                        <th class="Head-Align">
                            Est.Qty
                        </th>
                        <th class="Head-Align">
                            Act Qty
                        </th>
                        <th class="Head-Align">
                            Exp Total
                        </th>
                        <th class="Head-Align">
                            Est Total
                        </th>

                        <th class="Head-Align">
                            Act Total
                        </th>
                        <th @hidde class="Head-Align">
                            Difference
                        </th>
                    </tr>
                </thead>
                <tbody id="partstbody"></tbody>
                <tfoot id="NormalPartsTotal" class="Totalfooter-bgcolor"></tfoot>
            </table>
        </div>
    </div>
</div>
<div class="box-row  profile-hd" id="divjoblabor">
    <h7 class="box-heading">
        <strong>&nbsp; Add Labor Details</strong> <span class="pull-right apse b" style="padding-right:5px; color:#ffffff">
            <img id="arrow" src="../Images/down-arrow.png" alt="" />
        </span>
    </h7>
</div>
<div class="row" id="popjoblabor" @hidde>
    <a href="#" class="btn btn-flat btn-default btn-sm" onclick="LaborListInPopUp();"><i class="fa fa-check-square-o"></i><span>Add Labor List</span></a>

    <div id="divLaborInfo">
        <div class="table table-responsive ">
            <table class="table table-bordered" id="LabortblInfo">
                <thead>
                    <tr class="headcolor">
                        <th class="Head-Align" style="width:12%">
                            Labor Name
                        </th>
                        <th class="Head-Align">
                            Cost
                        </th>
                        <th class="Head-Align">
                            ResaleCost
                        </th>
                        <th class="Head-Align">
                            Est.Hrs
                        </th>
                        <th class="Head-Align">
                            Act Hrs
                        </th>
                        <th class="Head-Align">
                            Exp Total
                        </th>
                        <th class="Head-Align">
                            Est Total
                        </th>
                        <th class="Head-Align">
                            Act Total
                        </th>
                        <th @hidde class="Head-Align">
                            Difference
                        </th>
                    </tr>
                </thead>
                <tbody id="Laborbody"></tbody>
                <tfoot id="LaborTotal" class="Totalfooter-bgcolor"></tfoot>
            </table>
        </div>
    </div>

    <a href="#" class="btn btn-flat btn-default btn-sm" data-toggle="modal" data-target="#LaborListInPopUp" id="Laboropenpopup" style="display: none">popup</a>
    <div id="LaborListInPopUp" class="modal fade" role="dialog">
        <div class="modal-dialog" style="width: 78%; margin-left: 21%; margin-top: 60px;">
            <div class="modal-header" style="background-color: #333333; height: 35px;">
                <button type="button" class="close" data-dismiss="modal" id="Laborpopupclose" style="color: white !important; opacity: 0.9">&times;</button>
                <h4 class="modal-title" style="color: #FFF !important;">Add Labor Details</h4>
            </div>
            <div class="modal-content" style="overflow: hidden; border-radius: 0; min-height: 185px;">
                <div id="divLabordata">
                </div>
            </div>
        </div>
    </div>
</div>
<div class="box-row  profile-hd" style="display:none">
    <h7 class="box-heading">
        <strong>&nbsp Mileage</strong> <span class="pull-right apse b" style="padding-right:5px; color:#ffffff">
            <img id="arrow" src="../Images/down-arrow.png" alt="" />
        </span>
    </h7>
</div>
<div class="row" @hidde style="display:none">
    <div id="collapseFour" class="panel-collapse collapse in">
        <div class="panel panel-default">
            <div class="panel-body">
                <div class="table table-responsive">
                    @{ string hide = "hidden";
                        if (Request.QueryString["JobID"] != null && Request.QueryString["JobID"] != "0")
                        {
                            hide = "";
                        }}
                    <table class="table">
                        <thead>
                            <tr class="headcolor">
                                <th class="Head-Align"></th>
                                <th class="Head-Align">Estimate</th>
                                <th @hide class="Head-Align">Actual</th>
                                <th class="Head-Align">Mileage Cost</th>
                                <th class="Head-Align">Exp Total</th>
                                <th class="Head-Align">Est Total </th>
                                <th @hide class="Head-Align">Act Total </th>
                            </tr>
                        </thead>
                        <tbody id="">
                            <tr>
                                <td>Mileage</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_Mileage_Estimated, new { @id = "Estimated", @class = "form-control", onkeyup = "milagecost(this);" })
                                </td>
                                <td @hide>
                                    @Html.TextBoxFor(m => m.Job_Mileage_Actual, new { @id = "ActualCost", @class = "form-control", onkeyup = "milagecost(this);", style = "text-align:right" })

                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_Mileage_Cost, new { @id = "MileageCost", @class = "form-control", onkeyup = "milagecost(this);", style = "text-align:right" })

                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_Mileage_ExpTotal, new { @id = "MileExpTotal", @class = "form-control", disabled = "disabled", style = "text-align:right" })

                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_Mileage_EstTotal, new { @id = "MileEstTotal", @class = "form-control", disabled = "disabled", style = "text-align:right" })
                                </td>
                                <td @hide>
                                    @Html.TextBoxFor(m => m.Job_Mileage_ActTotal, new { @id = "MileActTotal", @class = "form-control", disabled = "disabled", style = "text-align:right" })

                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>

    <!-- /box -->
</div>
<div class="box-row profile-hd">
    <h7 class="box-heading">
        <strong>&nbsp; DJE/VQ</strong> <span class="pull-right apse b" style="padding-right:5px; color:#ffffff">
            <i class="icon ion-chevron-down"></i>
        </span>
    </h7>
</div>
<div class="row" @hidde>
    <a href="#" class="btn btn-flat btn-default btn-sm" onclick="addRow()" style="margin-bottom: 2px;"><i class="fa fa-check-square-o"></i><span>Add Rows</span></a>
    <div id="collapseFive" class="panel-collapse collapse in">
        <div class="panel panel-default">
            <div class="panel-body">
                <div class="table table-responsive">
                    <table class="table table-responsive table-bordered" id="DJE_tbl">
                        <thead>
                            <tr class="headcolor">
                                <th class="Head-Align">Expense</th>
                                <th class="Head-Align">Name Of Vendor</th>
                                <th class="Head-Align"> Cost</th>
                                <th class="Head-Align" style="width:10%">Profit %</th>
                                <th class="Head-Align">DJE/VQ </th>
                                <th class="Head-Align">ResaleTotal </th>
                                <th class="Head-Align">Delete </th>
                            </tr>
                        </thead>
                        <tbody id="estimatebody"></tbody>
                        <tfoot class="Totalfooter-bgcolor">
                            <tr>
                                <th class="Estimate-Footer"> DJECost Total</th>
                                <td><input type="text" id="DjeCost_total" value="0.00" class="form-control Estimate-FooterValue" disabled="disabled" style="text-align:right" /></td>
                                <th class="Estimate-Footer">DJEResale Total</th>
                                <td><input type="text" id="Dje_total" value="0.00" class="form-control Estimate-FooterValue" disabled="disabled" style="text-align:right" /></td>
                            </tr>
                            <tr>
                                <th class="Estimate-Footer">VQCost Total</th>
                                <td><input type="text" id="VQCost_total" value="0.00" class="form-control Estimate-FooterValue" disabled="disabled" style="text-align:right" /></td>
                                <th class="Estimate-Footer">VQResale Total</th>
                                <td><input type="text" id="VQ_total" value="0.00" class="form-control Estimate-FooterValue" disabled="disabled" style="text-align:right" /></td>
                            </tr>
                        </tfoot>
                    </table>

                </div>
                <div id="divtbldata"></div>
            </div>
        </div>
    </div>
</div>
<div class="box-row  profile-hd" style="display:none">
    <h7 class="box-heading">
        <strong>&nbsp Estimate Values</strong> <span class="pull-right apse b" style="padding-right:5px; color:#ffffff">
            <img id="arrow" src="../Images/up-arrow.png" alt="" />
        </span>
    </h7>
</div>
<div class="row" style="display:none">
    <div id="collapseFive" class="panel-collapse collapse in">
        <div class="panel panel-default">
            <div class="panel-body">
                <div class="table table-responsive">
                    <table class="table">
                        <thead>
                            <tr style="background-color: #eeeeee !important">
                                <th></th>
                                <th class="Head-Align">Estimated</th>
                                <th class="Head-Align">Est Total</th>
                                <th hidden style="background-color: #eeeeee !important">Act Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="2">Sub Total</td>
                                <td>
                                    @Html.TextBoxFor(m => m.EstimateValue_SubTotal, new { @id = "SubEstTotal", @class = "form-control", disabled = "disabled", style = "text-align:right" })

                                </td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Overhead</td>
                                <td>
                                    @Html.TextBoxFor(m => m.EstimateValue_Overhead_ExpTotal, new { @id = "OverExpTotal", @class = "form-control wtd-min", onkeyup = "calculateoverhead(this);", style = "text-align:right" })%

                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.EstimateValue_ExpTotal, new { @id = "EstimateExpTotal", @class = "form-control wtd-min", disabled = "disabled", style = "text-align:right" })
                                </td>
                                <td></td>

                            </tr>
                            <tr>
                                <td>Profit</td>
                                <td>
                                    @Html.TextBoxFor(m => m.EstimateValue_Profit_Percentage, new { @id = "ProfitPercentage", @class = "form-control wtd-min", onkeyup = "calculateoverhead(this);", style = "text-align:right" })%
                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.EstimateValue_Profit_EstTotal, new { @id = "ProfitEstTotal", @class = "form-control wtd-min", disabled = "disabled", style = "text-align:right" })%
                                </td>
                                <td></td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    Estimate Override<br />
                                    (Ignores all previous estimate values and uses this value instead if greater than 0)
                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Estimate_Override, new { @id = "EstimateOverride", @class = "form-control", onkeyup = "override(this);", style = "text-align:right" })

                                </td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>
                                    Sales Tax<br />
                                    (Check if charge Sales Tax on this job)
                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.SalesTax_Perc, new { @id = "SalesPercentage", @class = "form-control wtd-min", onkeyup = "calculateoverhead(this);", style = "text-align:right" })%
                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.SalesTax, new { @id = "SalesEstTotal", @class = "form-control wtd-min", disabled = "disabled", style = "text-align:right" })%
                                </td>
                                <td hidden></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>
</div>

@{
    bool showBidSummary = false;
    if (Request.QueryString["JobID"] == null || Request.QueryString["JobID"] == "0") {
        showBidSummary = true;
    } else {
        if (@Model.Created_Date > Convert.ToDateTime("2021-04-12 00:00:00")) {
            showBidSummary = true;
        }
    }
}

@if (showBidSummary) {
    string state = null;
    if (Model.Job_EstimationDetails != null) {
        state = Model.Job_EstimationDetails.Estimate4_Data;
    }
    if (state == null) {
        state = "null";
    }
    @Html.Partial("_JobInfoBidSummary", new { hidden = hidde, state = state } )
}

@if (!showBidSummary) {
<div class="box-row  profile-hd">
    <h7 class="box-heading">
        <strong>&nbsp Job Estimate </strong> <span class="pull-right apse b" style="padding-right:5px; color:#ffffff">
            <img id="arrow" src="../Images/down-arrow.png" alt="" />
        </span>
    </h7>
</div>
<div class="row" @hidde>
    <div id="collapseFive" class="panel-collapse collapse in">
        <div class="panel panel-default">
            <div class="panel-body">
                <div style="margin-left:-4%">
                    <div>
                        @if (Model.JobDisplayId != null && Model.Job_EstimationDetails != null && Model.Job_EstimationDetails.Selected_Estimation_Type == 1)
                        {
                            <input type="radio" name="estimate1" style="width: 10%;" id="estimate1" checked />
                        }
                        else
                        {
                            <input type="radio" name="estimate1" style="width: 10%;" id="estimate1" />
                        }
                        <label class="estimation-label">Estimate1</label>
                    </div>
                </div>
                <div class="table table-responsive ">
                    <table class="table">
                        <tbody>
                            <tr>
                                <td>Assembly Total</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Job_AssemblyTotal, new { @id = "Estimate1_AssemblyTotal", @class = "form-control", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateONE();" })
                                </td>
                                <td>Tax</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation1_AssemblyTax, new { @id = "Estimate1_AssemblyTax", @class = "form-control wtd-min2", style = "text-align:right", onkeyup = "CalculateEstimateONE();" })%
                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation1_AssemblyTotal, new { @id = "Estimate1_Assembly", @class = "form-control", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateONE();" })
                                </td>

                            </tr>
                            <tr>
                                <td>Laborer Total</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Job_LaborTotal, new { @id = "Estimate1_LaborTotal", @class = "form-control", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateONE();" })
                                </td>
                                <td>Tax</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation1_LaborTax, new { @id = "Estimate1_LaborTax", @class = "form-control wtd-min2", style = "text-align:right", onkeyup = "CalculateEstimateONE();" })%

                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation1_laborTotal, new { @id = "Estimate1_Labor", @class = "form-control", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateONE();" })
                                </td>
                            </tr>
                            <tr>
                                <td>Material Total</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Job_PartsTotal, new { @id = "Estimate1_PartsTotal", @class = "form-control", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateONE();" })
                                </td>
                                <td>Tax</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation1_PartsTax, new { @id = "Estimate1_PartsTax", @class = "form-control wtd-min2", style = "text-align:right", onkeyup = "CalculateEstimateONE();" })%
                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation1_PartsTotal, new { @id = "Estimate1_Parts", @class = "form-control", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateONE();" })
                                </td>
                            </tr>
                            <tr>
                                <td>DJE Total</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Job_DJETotal, new { @id = "Estimate1_DJETotal", @class = "form-control", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateONE();" })
                                </td>
                                <td>Tax</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation1_DJETax, new { @id = "Estimate1_DJETax", @class = "form-control wtd-min2", style = "text-align:right", onkeyup = "CalculateEstimateONE();" })%
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation1_DJETotal, new { @id = "Estimate1_DJE", @class = "form-control", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateONE();" })
                                </td>
                            </tr>
                            <tr>
                                <td>VQ Total</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Job_VQTotal, new { @id = "Estimate1_VQTotal", @class = "form-control ", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateONE();" })
                                </td>
                                <td>Tax</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation1_VQTax, new { @id = "Estimate1_VQTax", @class = "form-control wtd-min2", style = "text-align:right", onkeyup = "CalculateEstimateONE();" })%
                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation1_VQTotal, new { @id = "Estimate1_VQ", @class = "form-control", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateONE();" })
                                </td>
                            </tr>
                            <tr class="Totalfooter-bgcolor">
                                <th class="Estimate-Footer">Grand Total</th>
                                <th>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation1_GrandTotal, new { @id = "Estimate1_GrandTotal", @class = "form-control Estimate-FooterValue", disabled = "disabled", style = "text-align:right" })
                                </th>
                                <th colspan="2" class="Estimate-Footer">Estimate1 Total</th>
                                <th>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation1_Total, new { @id = "Estimate1_GrandTotalvalue", @class = "form-control Estimate-FooterValue", disabled = "disabled", style = "text-align:right" })
                                </th>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>
    <div id="collapseFive" class="panel-collapse collapse in">
        <div class="panel panel-default">
            <div class="panel-body">
                <div style="margin-left:-4%">
                    <div>
                        @if (Model.JobDisplayId != null && Model.Job_EstimationDetails != null && Model.Job_EstimationDetails.Selected_Estimation_Type == 2)
                        {
                            <input type="radio" name="estimate2" style="width: 10%;" id="estimate2" checked />
                        }
                        else
                        {
                            <input type="radio" name="estimate2" style="width: 10%;" id="estimate2" />
                        }
                        <label class="estimation-label">Estimate 2</label>
                    </div>
                </div>
                <div class="table table-responsive">
                    <table class="table">
                        <tbody>
                            <tr>
                                <td>Assembly Total</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Job_AssemblyTotal, new { @id = "Estimate2_AssemblyTotal", @class = "form-control", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })
                                </td>
                                <td>Profit</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_AssemblyProfit, new { @id = "Estimate2_AssemblyProfit", @class = "form-control wtd-min2", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })%
                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_AssemblySubTotal, new { @id = "Estimate2_AssemblySubtotal", @class = "form-control", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })
                                </td>
                                <td>Tax</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_AssemblyTax, new { @id = "Estimate2_AssemblyTax", @class = "form-control wtd-min2", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })%
                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_AssemblyTotal, new { @id = "Estimate2_Assembly", disabled = "disabled", @class = "form-control ", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })
                                </td>

                            </tr>
                            <tr>
                                <td>Laborer Total</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Job_LaborTotal, new { @id = "Estimate2_LaborTotal", @class = "form-control", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })
                                </td>
                                <td>Profit</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_LaborProft, new { @id = "Estimate2_LaborProfit", @class = "form-control wtd-min2", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })%
                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimate2_LaborSubTotal, new { @id = "Estimate2_LaborSubtotal", @class = "form-control", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })
                                </td>
                                <td>Tax</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimate2_LaborTax, new { @id = "Estimate2_LaborTax", @class = "form-control wtd-min2", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })%
                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimate2_LaborTotal, new { @id = "Estimate2_Labor", @class = "form-control", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })
                                </td>
                            </tr>
                            <tr>
                                <td>Material Total</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Job_PartsTotal, new { @id = "Estimate2_PartsTotal", @class = "form-control ", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })
                                </td>
                                <td>Profit</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_PartsProfit, new { @id = "Estimate2_PartsProfit", @class = "form-control wtd-min2", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })%

                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_PartsSubTotal, new { @id = "Estimate2_PartsSubtotal", @class = "form-control ", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })
                                </td>
                                <td>Tax</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_PartsTax, new { @id = "Estimate2_PartsTax", @class = "form-control wtd-min2", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })%

                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_PartsTotal, new { @id = "Estimate2_Parts", @class = "form-control ", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })
                                </td>
                            </tr>
                            <tr>
                                <td>DJE Total</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Job_DJETotal, new { @id = "Estimate2_DJETotal", @class = "form-control", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })
                                </td>
                                <td>Profit</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_DJEProfit, new { @id = "Estimate2_DJEProfit", @class = "form-control wtd-min2", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })%
                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_DJESubTotal, new { @id = "Estimate2_DJESubtotal", @class = "form-control", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })
                                </td>
                                <td>Tax</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_DJETax, new { @id = "Estimate2_DJETax", @class = "form-control wtd-min2", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })%

                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_DJETotal, new { @id = "Estimate2_DJE", @class = "form-control ", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })
                                </td>
                            </tr>
                            <tr>
                                <td>VQ Total</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Job_VQTotal, new { @id = "Estimate2_VQTotal", @class = "form-control ", disabled = "disabled", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })
                                </td>
                                <td>Profit</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_VQProfit, new { @id = "Estimate2_VQProfit", @class = "form-control wtd-min2", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })%

                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_VQSubtotal, new { @id = "Estimate2_VQSubtotal", @class = "form-control", disabled = "disabled", style = "text-align:right" })
                                </td>
                                <td>Tax</td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_VQTax, new { @id = "Estimate2_VQTax", @class = "form-control wtd-min2", style = "text-align:right", onkeyup = "CalculateEstimateTWO();" })%
                                </td>
                                <td>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_VQTotal, new { @id = "Estimate2_VQ", @class = "form-control", disabled = "disabled", style = "text-align:right" })
                                </td>
                            </tr>
                            <tr class="Totalfooter-bgcolor">
                                <th class="Estimate-Footer">Grand Total</th>
                                <th>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_GrandTotal, new { @id = "Estimate2_GrandTotal", @class = "form-control Estimate-FooterValue", disabled = "disabled", style = "text-align:right" })
                                </th>
                                <th colspan="2" class="Estimate-Footer">Estimate2 Sub Total</th>
                                <th>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_SubTotal, new { @id = "Estimate2_GrandSubtotal", @class = "form-control Estimate-FooterValue", disabled = "disabled", style = "text-align:right" })
                                </th>
                                <th colspan="2" class="Estimate-Footer">Estimate2 Total</th>
                                <th>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimation2_Total, new { @id = "Estimate2Total", @class = "form-control Estimate-FooterValue", disabled = "disabled", style = "text-align:right" })
                                </th>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div id="collapseFive" class="panel-collapse collapse in">
        <div class="panel panel-default">
            <div class="panel-body">
                <div style="margin-left:-4%">
                    <div>
                        @if (Model.JobDisplayId != null && Model.Job_EstimationDetails != null && Model.Job_EstimationDetails.Selected_Estimation_Type == 3)
                        {
                            <input type="radio" name="estimate3" style="width: 10%;" id="estimate3" checked />
                        }
                        else
                        {<input type="radio" name="estimate3" style="width: 10%;" id="estimate3" />
                        }                 <label class="estimation-label">Estimate 3</label>
                    </div>
                </div>
                <div class="table table-responsive">
                    <table class="table">
                        <tbody>
                            <tr class="Totalfooter-bgcolor">
                                <th class="Estimate-Footer">Estimate Override</th>
                                <th>
                                    @Html.TextBoxFor(m => m.Job_EstimationDetails.Estimate3_Override, new { @id = "Estimation3_Override", @class = "form-control", style = "text-align:right", onkeyup = "CalculateEstimateTHREE();" })
                                </th>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
}

<div class="box-row  profile-hd" id="jobtotal_toggle">
    <h7 class="box-heading">
        <strong>&nbsp Job Totals</strong> <span class="pull-right apse b" style="padding-right:5px; color:#ffffff">
            <img id="arrow" src="../Images/up-arrow.png" alt="" />
        </span>
    </h7>
</div>
<div class="row" id="jobtotal_toggleSection">
    <div id="collapseSix" class="panel-collapse collapse in">
        <div class="panel panel-default">
            <div class="panel-body">
                <div class="table table-responsive">
                    <table class="table table-bordered">
                        <thead>
                            <tr class="headcolor">
                                <th style="width: 25%;"></th>
                                <th class="Head-Align">Expense Total</th>
                                <th class="Head-Align">Estimated Total</th>
                                <th class="Head-Align" style="display:none">Difference Total</th>
                            </tr>

                        </thead>
                        <tbody>
                            <tr>
                                <td>Totals</td>
                                <td>

                                    @Html.TextBoxFor(m => m.Job_ExpenseTotal, new { @id = "Job_ExpenseTotal", @class = "form-control Estimate-FooterValue", style = "text-align:right", disabled = "disabled" })
                                </td>
                                <td>

                                    @Html.TextBoxFor(m => m.Job_EstimatedTotal, new { @id = "EstimateTotal", @class = "form-control Estimate-FooterValue", style = "text-align:right", disabled = "disabled" })
                                </td>
                                <td style="display:none">

                                    @Html.TextBoxFor(m => m.Job_ActualTotal, new { @id = "ActualTotal", @class = "form-control Estimate-FooterValue", style = "text-align:right", disabled = "disabled" })
                                </td>
                            </tr>
                            <tr @hidde class="Totalfooter-bgcolor">
                                <th class="Estimate-Footer">Profit/Loss</th>
                                <th>
                                    @Html.TextBoxFor(m => m.Profit_Loss_Total, new { @id = "ProfitLossTotal", @class = "form-control Estimate-FooterValue", style = "text-align:right", disabled = "disabled" })
                                </th>
                                <th style="text-align:center">
                                    <span id="Estoption">Estimate not selected</span>
                                </th>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>

</div>
<div class=" box-row  profile-hd">
    <h7 class="box-heading">
        <strong>&nbsp Add Legal Details</strong> <span class="pull-right apse b" style="padding-right:5px; color:#ffffff">
            <img id="arrow" src="../Images/down-arrow.png" alt="" />
        </span>
    </h7>
</div>
<div class="row" @hidde>
    <a href="#" class="btn btn-flat btn-default btn-sm" onclick="LegalListInPopUp();"><i class="fa fa-check-square-o"></i><span>Add Legal List</span></a>
    <div id="divLegalInfo">
    </div>

    <a href="#" class="btn btn-flat btn-default btn-sm" data-toggle="modal" data-target="#LegalListInPopUp" id="Legalopenpopup" style="display: none">popup</a>
    <div id="LegalListInPopUp" class="modal fade" role="dialog">
        <div class="modal-dialog" style="width: 78%; margin-left: 21%; margin-top: 60px;">
            <div class="modal-header" style="background-color: #333333; height: 35px;">
                <button type="button" class="close" data-dismiss="modal" id="Legalpopupclose" style="color: white !important; opacity: 0.9">&times;</button>
                <h4 class="modal-title" style="color: #FFF !important;">Add Legal Details</h4>
            </div>
            <div class="modal-content" style="overflow: hidden; border-radius: 0; min-height: 185px;">
                <div id="divLegaldata"></div>
            </div>
        </div>
    </div>

</div>

<div class="box-row  profile-hd">
    <h7 class="box-heading">
        <strong>&nbsp Associated Files</strong> <span class="pull-right apse b" style="padding-right:5px; color:#ffffff">
            <img id="arrow" src="../Images/down-arrow.png" alt="" />
        </span>
    </h7>
</div>
<div class="row" @hidde>
    <div class="col-md-20">
        <div class="panel panel-default">
            <div class="panel-body">
                <div class="ajax-refresh2">
                    <div class="panel-body">
                        <div id="divAttachment">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<a href="#" class="btn btn-flat btn-default btn-sm" data-toggle="modal" data-target="#SowPreviewInPopUp" id="Previewopenpopup" style="display: none">popup</a>
<div id="SowPreviewInPopUp" class="modal fade" role="dialog">
    <div class="modal-dialog" style="width: 60%; margin-left: 25%; margin-top: 60px;">
        <div class="modal-header" style="background-color: #333333; height: 35px;">
            <button type="button" class="close" data-dismiss="modal" id="SowPreviewpopupclose" style="color: white !important; opacity: 0.9;">&times;</button>
            <h4 class="modal-title" id="sowhead" style="color: #FFF !important;">Scope of Work Preview</h4>
        </div>
        <div class="modal-content" style="overflow: hidden; border-radius: 0; min-height: 185px;">
            @* <div id="divPreviewdata"></div>*@
            <textarea id="divPreviewdata" class="" onkeyup="PreviewKeyUp(this);" style="float: left; width: 98%; min-height: 500px; margin: 10px;"></textarea>
            <div class="pull-right popup-btn">
                <button value="Submit" data-dismiss="modal" class="btn btn-flat btn-primary btn-sm" name="addLabour" tabindex="10" onclick="">Ok</button>
            </div>
        </div>

    </div>
</div>
<a href="#" class="btn btn-flat btn-default btn-sm" data-toggle="modal" data-target="#SowPreviousInPopUp" id="Sowopenpopup" style="display: none">popup</a>
<div id="SowPreviousInPopUp" class="modal fade" role="dialog">
    <div class="modal-dialog" style="width: 78%; margin-left: 20%; margin-top: 60px; position: fixed; left: 0; right: 0; top: 0; bottom: 0;">
        <div class="modal-header" style="background-color: #333333; height: 35px;">
            <button type="button" class="close" data-dismiss="modal" id="SowPreviouspopupclose" style="color: white !important; opacity: 0.9;">&times;</button>
            <h4 class="modal-title" id="previoushead" style="color: #FFF !important;">Previous Scope of Work</h4>
        </div>
        <div class="modal-content" style="overflow: scroll; border-radius: 0; min-height: 185px; max-height: 500px; overflow: auto">
            <div id="divSowPreviousdata"></div>
        </div>
    </div>
</div>
<a href="#" class="btn btn-flat btn-default btn-sm" data-toggle="modal" data-target="#PartsListInPopUp" id="openpopup" style="display: none">popup</a>
<div id="PartsListInPopUp" class="modal fade" role="dialog">
    <div class="modal-dialog" style="width: 78%; margin-left: 21%; margin-top: 60px;">
        <div class="modal-header" style="background-color: #333333; height: 35px;">
            <button type="button" class="close" data-dismiss="modal" id="popupclose" style="color: white !important; opacity: 0.9;">&times;</button>
            <h4 class="modal-title" style="color: #FFF !important;">Add Parts Details</h4>
        </div>
        <div class="modal-content" style="overflow: hidden; border-radius: 0; min-height: 185px;">
            <div id="divpartsdata">
            </div>
        </div>
    </div>
</div>
<a href="#" class="btn btn-flat btn-default btn-sm" data-toggle="modal" data-target="#divJobAssemblyPartsPopup" id="JobAssemblyPartsPopup" style="display: none">popup</a>
<div id="divJobAssemblyPartsPopup" class="modal fade" role="dialog">
    <div class="modal-dialog" style="width: 78%; margin-left: 21%; margin-top: 60px;">
        <div class="modal-header" style="background-color: #333333; height: 35px;">
            <button type="button" class="close" data-dismiss="modal" id="JobAssemblyPartsPopupClose" style="color: white !important; opacity: 0.9;">&times;</button>
            <h4 class="modal-title" style="color: #FFF !important;">Add Parts Details</h4>
        </div>
        <div class="modal-content" style="overflow: hidden; border-radius: 0; min-height: 185px;">
            <div id="divJobAssemblyPartsData">
            </div>
        </div>
    </div>
</div>
<a href="#" class="btn btn-flat btn-default btn-sm" data-toggle="modal" data-target="#newSowPreviousInPopUp" id="newSowopenpopup" style="display: none">popup</a>
<div id="newSowPreviousInPopUp" class="modal fade" role="dialog">
    <div class="modal-dialog" style="width: 78%; margin-left: 21%; margin-top: 60px;">
        <div class="modal-header" style="background-color: #333333; height: 35px;">
            <button type="button" class="close" data-dismiss="modal" id="newSowPreviouspopupclose" style="color: white !important; opacity: 0.9;">&times;</button>
            <h4 class="modal-title" id="newprevioushead" style="color: #FFF !important;">Previous/Add Scope of Work</h4>
        </div>
        <div class="modal-content" style="overflow: scroll; border-radius: 0; min-height: 185px; max-height: 500px; overflow: auto">
            <div id="newdivSowPreviousdata"></div>
        </div>
    </div>
</div>