@model List<ElectricEase.Models.AssembliesParts_DetailsInfoList>
@{
   // Layout = null;
    TempData["MyParts"] = Model;
    var parts = (List<ElectricEase.Models.AssembliesParts_DetailsInfoList>)TempData.Peek("MyParts");
    
    var Grid = new WebGrid(source: parts, canSort: false, canPage: false);
}

<script>


    $(document).ready(function () {

        $("#grid").dataTable({

             "bPaginate": false,
            "bLengthChange": false,
            "bFilter": false,
            "bInfo": false,
            "bAutoWidth": false,
            stateSave: true


        });
    });
    //
    // Updates "Select all" control in a data table
    //
    
    function updateDataTableSelectAllCtrl(table) {
        var $table = table.table().node();
        var $chkbox_all = $('tbody input[type="checkbox"]', $table);
        var $chkbox_checked = $('tbody input[type="checkbox"]:checked', $table);
        var chkbox_select_all = $('thead input[name="select_all"]', $table).get(0);            

        // If none of the checkboxes are checked
        if ($chkbox_checked.length === 0) {

            chkbox_select_all.checked = false;
            if ('indeterminate' in chkbox_select_all) {
                chkbox_select_all.indeterminate = false;
            }

            // If all of the checkboxes are checked
        } else if ($chkbox_checked.length === $chkbox_all.length) {
            chkbox_select_all.checked = true;
            if ('indeterminate' in chkbox_select_all) {
                chkbox_select_all.indeterminate = false;
            }

            // If some of the checkboxes are checked
        } else {
            chkbox_select_all.checked = true;
            if ('indeterminate' in chkbox_select_all) {
                chkbox_select_all.indeterminate = true;
            }
        }
    }
    
    //$(document).ready(function () {
    //    alert('funcation calling');
    //    var rows_selected = [];
    //    $(".table").dataTable({
    //        "aLengthMenu": [[5, 10, 25, -1], [5, 10, 25, "All"]],
            
    //        'columnDefs': [{
    //            'targets': 0,
    //            'searchable': false,
    //            'orderable': false,
    //            'className': 'dt-body-center',
    //            'render': function (data, type, full, meta) {
    //                return '<input type="checkbox">';
    //            }
    //        }],
    //        columnDefs: [{
    //            orderable: false,
    //            className: 'select-checkbox',
    //            targets: 0
    //        }],
    //        select: {
    //            style: 'os',
    //            selector: 'td:first-child'
    //        },
    //        order: [[1, 'asc']]
    //    });
    //});

</script>

<script type="text/javascript" >
    $(function () {
       // alert('funcation calling');
       // $('.edit-mode');
        $('.edit-user, .cancel-user').on('click', function () {
            var tr = $(this).parents('tr:first');
            tr.find('.edit-mode, .display-mode').toggle();
        });

        //$('.save-user').on('click', function () {
        //    alert('usermodel');
        //    var tr = $(this).parents('tr:first');
        //    var Cost = tr.find("#Cost").val();
        //    var ResaleCost = tr.find("#ResaleCost").val();
        //    var PartNumber = tr.find("#PartNumber").html();
        //    var PartCategory = tr.find("#PartCategory").html();
        //    var PurchasedFrom = tr.find("#PurchasedFrom").html();
        //    tr.find("#lblPartNumber").text(PartNumber);
        //    tr.find("#lblPartCategory").text(PartCategory);
        //    tr.find('.edit-mode, .display-mode').toggle();
            
        //    var AssembliesParts_DetailsInfoList =
        //    {
           
        //        "PartNumber": PartNumber,
        //        "PartCategory": PartCategory,
        //        "Cost": Cost,
        //        "ResaleCost": ResaleCost,
        //        "PurchasedFrom": PurchasedFrom
        //    };
        //    $.ajax({
        //        url: '/User/UpdateUser/',
        //        data: JSON.stringify(AssembliesParts_DetailsInfoList),
        //        type: 'POST',
        //        contentType: 'application/json; charset=utf-8',
        //        success: function (data) {
        //            alert(data);
        //        }
        //    });

        //});
    })


   
    $(function () {
        $(function () {
           // alert("lll");
            $('#Cost, #ResaleCost').prop(true);
            var $tblrows = $(".PartsListGrid tbody tr");
           // alert("tbl");
            $tblrows.each(function (index) {
                var $tblrow = $(this);
                $tblrow.find('#ResaleCost,#Cost').on('change', function () {
                    Cost = $tblrow.find('#Cost').val();
                    floatcost = parseFloat(Cost);
                    //alert(Cost);
                    var ResaleCost = $tblrow.find('#ResaleCost').val();;
                    floatresale = parseFloat(ResaleCost);
                    //alert(ResaleCost);
                    message = "ResaleCost shoud be higher than Cost?"
                   
                    if (floatcost > floatresale)
                    {
                        if (confirm(message))
                        {
                            $('#EstQty, #ActualQuantity').prop('readonly', true);
                            $("#Cost").focus();
                            return false;
                            // $('#EstHours, #ActHours').prop('readonly', true);
                        }
                        }
                    else
                    {
                       // alert("else");
                        $('#EstQty, #ActualQuantity').prop('readonly', false);
                    }

                    CostZeroMsg="Please Enter a Cost!"
                    if (floatcost==0)
                    {
                        if (confirm(CostZeroMsg)) {
                            $("#Cost").focus();
                            return false;
                        }
                        else {
                            alert("jjj");
                            $('#EstQty, #ActualQuantity').prop('readonly', false);
                            //return false;

                        }
                       
                    }
                    
                });

            });
        });


    });
</script>

<style>
    .PartsListGrid {
            margin-top: -35px;
    }
</style>
    
  
   
             @using (Html.BeginForm("_AddPartsInGrid", "Assemblies_Master", FormMethod.Post, new { @class = "form-horizontal", enctype = "multipart/form-data" }))
                 {
       
                             <input  type="hidden" name="Assemblies_Name" value="@ViewBag.AssembliesName"/>
                              <input  type="hidden" name="Assemblies_Description" value="@ViewBag.Description"/>
                          @Grid.GetHtml(
                           tableStyle: " table table-bordered   PartsListGrid ",
                            alternatingRowStyle: "alt",
                              htmlAttributes: new { id = "grid" },
                             //htmlAttributes:new { id= "AssembliesPartsGrid"},
                           columns: Grid.Columns(
                          
                            Grid.Column(columnName: "Part_Number", header: "Part Number"),
                             Grid.Column(columnName: "Part_Category", header: "Part Category"),
                        
                          Grid.Column("Cost", format: @<text><input type="text" id="PartCost" name="PartCost" value="@item.Part_Cost" class = "col-md-10" placeholder="0.00" style="text-align: right" /> </text>, style: "col2Width"), 
                           Grid.Column("Resale Cost", format: @<text><input type="text" id="ResaleCost" name="ResaleCost" value="@item.Resale_Cost" class = "col-md-10" style="text-align: right" /> </text>, style: "col2Width"), 
                           Grid.Column("Est.Qty/Hrs", format: @<text><input type="text" id="EstQty" name="EstQty" value="@item.Estimated_Qty" class = "col-md-10"  style="text-align: right"/> </text>, style: "col2Width"), 
                        Grid.Column("Est.Cost Total", format: @<text><input type="text" id="EstCostTot" value="@item.EstCost_Total" class = "col-md-10" style="text-align: right" /> </text>, style: "col2Width"), 
                           Grid.Column("Est.Resale Total", format: @<text><input type="text" id="EstRCostTot" name="EstRCostTot" value="@item.EstResaleCost_Total" class="edit-mode" style="width:150px;text-align: right" /> </text>, style: "col2Width")
                         // Grid.Column("Estimated Quantity", format: @<text> @*<span  class="display-mode"> <label id="lblResaleCost">@item.Resale_Cost</label> </span>*@  <input type="text" id="EstQty" style="width:150px" value="@item.Estimated_Qty" class="edit-mode" /> </text>, style: "col1Width")
                       
                           )
                           )
                        
             }
      
                 
