@model  List<ElectricEase.Models.Parts_DetailsInfoList>

@{
    ViewBag.Title = "AddNewPartsinAssembliesDetails";
    Layout = null;
     var Grid = new WebGrid(source: Model, canPage: false, canSort: false);
}

<script>
    $(document).ready(function () {

        // alert('funcation calling');
        var rows_selected = [];
        $("#checkableGrid").dataTable({
            //"aLengthMenu": [[5, 10, 25, -1], [5, 10, 25, "All"]],
            //"aLengthMenu": [[-1, 5, 10, 25], ["All", 5, 10, 25]],
            "bPaginate": false,
            // scrollY: '100vh',
            "bLengthChange": false,
            'columnDefs': [{
                'targets': 0,
                'searchable': false,
                'orderable': false,
                'className': 'dt-body-center',
                'render': function (data, type, full, meta) {
                    return '<input type="checkbox">';
                }
            }],
            columnDefs: [{
                orderable: false,
                className: 'select-checkbox',
                targets: 0
            }],
            select: {
                style: 'os',
                selector: 'td:first-child'
            },
            order: [[1, 'asc']]
        });



        // 1st replace first column header text with checkbox

        $("#checkableGrid th").each(function () {
            if ($.trim($(this).text().toString().toLowerCase()) === "{checkall}") {
                $(this).text('');
                $("<input/>", { type: "checkbox", id: "cbSelectAll", value: "" }).appendTo($(this));
                $(this).append("<span>Select All</span>");
            }
            var totalRows = $("#checkableGrid td :checkbox").length;
            var checked = $("#checkableGrid td :checkbox:checked").length;

            if (checked == totalRows) {
                $("#checkableGrid").find("input:checkbox").each(function () {
                    this.checked = true;
                });
            }
            else {
                $("#cbSelectAll").removeAttr("checked");
            }
        });

        //2nd click event for header checkbox for select /deselect all
        $("#cbSelectAll").live("click", function () {
            var ischecked = this.checked;
            $('#checkableGrid').find("input:checkbox").each(function () {
                this.checked = ischecked;
            });
        });


        //3rd click event for checkbox of each row
        $("input[name='assignChkBx']").click(function () {
            var totalRows = $("#checkableGrid td :checkbox").length;
            var checked = $("#checkableGrid td :checkbox:checked").length;

            if (checked == totalRows) {
                $("#checkableGrid").find("input:checkbox").each(function () {
                    this.checked = true;
                });
            }
            else {
                $("#cbSelectAll").removeAttr("checked");
            }
        });
    });
   
    function selectvalues() {
        var partnumber = "";
        $("input[type=checkbox]:checked").each(function () {
            //alert($(this).attr('data-partnumber'));
            if ($(this).attr('data-partnumber') != undefined) {
                partnumber = partnumber + (partnumber != "" ? "," : "") + $(this).attr('data-partnumber');
            }
        });
        return partnumber;
    }
    
    $("#Pasubmit").click(function () {

        var values = selectvalues();
        //alert(values);
        //$('#modalAssignToRM').modal('toggle');
        // Assemblies_Name="Ajith"
       //  LoadContent($("#PartsPatialView"), "/Jobs/GetAssembliesPartsDetails?Assemblies_Name=" + Assemblies_Name + "");
       //LoadContent($("#PartsPatialView"), "/Jobs/GetAssembliesPartsDetails?Assemblies_Name=" + Assemblies_Name + "");
      //var data=  @*@ViewData["mydata"]*@
        // LoadContent($("#PartsPatialView"), "/Jobs/AddPartsInAssembliesDetails?SelectedCheckBx=" + values + "");
      var url = '@Url.Action("AddPartsInAssembliesDetails")';
        $.ajax({
            type: "POST",
            url: url,
            contentType: "application/json; charset=utf-8",
            data: "{'SelectedCheckBx':'" + values + "'}",
        }).done(function (data) {
                         // $('#modalAssignToRM').modal('toggle');
            //$('#modalAssignToRM').hide();
           // alert('done');
            ("#PartsPatialView").html(data);
            $('.modal').removeClass('show');
           // alert('done');
          //  $("#partsview").load("_AssembliesPartsDetailsList.cshtml #PartsPatialView");

           // $(this).parent().load("#PartsPatialView")
            //$('#PartsPatialView').html($(data).find('#PartsPatialView').html());
            //$('#partsview').html(data);
           // ("#PartsPatialView").html(data);
        });
        //    success: function (data) {
        //        if (data!=null)
        //        {
        //            alert("success");
        //            $('#PartsPatialView').html($(data).find('#PartsPatialView').html());
        //            alert("success");
        //            ("#PartsPatialView").html(data);
        //            alert("success");
        //        }
              
              
        //        $('#modalAssignToRM').modal('toggle');
        //        alert("success");
        //        //JSON.stringify(data)
        //        // ("#PartsPatialView").html(data);
        //       // $('#Content').load('Jobs/AddJobDetails.cshtml #PartsPatialView');
        //        $('#PartsPatialView').html($(data).find('#PartsPatialView').html());

        //    },
        //    error: function (request, status, error) {
        //          alert("Fail");
        //        // alert("Request: " + request + " Status: " + status + " Error: " + error);
        //    }

        //});
    });
   
</script>
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />

</head>
<body>
  <div class="modal-content" style="height: 600px; width: 100%; overflow: scroll;">
        <div class="modal-header" style="background-color: #3D81BD; height: 35px;">
            <button type="button" class="close" data-dismiss="modal" style="color: #fff !important;">&times;</button>
        <h4 class="modal-title" style="color: #FFF !important;">Add Parts Details</h4>
    </div>
    @using (Html.BeginForm("AddPartsInAssembliesDetails", "Jobs", FormMethod.Post, new { @class = "form-horizontal", enctype = "multipart/form-data" }))
    {
        <div class="modal-body">
            <div class="app-body" id="Scroll">

                <!-- app content here -->

                <div class="magic-layoutz">
                    <div class="box magic-element width-full">
                        <fieldset>
                            <div id="accordion">
                                <div class="row">
                                    <div class="row-fluid">
                                        
                                        <div class="pull-right">
                                            <button type="submit" value="Submit" class="btn btn-flat btn-primary btn-sm" id="Partssubmit" tabindex="10">Submit</button>
                                        </div>

                                    </div>
                                </div>
                                <div class="row">
                                    <div id="partsview">

                                    </div>
                                    <div class="col-md-12">
                                        <div class="panel panel-default">
                                            <div class="panel-body">

                                                 <input  type="hidden" name="Partnumber" id="Partnumber" />
                                                <input  type="hidden" id="Assemblies_Name" name="Assemblies_Name" value="@ViewBag.AssembliesName"/>
                                                <input  type="hidden" name="Assemblies_Description" value="@ViewBag.Description"/>


                                                @Grid.GetHtml(
                           tableStyle: "table table-bordered datatables",
                           htmlAttributes: new { id = "checkableGrid" },
                            alternatingRowStyle: "alt",
                           columns: Grid.Columns(
                           Grid.Column(columnName: "Select_ID", style: "null", header: "{checkall}", format: @<text><input type="checkbox" name="assignChkBx" checked="@item.isChekced" value="@item.Client_ID,@item.Part_Number,@item.Part_Cost,@item.Resale_Cost" id="assignChkBx" data-partnumber="@item.Part_Number" /></text>),
            // Grid.Column(columnName: "Client_ID", header: "Client Company"),Partnumber
                           Grid.Column(columnName: "Part_Number", header: "Part Number"),
                           Grid.Column(columnName: "Part_Category", header: "Part Category"),
                           Grid.Column(columnName: "Part_Cost", header: "My Cost"),
                           Grid.Column(columnName: "Resale_Cost", header: "Resale")
                           //Grid.Column(columnName: "Purchased_From", header: "Purchased_From")
            //Grid.Column(header: "Action", format: @<text><a href="/Client_Master/EditClientMaster?id=@item.Client_ID"> <i class="icon ion-ios7-compose"></i></a>&nbsp;&nbsp;&nbsp;<a id="deletebtn" href="/Client_Master/DeleteClient?id=@item.Client_ID"><i class="icon ion-ios7-trash"></i></a></text>)

                           )
                           )



                                            </div>

                                        </div>

                                    </div>

                                </div>

                                <div class="row-fluid">


                                    <div class="pull-right">
                                        <button type="submit" value="Submit" class="btn btn-flat btn-primary btn-sm" id="submit" tabindex="10">Submit</button>

                                    </div>


                                </div>



                            </div>
                        </fieldset>

                    </div>

                </div>
                <!-- app content here -->
            </div>
            <!-- app content here -->
        </div>
    }
</div>
    </body>
    </html>